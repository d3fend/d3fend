import{S as Xe,i as Qe,s as Ze,al as Te,y as pe,a as H,k as u,q as D,z as ve,c as V,l as h,m as d,r as A,h as o,n as T,A as me,b as R,H as r,a0 as He,M as he,am as Ye,g as ne,d as fe,B as be,W as xe,D as et,o as tt,p as we,u as ae,C as se,e as de,v as ze,f as Je,V as Ne,T as Ve}from"../chunks/index.38e6a1b1.js";import{a as lt,S as We}from"../chunks/extract.4fef4b07.js";import{G as Ke,d as De,j as Re,i as ue}from"../chunks/lib.1620f930.js";import{T as rt}from"../chunks/Title.76b3b16c.js";import{H as at}from"../chunks/Header.16622278.js";import{A as st}from"../chunks/Alert.06a23c66.js";import{p as ot}from"../chunks/stores.8b24c703.js";function Be(f,e,t){const l=f.slice();return l[21]=e[t],l}function Fe(f,e,t){const l=f.slice();return l[25]=e[t],l}function je(f,e,t){const l=f.slice();return l[29]=e[t],l}function nt(f){let e,t,l=f[28].message+"",s;return{c(){e=u("p"),t=D("error with promise: "),s=D(l),this.h()},l(n){e=h(n,"P",{style:!0});var a=d(e);t=A(a,"error with promise: "),s=A(a,l),a.forEach(o),this.h()},h(){we(e,"color","red")},m(n,a){R(n,e,a),r(e,t),r(e,s)},p(n,a){a[0]&32&&l!==(l=n[28].message+"")&&ae(s,l)},i:se,o:se,d(n){n&&o(e)}}}function ft(f){let e,t,l,s;const n=[it,ct],a=[];function i(c,v){return c[20].length>0?0:!c[3]&&c[20].length<1?1:-1}return~(e=i(f))&&(t=a[e]=n[e](f)),{c(){t&&t.c(),l=de()},l(c){t&&t.l(c),l=de()},m(c,v){~e&&a[e].m(c,v),R(c,l,v),s=!0},p(c,v){let $=e;e=i(c),e===$?~e&&a[e].p(c,v):(t&&(ze(),fe(a[$],1,1,()=>{a[$]=null}),Je()),~e?(t=a[e],t?t.p(c,v):(t=a[e]=n[e](c),t.c()),ne(t,1),t.m(l.parentNode,l)):t=null)},i(c){s||(ne(t),s=!0)},o(c){fe(t),s=!1},d(c){~e&&a[e].d(c),c&&o(l)}}}function ct(f){let e,t;return{c(){e=u("div"),t=D("No ATT&CK techniques found in text."),this.h()},l(l){e=h(l,"DIV",{class:!0});var s=d(e);t=A(s,"No ATT&CK techniques found in text."),s.forEach(o),this.h()},h(){T(e,"class","card")},m(l,s){R(l,e,s),r(e,t)},p:se,i:se,o:se,d(l){l&&o(e)}}}function it(f){let e,t,l,s,n,a,i,c,v,$,E,g,k,U,M,y,_,B,j,q,W,b,N,S,z,Y,X,ee,Z,x,te,P,m,L,w,I=f[0]&&Se(f);s=new st({props:{$$slots:{default:[ut]},$$scope:{ctx:f}}}),v=new We({props:{url:f[6].url}});function C(p,J){return p[2]?dt:ht}let O=C(f),K=O(f),G=f[20],F=[];for(let p=0;p<G.length;p+=1)F[p]=Le(Be(f,G,p));return{c(){e=u("div"),I&&I.c(),t=H(),l=u("div"),pe(s.$$.fragment),n=H(),a=u("div"),i=u("div"),c=u("div"),pe(v.$$.fragment),$=H(),E=u("div"),g=u("b"),k=u("i"),U=D("Mapping Results:"),M=H(),y=u("div"),_=u("div"),K.c(),B=H(),j=u("button"),q=D("copy"),W=H(),b=u("table"),N=u("thead"),S=u("th"),z=D("ATT&CK ID"),Y=H(),X=u("th"),ee=D("ATT&CK Name"),Z=H(),x=u("th"),te=D("Related D3FEND Techniques"),P=H();for(let p=0;p<F.length;p+=1)F[p].c();this.h()},l(p){e=h(p,"DIV",{class:!0});var J=d(e);I&&I.l(J),J.forEach(o),t=V(p),l=h(p,"DIV",{class:!0});var le=d(l);ve(s.$$.fragment,le),le.forEach(o),n=V(p),a=h(p,"DIV",{class:!0});var re=d(a);i=h(re,"DIV",{class:!0});var Q=d(i);c=h(Q,"DIV",{class:!0});var oe=d(c);ve(v.$$.fragment,oe),oe.forEach(o),Q.forEach(o),$=V(re),E=h(re,"DIV",{});var ce=d(E);g=h(ce,"B",{});var _e=d(g);k=h(_e,"I",{});var Ie=d(k);U=A(Ie,"Mapping Results:"),Ie.forEach(o),_e.forEach(o),ce.forEach(o),M=V(re),y=h(re,"DIV",{class:!0});var Ee=d(y);_=h(Ee,"DIV",{class:!0});var ge=d(_);K.l(ge),B=V(ge),j=h(ge,"BUTTON",{});var $e=d(j);q=A($e,"copy"),$e.forEach(o),ge.forEach(o),W=V(Ee),b=h(Ee,"TABLE",{id:!0,class:!0});var ke=d(b);N=h(ke,"THEAD",{});var ie=d(N);S=h(ie,"TH",{class:!0});var ye=d(S);z=A(ye,"ATT&CK ID"),ye.forEach(o),Y=V(ie),X=h(ie,"TH",{});var Ce=d(X);ee=A(Ce,"ATT&CK Name"),Ce.forEach(o),Z=V(ie),x=h(ie,"TH",{});var qe=d(x);te=A(qe,"Related D3FEND Techniques"),qe.forEach(o),ie.forEach(o),P=V(ke);for(let Ae=0;Ae<F.length;Ae+=1)F[Ae].l(ke);ke.forEach(o),Ee.forEach(o),re.forEach(o),this.h()},h(){T(e,"class","card"),T(l,"class","card"),T(c,"class","text-right"),T(i,"class","stretch"),T(_,"class","text-right"),T(S,"class","stretch"),T(b,"id","mappings"),T(b,"class","table-auto"),T(y,"class","results-wrap center svelte-xumjr3"),T(a,"class","card")},m(p,J){R(p,e,J),I&&I.m(e,null),R(p,t,J),R(p,l,J),me(s,l,null),R(p,n,J),R(p,a,J),r(a,i),r(i,c),me(v,c,null),r(a,$),r(a,E),r(E,g),r(g,k),r(k,U),r(a,M),r(a,y),r(y,_),K.m(_,null),r(_,B),r(_,j),r(j,q),r(y,W),r(y,b),r(b,N),r(N,S),r(S,z),r(N,Y),r(N,X),r(X,ee),r(N,Z),r(N,x),r(x,te),r(b,P);for(let le=0;le<F.length;le+=1)F[le].m(b,null);m=!0,L||(w=he(j,"click",kt),L=!0)},p(p,J){p[0]?I?(I.p(p,J),J[0]&1&&ne(I,1)):(I=Se(p),I.c(),ne(I,1),I.m(e,null)):I&&(ze(),fe(I,1,1,()=>{I=null}),Je());const le={};J[1]&2&&(le.$$scope={dirty:J,ctx:p}),s.$set(le);const re={};if(J[0]&64&&(re.url=p[6].url),v.$set(re),O===(O=C(p))&&K?K.p(p,J):(K.d(1),K=O(p),K&&(K.c(),K.m(_,B))),J[0]&48){G=p[20];let Q;for(Q=0;Q<G.length;Q+=1){const oe=Be(p,G,Q);F[Q]?F[Q].p(oe,J):(F[Q]=Le(oe),F[Q].c(),F[Q].m(b,null))}for(;Q<F.length;Q+=1)F[Q].d(1);F.length=G.length}},i(p){m||(ne(I),ne(s.$$.fragment,p),ne(v.$$.fragment,p),m=!0)},o(p){fe(I),fe(s.$$.fragment,p),fe(v.$$.fragment,p),m=!1},d(p){p&&o(e),I&&I.d(),p&&o(t),p&&o(l),be(s),p&&o(n),p&&o(a),be(v),K.d(),Ne(F,p),L=!1,w()}}}function Se(f){let e,t,l,s,n,a,i,c,v=f[0].length+"",$,E,g,k,U;l=new We({props:{url:f[6].url}});let M=f[0],y=[];for(let _=0;_<M.length;_+=1)y[_]=Pe(je(f,M,_));return{c(){e=u("div"),t=u("div"),pe(l.$$.fragment),s=H(),n=u("div"),a=u("b"),i=u("i"),c=D("Extracted "),$=D(v),E=D(" unique IDs:"),g=H(),k=u("dl");for(let _=0;_<y.length;_+=1)y[_].c();this.h()},l(_){e=h(_,"DIV",{class:!0});var B=d(e);t=h(B,"DIV",{class:!0});var j=d(t);ve(l.$$.fragment,j),j.forEach(o),B.forEach(o),s=V(_),n=h(_,"DIV",{class:!0});var q=d(n);a=h(q,"B",{});var W=d(a);i=h(W,"I",{});var b=d(i);c=A(b,"Extracted "),$=A(b,v),E=A(b," unique IDs:"),b.forEach(o),W.forEach(o),g=V(q),k=h(q,"DL",{class:!0});var N=d(k);for(let S=0;S<y.length;S+=1)y[S].l(N);N.forEach(o),q.forEach(o),this.h()},h(){T(t,"class","text-right"),T(e,"class","stretch"),T(k,"class","flex flex-wrap svelte-xumjr3"),T(n,"class","")},m(_,B){R(_,e,B),r(e,t),me(l,t,null),R(_,s,B),R(_,n,B),r(n,a),r(a,i),r(i,c),r(i,$),r(i,E),r(n,g),r(n,k);for(let j=0;j<y.length;j+=1)y[j].m(k,null);U=!0},p(_,B){const j={};if(B[0]&64&&(j.url=_[6].url),l.$set(j),(!U||B[0]&1)&&v!==(v=_[0].length+"")&&ae($,v),B[0]&1){M=_[0];let q;for(q=0;q<M.length;q+=1){const W=je(_,M,q);y[q]?y[q].p(W,B):(y[q]=Pe(W),y[q].c(),y[q].m(k,null))}for(;q<y.length;q+=1)y[q].d(1);y.length=M.length}},i(_){U||(ne(l.$$.fragment,_),U=!0)},o(_){fe(l.$$.fragment,_),U=!1},d(_){_&&o(e),be(l),_&&o(s),_&&o(n),Ne(y,_)}}}function Pe(f){let e,t,l=f[29]+"",s,n;return{c(){e=u("dd"),t=u("a"),s=D(l),this.h()},l(a){e=h(a,"DD",{});var i=d(e);t=h(i,"A",{href:!0});var c=d(t);s=A(c,l),c.forEach(o),i.forEach(o),this.h()},h(){T(t,"href",n=De(f[29]))},m(a,i){R(a,e,i),r(e,t),r(t,s)},p(a,i){i[0]&1&&l!==(l=a[29]+"")&&ae(s,l),i[0]&1&&n!==(n=De(a[29]))&&T(t,"href",n)},d(a){a&&o(e)}}}function ut(f){let e,t,l;return{c(){e=u("b"),t=D("Note: "),l=D(`These relationships are designed to give you ideas, they
          are not designed to be exact matches or indicate coverage. They can be
          used to better understand the technologies, ask better questions, and
          develop test plans for your countermeasures.`)},l(s){e=h(s,"B",{});var n=d(e);t=A(n,"Note: "),n.forEach(o),l=A(s,`These relationships are designed to give you ideas, they
          are not designed to be exact matches or indicate coverage. They can be
          used to better understand the technologies, ask better questions, and
          develop test plans for your countermeasures.`)},m(s,n){R(s,e,n),r(e,t),R(s,l,n)},p:se,d(s){s&&o(e),s&&o(l)}}}function ht(f){let e,t,l,s;return{c(){e=u("button"),t=D("select"),this.h()},l(n){e=h(n,"BUTTON",{class:!0});var a=d(e);t=A(a,"select"),a.forEach(o),this.h()},h(){T(e,"class","selector svelte-xumjr3")},m(n,a){R(n,e,a),r(e,t),l||(s=he(e,"click",f[9]),l=!0)},p:se,d(n){n&&o(e),l=!1,s()}}}function dt(f){let e,t,l,s;return{c(){e=u("button"),t=D("deselect"),this.h()},l(n){e=h(n,"BUTTON",{class:!0});var a=d(e);t=A(a,"deselect"),a.forEach(o),this.h()},h(){T(e,"class","selector svelte-xumjr3")},m(n,a){R(n,e,a),r(e,t),l||(s=he(e,"click",f[8]),l=!0)},p:se,d(n){n&&o(e),l=!1,s()}}}function _t(f){let e,t,l=f[28].message+"",s,n,a=console.log(f[28])+"",i;return{c(){e=u("p"),t=D("error with row: "),s=D(l),n=H(),i=D(a),this.h()},l(c){e=h(c,"P",{style:!0});var v=d(e);t=A(v,"error with row: "),s=A(v,l),v.forEach(o),n=V(c),i=A(c,a),this.h()},h(){we(e,"color","red")},m(c,v){R(c,e,v),r(e,t),r(e,s),R(c,n,v),R(c,i,v)},p(c,v){v[0]&32&&l!==(l=c[28].message+"")&&ae(s,l),v[0]&32&&a!==(a=console.log(c[28])+"")&&ae(i,a)},d(c){c&&o(e),c&&o(n),c&&o(i)}}}function pt(f){let e;function t(n,a){return n[24].description.graph[0]?mt:vt}let l=t(f),s=l(f);return{c(){s.c(),e=de()},l(n){s.l(n),e=de()},m(n,a){s.m(n,a),R(n,e,a)},p(n,a){l===(l=t(n))&&s?s.p(n,a):(s.d(1),s=l(n),s&&(s.c(),s.m(e.parentNode,e)))},d(n){s.d(n),n&&o(e)}}}function vt(f){let e,t,l=f[24].id+"",s,n,a,i,c,v,$;return{c(){e=u("td"),t=u("a"),s=D(l),a=H(),i=u("td"),c=D("not found in D3FEND graph"),v=H(),$=u("td"),this.h()},l(E){e=h(E,"TD",{class:!0});var g=d(e);t=h(g,"A",{style:!0,href:!0});var k=d(t);s=A(k,l),k.forEach(o),g.forEach(o),a=V(E),i=h(E,"TD",{});var U=d(i);c=A(U,"not found in D3FEND graph"),U.forEach(o),v=V(E),$=h(E,"TD",{}),d($).forEach(o),this.h()},h(){we(t,"color","red"),T(t,"href",n=Re(f[24].id)),T(e,"class","text-center")},m(E,g){R(E,e,g),r(e,t),r(t,s),R(E,a,g),R(E,i,g),r(i,c),R(E,v,g),R(E,$,g)},p(E,g){g[0]&32&&l!==(l=E[24].id+"")&&ae(s,l),g[0]&32&&n!==(n=Re(E[24].id))&&T(t,"href",n)},d(E){E&&o(e),E&&o(a),E&&o(i),E&&o(v),E&&o($)}}}function mt(f){let e,t,l=f[24].description.graph[0]["d3f:attack-id"]+"",s,n,a,i,c=f[24].description.graph[0]["rdfs:label"]+"",v,$,E,g,k,U,M,y,_,B,j,q,W,b,N,S,z,Y,X,ee,Z,x,te,P=Me(f[24].off_to_def.results.bindings),m=[];for(let w=0;w<P.length;w+=1)m[w]=Ge(Fe(f,P,w));let L=null;return P.length||(L=Oe()),{c(){e=u("th"),t=u("a"),s=D(l),a=H(),i=u("td"),v=D(c),$=H(),E=u("td"),g=u("table"),k=u("thead"),U=u("th"),M=D("off rel"),y=H(),_=u("th"),B=D("off artifact"),j=H(),q=u("th"),W=D("D3FEND Tactic"),b=H(),N=u("th"),S=D("D3FEND Technique"),z=H(),Y=u("th"),X=D("def rel"),ee=H(),Z=u("th"),x=D("def artifact"),te=H();for(let w=0;w<m.length;w+=1)m[w].c();L&&L.c(),this.h()},l(w){e=h(w,"TH",{class:!0,scope:!0});var I=d(e);t=h(I,"A",{href:!0});var C=d(t);s=A(C,l),C.forEach(o),I.forEach(o),a=V(w),i=h(w,"TD",{});var O=d(i);v=A(O,c),O.forEach(o),$=V(w),E=h(w,"TD",{});var K=d(E);g=h(K,"TABLE",{class:!0});var G=d(g);k=h(G,"THEAD",{class:!0});var F=d(k);U=h(F,"TH",{scope:!0});var p=d(U);M=A(p,"off rel"),p.forEach(o),y=V(F),_=h(F,"TH",{scope:!0});var J=d(_);B=A(J,"off artifact"),J.forEach(o),j=V(F),q=h(F,"TH",{scope:!0});var le=d(q);W=A(le,"D3FEND Tactic"),le.forEach(o),b=V(F),N=h(F,"TH",{scope:!0});var re=d(N);S=A(re,"D3FEND Technique"),re.forEach(o),z=V(F),Y=h(F,"TH",{scope:!0});var Q=d(Y);X=A(Q,"def rel"),Q.forEach(o),ee=V(F),Z=h(F,"TH",{scope:!0});var oe=d(Z);x=A(oe,"def artifact"),oe.forEach(o),F.forEach(o),te=V(G);for(let ce=0;ce<m.length;ce+=1)m[ce].l(G);L&&L.l(G),G.forEach(o),K.forEach(o),this.h()},h(){T(t,"href",n=De(f[24].id)),T(e,"class","text-center"),T(e,"scope","row"),T(U,"scope","col"),T(_,"scope","col"),T(q,"scope","col"),T(N,"scope","col"),T(Y,"scope","col"),T(Z,"scope","col"),T(k,"class","svelte-xumjr3"),Ve(k,"hide",f[4]),T(g,"class","table-auto w100 svelte-xumjr3")},m(w,I){R(w,e,I),r(e,t),r(t,s),R(w,a,I),R(w,i,I),r(i,v),R(w,$,I),R(w,E,I),r(E,g),r(g,k),r(k,U),r(U,M),r(k,y),r(k,_),r(_,B),r(k,j),r(k,q),r(q,W),r(k,b),r(k,N),r(N,S),r(k,z),r(k,Y),r(Y,X),r(k,ee),r(k,Z),r(Z,x),r(g,te);for(let C=0;C<m.length;C+=1)m[C].m(g,null);L&&L.m(g,null)},p(w,I){if(I[0]&32&&l!==(l=w[24].description.graph[0]["d3f:attack-id"]+"")&&ae(s,l),I[0]&32&&n!==(n=De(w[24].id))&&T(t,"href",n),I[0]&32&&c!==(c=w[24].description.graph[0]["rdfs:label"]+"")&&ae(v,c),I[0]&16&&Ve(k,"hide",w[4]),I[0]&32){P=Me(w[24].off_to_def.results.bindings);let C;for(C=0;C<P.length;C+=1){const O=Fe(w,P,C);m[C]?m[C].p(O,I):(m[C]=Ge(O),m[C].c(),m[C].m(g,null))}for(;C<m.length;C+=1)m[C].d(1);m.length=P.length,!P.length&&L?L.p(w,I):P.length?L&&(L.d(1),L=null):(L=Oe(),L.c(),L.m(g,null))}},d(w){w&&o(e),w&&o(a),w&&o(i),w&&o($),w&&o(E),Ne(m,w),L&&L.d()}}}function Oe(f){let e,t,l,s,n;return{c(){e=u("td"),t=D("no defensive relations "),l=u("a"),s=D("yet"),n=H(),this.h()},l(a){e=h(a,"TD",{colspan:!0});var i=d(e);t=A(i,"no defensive relations "),l=h(i,"A",{href:!0});var c=d(l);s=A(c,"yet"),c.forEach(o),n=V(i),i.forEach(o),this.h()},h(){T(l,"href","/contribute"),T(e,"colspan","5")},m(a,i){R(a,e,i),r(e,t),r(e,l),r(l,s),r(e,n)},p:se,d(a){a&&o(e)}}}function Ue(f){let e,t,l=f[25].off_artifact_rel_label.value+"",s,n,a,i,c=f[25].off_artifact_label.value+"",v,$,E,g,k=f[25].def_tactic_label.value+"",U,M,y,_,B=f[25].def_tech_label.value+"",j,q,W,b,N=f[25].def_artifact_rel_label.value+"",S,z,Y,X,ee=f[25].def_artifact_label.value+"",Z,x,te;return{c(){e=u("tr"),t=u("td"),s=D(l),n=H(),a=u("td"),i=u("a"),v=D(c),E=H(),g=u("td"),U=D(k),M=H(),y=u("td"),_=u("a"),j=D(B),W=H(),b=u("td"),S=D(N),z=H(),Y=u("td"),X=u("a"),Z=D(ee),te=H(),this.h()},l(P){e=h(P,"TR",{});var m=d(e);t=h(m,"TD",{});var L=d(t);s=A(L,l),L.forEach(o),n=V(m),a=h(m,"TD",{});var w=d(a);i=h(w,"A",{href:!0});var I=d(i);v=A(I,c),I.forEach(o),w.forEach(o),E=V(m),g=h(m,"TD",{});var C=d(g);U=A(C,k),C.forEach(o),M=V(m),y=h(m,"TD",{});var O=d(y);_=h(O,"A",{href:!0});var K=d(_);j=A(K,B),K.forEach(o),O.forEach(o),W=V(m),b=h(m,"TD",{});var G=d(b);S=A(G,N),G.forEach(o),z=V(m),Y=h(m,"TD",{});var F=d(Y);X=h(F,"A",{href:!0});var p=d(X);Z=A(p,ee),p.forEach(o),F.forEach(o),te=V(m),m.forEach(o),this.h()},h(){T(i,"href",$="/dao/artifact/"+ue(f[25].off_artifact.value)),T(_,"href",q="/technique/"+ue(f[25].def_tech.value)),T(X,"href",x="/dao/artifact/"+ue(f[25].def_artifact.value))},m(P,m){R(P,e,m),r(e,t),r(t,s),r(e,n),r(e,a),r(a,i),r(i,v),r(e,E),r(e,g),r(g,U),r(e,M),r(e,y),r(y,_),r(_,j),r(e,W),r(e,b),r(b,S),r(e,z),r(e,Y),r(Y,X),r(X,Z),r(e,te)},p(P,m){m[0]&32&&l!==(l=P[25].off_artifact_rel_label.value+"")&&ae(s,l),m[0]&32&&c!==(c=P[25].off_artifact_label.value+"")&&ae(v,c),m[0]&32&&$!==($="/dao/artifact/"+ue(P[25].off_artifact.value))&&T(i,"href",$),m[0]&32&&k!==(k=P[25].def_tactic_label.value+"")&&ae(U,k),m[0]&32&&B!==(B=P[25].def_tech_label.value+"")&&ae(j,B),m[0]&32&&q!==(q="/technique/"+ue(P[25].def_tech.value))&&T(_,"href",q),m[0]&32&&N!==(N=P[25].def_artifact_rel_label.value+"")&&ae(S,N),m[0]&32&&ee!==(ee=P[25].def_artifact_label.value+"")&&ae(Z,ee),m[0]&32&&x!==(x="/dao/artifact/"+ue(P[25].def_artifact.value))&&T(X,"href",x)},d(P){P&&o(e)}}}function Ge(f){let e,t=f[25].def_tech&&Ue(f);return{c(){t&&t.c(),e=de()},l(l){t&&t.l(l),e=de()},m(l,s){t&&t.m(l,s),R(l,e,s)},p(l,s){l[25].def_tech?t?t.p(l,s):(t=Ue(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){t&&t.d(l),l&&o(e)}}}function bt(f){let e;return{c(){e=D("loading...")},l(t){e=A(t,"loading...")},m(t,l){R(t,e,l)},p:se,d(t){t&&o(e)}}}function Le(f){let e,t,l,s={ctx:f,current:null,token:null,hasCatch:!0,pending:bt,then:pt,catch:_t,value:24,error:28};return Te(t=f[21],s),{c(){e=u("tr"),s.block.c(),l=H()},l(n){e=h(n,"TR",{});var a=d(e);s.block.l(a),l=V(a),a.forEach(o)},m(n,a){R(n,e,a),s.block.m(e,s.anchor=null),s.mount=()=>e,s.anchor=l,r(e,l)},p(n,a){f=n,s.ctx=f,a[0]&32&&t!==(t=f[21])&&Te(t,s)||Ye(s,f,a)},d(n){n&&o(e),s.block.d(),s.token=null,s=null}}}function Et(f){let e;return{c(){e=D("enter text and click go")},l(t){e=A(t,"enter text and click go")},m(t,l){R(t,e,l)},p:se,i:se,o:se,d(t){t&&o(e)}}}function gt(f){let e,t,l,s,n,a,i,c,v,$,E,g,k,U,M,y,_,B,j,q,W,b,N,S,z,Y,X,ee,Z,x,te,P,m,L,w,I;e=new rt({props:{title:"ATT&CK Extractor | Tools | "}}),s=new at({});let C={ctx:f,current:null,token:null,hasCatch:!0,pending:Et,then:ft,catch:nt,value:20,error:28,blocks:[,,,]};return Te(m=f[5],C),{c(){pe(e.$$.fragment),t=H(),l=u("section"),pe(s.$$.fragment),n=H(),a=u("div"),i=u("h1"),c=D("ATT&CK Extractor"),v=H(),$=u("p"),E=D(`Extracts ATT&CK techniques from blobs of text and recommends potential
      D3FEND countermeasures. You may also want to try the `),g=u("a"),k=D("D3FEND Extractor"),U=D(`
      or the `),M=u("a"),y=D("Artifact Extractor."),_=H(),B=u("p"),j=u("i"),q=D("Paste any text containing ATT&CK IDs:"),W=H(),b=u("div"),N=u("textarea"),S=H(),z=u("div"),Y=u("button"),X=D("GO"),ee=H(),Z=u("br"),x=H(),te=u("br"),P=H(),C.block.c(),this.h()},l(O){ve(e.$$.fragment,O),t=V(O),l=h(O,"SECTION",{class:!0});var K=d(l);ve(s.$$.fragment,K),n=V(K),a=h(K,"DIV",{class:!0});var G=d(a);i=h(G,"H1",{});var F=d(i);c=A(F,"ATT&CK Extractor"),F.forEach(o),v=V(G),$=h(G,"P",{});var p=d($);E=A(p,`Extracts ATT&CK techniques from blobs of text and recommends potential
      D3FEND countermeasures. You may also want to try the `),g=h(p,"A",{href:!0});var J=d(g);k=A(J,"D3FEND Extractor"),J.forEach(o),U=A(p,`
      or the `),M=h(p,"A",{href:!0});var le=d(M);y=A(le,"Artifact Extractor."),le.forEach(o),p.forEach(o),_=V(G),B=h(G,"P",{class:!0});var re=d(B);j=h(re,"I",{});var Q=d(j);q=A(Q,"Paste any text containing ATT&CK IDs:"),Q.forEach(o),re.forEach(o),W=V(G),b=h(G,"DIV",{});var oe=d(b);N=h(oe,"TEXTAREA",{class:!0}),d(N).forEach(o),oe.forEach(o),S=V(G),z=h(G,"DIV",{});var ce=d(z);Y=h(ce,"BUTTON",{class:!0});var _e=d(Y);X=A(_e,"GO"),_e.forEach(o),ce.forEach(o),ee=V(G),Z=h(G,"BR",{}),G.forEach(o),x=V(K),te=h(K,"BR",{}),P=V(K),C.block.l(K),K.forEach(o),this.h()},h(){T(g,"href","/tools/d3fend-extractor"),T(M,"href","/tools/artifact-extractor"),T(B,"class","text-2"),T(N,"class","svelte-xumjr3"),T(Y,"class","button"),T(a,"class","card"),T(l,"class"," svelte-xumjr3")},m(O,K){me(e,O,K),R(O,t,K),R(O,l,K),me(s,l,null),r(l,n),r(l,a),r(a,i),r(i,c),r(a,v),r(a,$),r($,E),r($,g),r(g,k),r($,U),r($,M),r(M,y),r(a,_),r(a,B),r(B,j),r(j,q),r(a,W),r(a,b),r(b,N),He(N,f[1]),r(a,S),r(a,z),r(z,Y),r(Y,X),r(a,ee),r(a,Z),r(l,x),r(l,te),r(l,P),C.block.m(l,C.anchor=null),C.mount=()=>l,C.anchor=null,L=!0,w||(I=[he(N,"input",f[12]),he(N,"keypress",f[10]),he(Y,"click",f[7])],w=!0)},p(O,K){f=O,K[0]&2&&He(N,f[1]),C.ctx=f,K[0]&32&&m!==(m=f[5])&&Te(m,C)||Ye(C,f,K)},i(O){L||(ne(e.$$.fragment,O),ne(s.$$.fragment,O),ne(C.block),L=!0)},o(O){fe(e.$$.fragment,O),fe(s.$$.fragment,O);for(let K=0;K<3;K+=1){const G=C.blocks[K];fe(G)}L=!1},d(O){be(e,O),O&&o(t),O&&o(l),be(s),C.block.d(),C.token=null,C=null,w=!1,xe(I)}}}function kt(){document.execCommand("copy")}function Me(f){let e=new Set,t=[];return f.forEach(function(l){l.hasOwnProperty("def_tech_label")&&(e.has(l.def_tech_label.value)||(e.add(l.def_tech_label.value),t.push(l)))}),t}function Tt(f,e,t){let l;et(f,ot,b=>t(6,l=b));let{data:s}=e;const n=new Ke(s.techniques,{index:!0,index_key:"d3f:attack-id"});let a,i="",c=!1,v=!0,$,E=[];function g(){t(0,a=[]),t(2,c=!1),t(3,v=!0),E=[]}$=l.url.searchParams.get("q"),console.log("Found params: "+$);let k=!1;async function U(b){let N="/api/offensive-technique/attack/"+b+".json";const S=await fetch(N);if(S.status==404)return{id:b,off_to_def:[],description:{graph:[]},status:S.status};if(S.ok){const z=await S.json();return{id:b,off_to_def:z.off_to_def,description:new Ke(z.description)}}else throw console.log(`Error processing ${b}, response status: ${S.status}`),console.dir(S),new Error(`Error processing ${b}, response status: ${S.status}`)}async function M(){return g(),t(0,a=Array.from(new Set(lt(i,n)))),a?(a.forEach(function(b){let N;N=U(b),N&&E.push(N)}),l.url.searchParams.set("q",JSON.stringify(a)),history.replaceState(null,"mapping",l.url)):(g(),console.debug("no matches")),E}let y=M();function _(){t(5,y=M()),t(3,v=!1)}function B(){window.getSelection().removeAllRanges(),t(2,c=!1),t(4,k=!1)}function j(){t(4,k=!0);let b="mappings";const N=window.getSelection();N.removeAllRanges();let S=document.getElementById(b);const z=document.createRange();z.selectNodeContents(S),N.addRange(z),t(2,c=!0)}function q(b){b.ctrlKey==!0&&b.keyCode==13&&_()}tt(async()=>{$?(t(1,i=$),console.log("handlingclick"),_()):(console.log("starting blank"),t(1,i=""))});function W(){i=this.value,t(1,i)}return f.$$set=b=>{"data"in b&&t(11,s=b.data)},[a,i,c,v,k,y,l,_,B,j,q,s,W]}class Ct extends Xe{constructor(e){super(),Qe(this,e,Tt,gt,Ze,{data:11},null,[-1,-1])}}export{Ct as default};
