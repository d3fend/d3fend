import{S as Nt,i as At,s as wt,al as mt,y as rt,a as V,k as _,q as I,z as at,c as C,l as d,m,r as F,h as c,n as N,A as lt,b as P,H as o,a0 as vt,M as et,am as It,g as G,d as H,B as st,W as Ft,D as Tt,o as $t,p as qt,u as ot,C as K,e as Et,v as yt,f as xt,V as Vt}from"../chunks/index.38e6a1b1.js";import{H as Ct}from"../chunks/Header.16622278.js";import{T as Pt}from"../chunks/Title.76b3b16c.js";/* empty css                                                    */import{e as St,S as Bt}from"../chunks/extract.4fef4b07.js";import{G as bt}from"../chunks/lib.1620f930.js";import{p as Ot}from"../chunks/stores.8b24c703.js";function gt(i,e,r){const t=i.slice();return t[19]=e[r],t}function Gt(i){let e,r=i[22].message+"",t;return{c(){e=_("p"),t=I(r),this.h()},l(a){e=d(a,"P",{style:!0});var n=m(e);t=F(n,r),n.forEach(c),this.h()},h(){qt(e,"color","red")},m(a,n){P(a,e,n),o(e,t)},p(a,n){n&8&&r!==(r=a[22].message+"")&&ot(t,r)},i:K,o:K,d(a){a&&c(e)}}}function Ht(i){let e,r,t,a;const n=[Rt,Kt],s=[];function f(u,b){return u[18].length>0?0:!u[2]&&u[18].length<1?1:-1}return~(e=f(i))&&(r=s[e]=n[e](i)),{c(){r&&r.c(),t=Et()},l(u){r&&r.l(u),t=Et()},m(u,b){~e&&s[e].m(u,b),P(u,t,b),a=!0},p(u,b){let g=e;e=f(u),e===g?~e&&s[e].p(u,b):(r&&(yt(),H(s[g],1,1,()=>{s[g]=null}),xt()),~e?(r=s[e],r?r.p(u,b):(r=s[e]=n[e](u),r.c()),G(r,1),r.m(t.parentNode,t)):r=null)},i(u){a||(G(r),a=!0)},o(u){H(r),a=!1},d(u){~e&&s[e].d(u),u&&c(t)}}}function Kt(i){let e,r;return{c(){e=_("div"),r=I("No D3FEND Artifacts found in text."),this.h()},l(t){e=d(t,"DIV",{class:!0});var a=m(e);r=F(a,"No D3FEND Artifacts found in text."),a.forEach(c),this.h()},h(){N(e,"class","card")},m(t,a){P(t,e,a),o(e,r)},p:K,i:K,o:K,d(t){t&&c(e)}}}function Rt(i){let e,r,t=i[0]&&kt(i);return{c(){e=_("div"),t&&t.c(),this.h()},l(a){e=d(a,"DIV",{class:!0});var n=m(e);t&&t.l(n),n.forEach(c),this.h()},h(){N(e,"class","card")},m(a,n){P(a,e,n),t&&t.m(e,null),r=!0},p(a,n){a[0]?t?(t.p(a,n),n&1&&G(t,1)):(t=kt(a),t.c(),G(t,1),t.m(e,null)):t&&(yt(),H(t,1,1,()=>{t=null}),xt())},i(a){r||(G(t),r=!0)},o(a){H(t),r=!1},d(a){a&&c(e),t&&t.d()}}}function kt(i){let e,r,t,a,n,s,f,u,b=i[0].length+"",g,O,T,A,$;t=new Bt({props:{url:i[4].url}});let y=i[0],v=[];for(let l=0;l<y.length;l+=1)v[l]=Dt(gt(i,y,l));return{c(){e=_("div"),r=_("div"),rt(t.$$.fragment),a=V(),n=_("div"),s=_("b"),f=_("i"),u=I("Extracted "),g=I(b),O=I(" unique IDs:"),T=V(),A=_("dl");for(let l=0;l<v.length;l+=1)v[l].c();this.h()},l(l){e=d(l,"DIV",{class:!0});var E=m(e);r=d(E,"DIV",{class:!0});var p=m(r);at(t.$$.fragment,p),p.forEach(c),E.forEach(c),a=C(l),n=d(l,"DIV",{class:!0});var h=m(n);s=d(h,"B",{});var S=m(s);f=d(S,"I",{});var B=m(f);u=F(B,"Extracted "),g=F(B,b),O=F(B," unique IDs:"),B.forEach(c),S.forEach(c),T=C(h),A=d(h,"DL",{class:!0});var q=m(A);for(let R=0;R<v.length;R+=1)v[R].l(q);q.forEach(c),h.forEach(c),this.h()},h(){N(r,"class","text-right"),N(e,"class","stretch"),N(A,"class","flex flex-wrap svelte-1bg32kq"),N(n,"class","")},m(l,E){P(l,e,E),o(e,r),lt(t,r,null),P(l,a,E),P(l,n,E),o(n,s),o(s,f),o(f,u),o(f,g),o(f,O),o(n,T),o(n,A);for(let p=0;p<v.length;p+=1)v[p].m(A,null);$=!0},p(l,E){const p={};if(E&16&&(p.url=l[4].url),t.$set(p),(!$||E&1)&&b!==(b=l[0].length+"")&&ot(g,b),E&1){y=l[0];let h;for(h=0;h<y.length;h+=1){const S=gt(l,y,h);v[h]?v[h].p(S,E):(v[h]=Dt(S),v[h].c(),v[h].m(A,null))}for(;h<v.length;h+=1)v[h].d(1);v.length=y.length}},i(l){$||(G(t.$$.fragment,l),$=!0)},o(l){H(t.$$.fragment,l),$=!1},d(l){l&&c(e),st(t),l&&c(a),l&&c(n),Vt(v,l)}}}function Dt(i){let e,r,t=i[19]+"",a,n;return{c(){e=_("dd"),r=_("a"),a=I(t),this.h()},l(s){e=d(s,"DD",{});var f=m(e);r=d(f,"A",{href:!0});var u=m(r);a=F(u,t),u.forEach(c),f.forEach(c),this.h()},h(){N(r,"href",n="/dao/artifact/"+i[19])},m(s,f){P(s,e,f),o(e,r),o(r,a)},p(s,f){f&1&&t!==(t=s[19]+"")&&ot(a,t),f&1&&n!==(n="/dao/artifact/"+s[19])&&N(r,"href",n)},d(s){s&&c(e)}}}function jt(i){let e;return{c(){e=I("enter text and click go")},l(r){e=F(r,"enter text and click go")},m(r,t){P(r,e,t)},p:K,i:K,o:K,d(r){r&&c(e)}}}function Lt(i){let e,r,t,a,n,s,f,u,b,g,O,T,A,$,y,v,l,E,p,h,S,B,q,R,L,j,z,J,W,X,Q,Z,U,Y,tt,nt;e=new Pt({props:{title:"D3FEND Artifact Extractor | Tools | "}}),a=new Ct({});let x={ctx:i,current:null,token:null,hasCatch:!0,pending:jt,then:Ht,catch:Gt,value:18,error:22,blocks:[,,,]};return mt(U=i[3],x),{c(){rt(e.$$.fragment),r=V(),t=_("section"),rt(a.$$.fragment),n=V(),s=_("div"),f=_("h1"),u=I("D3FEND Artifact Extractor"),b=V(),g=_("p"),O=I("Extracts D3FEND artifacts from blobs of text. You may also want to try the "),T=_("a"),A=I("D3FEND Extractor"),$=I(`
      or `),y=_("a"),v=I("ATT&CK Extractor."),l=V(),E=_("p"),p=_("i"),h=I("Paste any text containing D3FEND Artifacts:"),S=V(),B=_("div"),q=_("textarea"),R=V(),L=_("div"),j=_("button"),z=I("GO"),J=V(),W=_("br"),X=V(),Q=_("br"),Z=V(),x.block.c(),this.h()},l(D){at(e.$$.fragment,D),r=C(D),t=d(D,"SECTION",{class:!0});var k=m(t);at(a.$$.fragment,k),n=C(k),s=d(k,"DIV",{class:!0});var w=m(s);f=d(w,"H1",{});var it=m(f);u=F(it,"D3FEND Artifact Extractor"),it.forEach(c),b=C(w),g=d(w,"P",{});var M=m(g);O=F(M,"Extracts D3FEND artifacts from blobs of text. You may also want to try the "),T=d(M,"A",{href:!0});var ct=m(T);A=F(ct,"D3FEND Extractor"),ct.forEach(c),$=F(M,`
      or `),y=d(M,"A",{href:!0});var ft=m(y);v=F(ft,"ATT&CK Extractor."),ft.forEach(c),M.forEach(c),l=C(w),E=d(w,"P",{class:!0});var ut=m(E);p=d(ut,"I",{});var ht=m(p);h=F(ht,"Paste any text containing D3FEND Artifacts:"),ht.forEach(c),ut.forEach(c),S=C(w),B=d(w,"DIV",{});var _t=m(B);q=d(_t,"TEXTAREA",{class:!0}),m(q).forEach(c),_t.forEach(c),R=C(w),L=d(w,"DIV",{});var dt=m(L);j=d(dt,"BUTTON",{class:!0});var pt=m(j);z=F(pt,"GO"),pt.forEach(c),dt.forEach(c),J=C(w),W=d(w,"BR",{}),w.forEach(c),X=C(k),Q=d(k,"BR",{}),Z=C(k),x.block.l(k),k.forEach(c),this.h()},h(){N(T,"href","/tools/d3fend-extractor"),N(y,"href","/tools/attack-extractor"),N(E,"class","text-2"),N(q,"class","svelte-1bg32kq"),N(j,"class","button"),N(s,"class","card"),N(t,"class"," svelte-1bg32kq")},m(D,k){lt(e,D,k),P(D,r,k),P(D,t,k),lt(a,t,null),o(t,n),o(t,s),o(s,f),o(f,u),o(s,b),o(s,g),o(g,O),o(g,T),o(T,A),o(g,$),o(g,y),o(y,v),o(s,l),o(s,E),o(E,p),o(p,h),o(s,S),o(s,B),o(B,q),vt(q,i[1]),o(s,R),o(s,L),o(L,j),o(j,z),o(s,J),o(s,W),o(t,X),o(t,Q),o(t,Z),x.block.m(t,x.anchor=null),x.mount=()=>t,x.anchor=null,Y=!0,tt||(nt=[et(q,"input",i[8]),et(q,"keypress",i[6]),et(j,"click",i[5])],tt=!0)},p(D,[k]){i=D,k&2&&vt(q,i[1]),x.ctx=i,k&8&&U!==(U=i[3])&&mt(U,x)||It(x,i,k)},i(D){Y||(G(e.$$.fragment,D),G(a.$$.fragment,D),G(x.block),Y=!0)},o(D){H(e.$$.fragment,D),H(a.$$.fragment,D);for(let k=0;k<3;k+=1){const w=x.blocks[k];H(w)}Y=!1},d(D){st(e,D),D&&c(r),D&&c(t),st(a),x.block.d(),x.token=null,x=null,tt=!1,Ft(nt)}}}function Mt(i,e,r){let t;Tt(i,Ot,l=>r(4,t=l));let{data:a}=e;const n=new bt(a.techniques,{index:!0,index_key:"d3f:d3fend-id"});let s,f="",u=!0,b;b=t.url.searchParams.get("q"),console.log("Found params: "+b);let g=[];async function O(l){const E=`/api/dao/artifact/${l}.json`,p=await fetch(E);if(p.status==404)return{id:l,def_to_off:[],description:{graph:[]},status:p.status};if(p.ok){const h=await p.json();return{id:l,def_to_off:h.def_to_off,description:new bt(h.description)}}else throw new Error(f)}async function T(){let l=r(0,s=Array.from(new Set(St(f,n))));return l&&(l.forEach(function(E){let p=O(E);p&&g.push(p)}),t.url.searchParams.set("q",JSON.stringify(l)),history.replaceState(null,"mapping",t.url)),g}let A=T();function $(){r(3,A=T()),r(2,u=!1)}function y(l){l.ctrlKey==!0&&l.keyCode==13&&$()}$t(async()=>{b?(r(1,f=b),console.log("handlingclick"),$()):(console.log("starting blank"),r(1,f=""))});function v(){f=this.value,r(1,f)}return i.$$set=l=>{"data"in l&&r(7,a=l.data)},[s,f,u,A,t,$,y,a,v]}class Zt extends Nt{constructor(e){super(),At(this,e,Mt,Lt,wt,{data:7})}}export{Zt as default};
