import{S as se,i as ae,s as re,G as H,k as R,a as C,q as M,l as E,m as A,h as v,c as y,r as L,n as w,T as D,b as T,H as m,M as Z,J as W,K as V,L as B,g as I,d as N,W as ye,ag as ke,w as Se,F as Ue,y as Oe,z as Me,A as Le,I as Te,B as ze,u as je}from"./index.38e6a1b1.js";import{l as we}from"./lib.1620f930.js";import{a as De}from"./_arrayReduce.865b0d3f.js";import{t as P}from"./toString.f08f8ecc.js";function Ie(e,u,t){var s=-1,a=e.length;u<0&&(u=-u>a?0:a+u),t=t>a?a:t,t<0&&(t+=a),a=u>t?0:t-u>>>0,u>>>=0;for(var o=Array(a);++s<a;)o[s]=e[s+u];return o}function Ne(e,u,t){var s=e.length;return t=t===void 0?s:t,!u&&t>=s?e:Ie(e,u,t)}var Ze="\\ud800-\\udfff",He="\\u0300-\\u036f",We="\\ufe20-\\ufe2f",Ve="\\u20d0-\\u20ff",Be=He+We+Ve,Je="\\ufe0e\\ufe0f",Ge="\\u200d",Pe=RegExp("["+Ge+Ze+Be+Je+"]");function ne(e){return Pe.test(e)}function Fe(e){return e.split("")}var oe="\\ud800-\\udfff",qe="\\u0300-\\u036f",Ye="\\ufe20-\\ufe2f",Ke="\\u20d0-\\u20ff",Qe=qe+Ye+Ke,Xe="\\ufe0e\\ufe0f",eu="["+oe+"]",J="["+Qe+"]",G="\\ud83c[\\udffb-\\udfff]",uu="(?:"+J+"|"+G+")",le="[^"+oe+"]",fe="(?:\\ud83c[\\udde6-\\uddff]){2}",ce="[\\ud800-\\udbff][\\udc00-\\udfff]",tu="\\u200d",de=uu+"?",ie="["+Xe+"]?",su="(?:"+tu+"(?:"+[le,fe,ce].join("|")+")"+ie+de+")*",au=ie+de+su,ru="(?:"+[le+J+"?",J,fe,ce,eu].join("|")+")",nu=RegExp(G+"(?="+G+")|"+ru+au,"g");function ou(e){return e.match(nu)||[]}function lu(e){return ne(e)?ou(e):Fe(e)}function fu(e){return function(u){u=P(u);var t=ne(u)?lu(u):void 0,s=t?t[0]:u.charAt(0),a=t?Ne(t,1).join(""):u.slice(1);return s[e]()+a}}var cu=fu("toUpperCase");const du=cu;function iu(e){return function(u){return e==null?void 0:e[u]}}var hu={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},mu=iu(hu);const _u=mu;var bu=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,gu="\\u0300-\\u036f",pu="\\ufe20-\\ufe2f",xu="\\u20d0-\\u20ff",vu=gu+pu+xu,Ru="["+vu+"]",Eu=RegExp(Ru,"g");function F(e){return e=P(e),e&&e.replace(bu,_u).replace(Eu,"")}var $u=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function Cu(e){return e.match($u)||[]}var Au=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function yu(e){return Au.test(e)}var he="\\ud800-\\udfff",ku="\\u0300-\\u036f",Su="\\ufe20-\\ufe2f",Uu="\\u20d0-\\u20ff",Ou=ku+Su+Uu,me="\\u2700-\\u27bf",_e="a-z\\xdf-\\xf6\\xf8-\\xff",Mu="\\xac\\xb1\\xd7\\xf7",Lu="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Tu="\\u2000-\\u206f",zu=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",be="A-Z\\xc0-\\xd6\\xd8-\\xde",ju="\\ufe0e\\ufe0f",ge=Mu+Lu+Tu+zu,pe="['’]",K="["+ge+"]",wu="["+Ou+"]",xe="\\d+",Du="["+me+"]",ve="["+_e+"]",Re="[^"+he+ge+xe+me+_e+be+"]",Iu="\\ud83c[\\udffb-\\udfff]",Nu="(?:"+wu+"|"+Iu+")",Zu="[^"+he+"]",Ee="(?:\\ud83c[\\udde6-\\uddff]){2}",$e="[\\ud800-\\udbff][\\udc00-\\udfff]",O="["+be+"]",Hu="\\u200d",Q="(?:"+ve+"|"+Re+")",Wu="(?:"+O+"|"+Re+")",X="(?:"+pe+"(?:d|ll|m|re|s|t|ve))?",ee="(?:"+pe+"(?:D|LL|M|RE|S|T|VE))?",Ce=Nu+"?",Ae="["+ju+"]?",Vu="(?:"+Hu+"(?:"+[Zu,Ee,$e].join("|")+")"+Ae+Ce+")*",Bu="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ju="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Gu=Ae+Ce+Vu,Pu="(?:"+[Du,Ee,$e].join("|")+")"+Gu,Fu=RegExp([O+"?"+ve+"+"+X+"(?="+[K,O,"$"].join("|")+")",Wu+"+"+ee+"(?="+[K,O+Q,"$"].join("|")+")",O+"?"+Q+"+"+X,O+"+"+ee,Ju,Bu,xe,Pu].join("|"),"g");function qu(e){return e.match(Fu)||[]}function Yu(e,u,t){return e=P(e),u=t?void 0:u,u===void 0?yu(e)?qu(e):Cu(e):e.match(u)||[]}var Ku="['’]",Qu=RegExp(Ku,"g");function Xu(e){return function(u){return De(Yu(F(u).replace(Qu,"")),e,"")}}var et=Xu(function(e,u,t){return e+(t?" ":"")+du(u)});const z=et;const ut=e=>({}),ue=e=>({}),tt=e=>({}),te=e=>({});function st(e){let u,t,s,a,o,d,f,n,g,b,l,c,_,k,j;const $=e[3].header,i=H($,e,e[2],te),S=e[3].default,p=H(S,e,e[2],null),U=e[3].footer,x=H(U,e,e[2],ue);return{c(){u=R("div"),t=C(),s=R("div"),i&&i.c(),a=C(),o=R("br"),d=C(),p&&p.c(),f=C(),n=R("br"),g=C(),b=R("button"),l=M("close"),c=C(),x&&x.c(),this.h()},l(r){u=E(r,"DIV",{class:!0}),A(u).forEach(v),t=y(r),s=E(r,"DIV",{class:!0});var h=A(s);i&&i.l(h),a=y(h),o=E(h,"BR",{}),d=y(h),p&&p.l(h),f=y(h),n=E(h,"BR",{}),g=y(h),b=E(h,"BUTTON",{class:!0});var Y=A(b);l=L(Y,"close"),Y.forEach(v),c=y(h),x&&x.l(h),h.forEach(v),this.h()},h(){w(u,"class","modal-background svelte-k8bp8l"),D(u,"hidden",e[0]),w(b,"class","svelte-k8bp8l"),w(s,"class","modal svelte-k8bp8l"),D(s,"hidden",e[0])},m(r,h){T(r,u,h),T(r,t,h),T(r,s,h),i&&i.m(s,null),m(s,a),m(s,o),m(s,d),p&&p.m(s,null),m(s,f),m(s,n),m(s,g),m(s,b),m(b,l),m(s,c),x&&x.m(s,null),_=!0,k||(j=[Z(u,"click",e[1]),Z(b,"click",e[1])],k=!0)},p(r,[h]){(!_||h&1)&&D(u,"hidden",r[0]),i&&i.p&&(!_||h&4)&&W(i,$,r,r[2],_?B($,r[2],h,tt):V(r[2]),te),p&&p.p&&(!_||h&4)&&W(p,S,r,r[2],_?B(S,r[2],h,null):V(r[2]),null),x&&x.p&&(!_||h&4)&&W(x,U,r,r[2],_?B(U,r[2],h,ut):V(r[2]),ue),(!_||h&1)&&D(s,"hidden",r[0])},i(r){_||(I(i,r),I(p,r),I(x,r),_=!0)},o(r){N(i,r),N(p,r),N(x,r),_=!1},d(r){r&&v(u),r&&v(t),r&&v(s),i&&i.d(r),p&&p.d(r),x&&x.d(r),k=!1,ye(j)}}}function at(e,u,t){let{$$slots:s={},$$scope:a}=u;const o=ke();let{hidden:d=!1}=u;function f(){console.info("Modal.svelte: closing modal"),o("close"),t(0,d=!0)}return e.$$set=n=>{"hidden"in n&&t(0,d=n.hidden),"$$scope"in n&&t(2,a=n.$$scope)},[d,f,a,s]}class rt extends se{constructor(u){super(),ae(this,u,at,st,re,{hidden:0})}}function nt(e){let u,t,s,a,o,d,f,n,g,b,l,c,_,k,j;return{c(){u=R("div"),t=R("h2"),s=M("Share Extractor Results:"),a=C(),o=R("code"),d=M(e[1]),f=C(),n=R("span"),g=R("button"),b=M("copy"),l=C(),c=R("p"),_=M("Copy the URL above to share the results."),this.h()},l($){u=E($,"DIV",{class:!0});var i=A(u);t=E(i,"H2",{});var S=A(t);s=L(S,"Share Extractor Results:"),S.forEach(v),a=y(i),o=E(i,"CODE",{});var p=A(o);d=L(p,e[1]),p.forEach(v),f=y(i),n=E(i,"SPAN",{});var U=A(n);g=E(U,"BUTTON",{});var x=A(g);b=L(x,"copy"),x.forEach(v),U.forEach(v),l=y(i),c=E(i,"P",{});var r=A(c);_=L(r,"Copy the URL above to share the results."),r.forEach(v),i.forEach(v),this.h()},h(){w(u,"class","content center text-center")},m($,i){T($,u,i),m(u,t),m(t,s),m(u,a),m(u,o),m(o,d),m(u,f),m(u,n),m(n,g),m(g,b),m(u,l),m(u,c),m(c,_),k||(j=Z(g,"click",e[2]),k=!0)},p($,i){i&2&&je(d,$[1])},d($){$&&v(u),k=!1,j()}}}function ot(e){let u,t,s,a,o,d,f,n;function g(l){e[3](l)}let b={$$slots:{default:[nt]},$$scope:{ctx:e}};return e[0]!==void 0&&(b.hidden=e[0]),u=new rt({props:b}),Se.push(()=>Ue(u,"hidden",g)),{c(){Oe(u.$$.fragment),s=C(),a=R("button"),o=M("Share These Results"),this.h()},l(l){Me(u.$$.fragment,l),s=y(l),a=E(l,"BUTTON",{class:!0});var c=A(a);o=L(c,"Share These Results"),c.forEach(v),this.h()},h(){w(a,"class","button")},m(l,c){Le(u,l,c),T(l,s,c),T(l,a,c),m(a,o),d=!0,f||(n=Z(a,"click",e[4]),f=!0)},p(l,[c]){const _={};c&34&&(_.$$scope={dirty:c,ctx:l}),!t&&c&1&&(t=!0,_.hidden=l[0],Te(()=>t=!1)),u.$set(_)},i(l){d||(I(u.$$.fragment,l),d=!0)},o(l){N(u.$$.fragment,l),d=!1},d(l){ze(u,l),l&&v(s),l&&v(a),f=!1,n()}}}function lt(e,u,t){let{url:s}=u,{hidden:a=!0}=u;const o=()=>we(s);function d(n){a=n,t(0,a)}const f=()=>t(0,a=!a);return e.$$set=n=>{"url"in n&&t(1,s=n.url),"hidden"in n&&t(0,a=n.hidden)},[a,s,o,d,f]}class bt extends se{constructor(u){super(),ae(this,u,lt,ot,re,{url:1,hidden:0})}}function ft(e){return e}function q(e,u,t,{match_key:s="rdfs:label",return_key:a="@id",normalizer_f:o=ft,anycasematch:d=!0}={}){if(u.length<1)return[];console.debug(`"Processing ${u.length} terms"`);let f=u.join("|"),n=new RegExp(f,"gi"),g=e.match(n)||[],b=[];return g.forEach(function(l){let c;d?c=t.get_multi_value_anycase(s,o(l)):c=t.get_multi_value(s,o(l)),c?b.push(c[a]):console.debug(o(l)+" Not found in Graph")}),b}function ct(e,u,t){return q(e,u,t,{match_key:"@id"})}function dt(e,u,t){return q(e,u,t,{match_key:"d3f:synonym",normalizer_f:z})}function gt(e,u){let t=u.graph.map(f=>f["rdfs:label"]),s=e.match(/(T|t)([0-9]{4})((\.|\/|\\)([0-9]{3}))?/g)||[],a=e.match(new RegExp(t.join("|"),"ig"))||[],o=[];return a.forEach(function(f){u.get("rdfs:label",z(f))&&o.push(u.get("rdfs:label",z(f))["d3f:attack-id"])}),s&&(s=s.map(f=>f.replace(/(\\|\/)/,".")),s=s.map(f=>f.toUpperCase())),[...s,...o]}function pt(e,u){if(!u.index)throw"Graph object expects index by d3fend-id";e=F(e);let t=u.graph.map(c=>c["rdfs:label"]),s=u.get_all_values("d3f:synonym"),a=e.match(/D3-[A-z]*/g)||[],o=e.match(/d3f:[A-z,-]*/g)||[],d=e.match(new RegExp(t.join("|"),"gi"))||[];console.debug("_id_matches "+a.length),console.debug("_frag_matches "+o.length),console.debug("_label_matches "+d.length);let f=[];a.forEach(function(c){u.i(c)&&f.push(u.i(c)["@id"])});let n=q(e,d,u,{normalizer_f:z}),g=ct(e,o,u),b=dt(e,s,u);return[...g,...f,...n,...b]}function xt(e,u){e=F(e);let t=u.graph.map(n=>n["rdfs:label"]),s=e.match(/d3f:[A-z,-]*/g)||[],a=e.match(new RegExp(t.join("|"),"gi"))||[],o=[];a.forEach(function(n){u.get("rdfs:label",z(n))&&o.push(u.get("rdfs:label",z(n))["@id"])});let d=[];return s.forEach(function(n){u.get("@id",n)&&o.push(u.get("@id",n)["@id"])}),[...d,...o]}export{bt as S,gt as a,pt as b,xt as e};
