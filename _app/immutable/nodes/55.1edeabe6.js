import{e as Fe}from"../chunks/index.5e2a9a64.js";import{s as Pe,a as H,f as h,c as V,g as d,h as D,F as Y,d as o,j as T,i as L,x as i,ab as De,C as ie,D as Me,z as Ke,o as Ue,l as z,m as G,k as Ee,n as Z,y as ee,e as ce,G as Te,E as Ce}from"../chunks/scheduler.50831561.js";import{h as be,u as Oe}from"../chunks/await_block.3cda980a.js";import{e as fe}from"../chunks/each.8d18d1a2.js";import{S as ze,i as Ge,b as he,d as de,m as _e,a as le,t as ae,e as pe,g as Re,c as Se}from"../chunks/index.24431cc3.js";import{H as Je}from"../chunks/Header.66ace148.js";import{T as Xe}from"../chunks/Title.28d88b77.js";import{A as Ye}from"../chunks/Alert.d9b74077.js";import{b as Qe,S as Be}from"../chunks/extract.8fe98a53.js";import{G as ye,c as oe,l as we,k as me,d as ge}from"../chunks/lib.9e57a3f1.js";import{p as We}from"../chunks/stores.9b0ea2d4.js";var Ze={name:"D3FEND Countermeasure Coverage",domain:"enterprise-attack",description:""};class et{constructor(e){this.layer={...Ze},this.layer.techniques=new Array,this.tech_index={},e&&(this.options={...this.options,...e})}add_technique(e){this.tech_index.hasOwnProperty(e.techniqueID)?this.tech_index[e.techniqueID].comment&&this.tech_index[e.techniqueID].comment.indexOf(e.comment)==-1&&(this.tech_index[e.techniqueID].comment+=e.comment):this.tech_index[e.techniqueID]=e}json(){for(let e in this.tech_index)this.layer.techniques.push(this.tech_index[e]);return this.layer}}async function tt({fetch:n}){const e=await n("/api/technique/all.json"),t=await e.json();if(e.status!==200)throw Fe(500,data.message);return{techniques:t}}const Nt=Object.freeze(Object.defineProperty({__proto__:null,load:tt},Symbol.toStringTag,{value:"Module"}));function qe(n,e,t){const l=n.slice();return l[22]=e[t],l}function Ie(n,e,t){const l=n.slice();return l[26]=e[t],l}function Ne(n,e,t){const l=n.slice();return l[30]=e[t],l}function lt(n){let e,t=n[29].message+"",l;return{c(){e=h("p"),l=z(t),this.h()},l(a){e=d(a,"P",{style:!0});var r=D(e);l=G(r,t),r.forEach(o),this.h()},h(){Ee(e,"color","red")},m(a,r){L(a,e,r),i(e,l)},p(a,r){r[0]&32&&t!==(t=a[29].message+"")&&Z(l,t)},i:ee,o:ee,d(a){a&&o(e)}}}function at(n){let e,t,l,a;const r=[rt,nt],s=[];function u(_,b){return _[21].length>0?0:!_[3]&&_[21].length<1?1:-1}return~(e=u(n))&&(t=s[e]=r[e](n)),{c(){t&&t.c(),l=ce()},l(_){t&&t.l(_),l=ce()},m(_,b){~e&&s[e].m(_,b),L(_,l,b),a=!0},p(_,b){let N=e;e=u(_),e===N?~e&&s[e].p(_,b):(t&&(Re(),ae(s[N],1,1,()=>{s[N]=null}),Se()),~e?(t=s[e],t?t.p(_,b):(t=s[e]=r[e](_),t.c()),le(t,1),t.m(l.parentNode,l)):t=null)},i(_){a||(le(t),a=!0)},o(_){ae(t),a=!1},d(_){_&&o(l),~e&&s[e].d(_)}}}function nt(n){let e,t="No D3FEND techniques found in text.";return{c(){e=h("div"),e.textContent=t,this.h()},l(l){e=d(l,"DIV",{class:!0,"data-svelte-h":!0}),Y(e)!=="svelte-8bvq89"&&(e.textContent=t),this.h()},h(){T(e,"class","card")},m(l,a){L(l,e,a)},p:ee,i:ee,o:ee,d(l){l&&o(e)}}}function rt(n){let e,t,l,a,r,s,u,_,b,N,m,C="<b><i>Mapping Results:</i></b>",k,O,$,E="Download ATT&CK Navigator Layer",c,v,f,p,y,S="copy",w,x,j,F='<th class="stretch">D3FEND ID</th> <th>D3FEND Name</th> <th>Related ATT&amp;CK Techniques</th>',X,J,K,te,I=n[0]&&xe(n);a=new Ye({props:{$$slots:{default:[st]},$$scope:{ctx:n}}}),b=new Be({props:{url:n[6].url}});function R(g,P){return g[2]?it:ot}let M=R(n),q=M(n),A=fe(n[21]),B=[];for(let g=0;g<A.length;g+=1)B[g]=He(qe(n,A,g));return{c(){e=h("div"),I&&I.c(),t=H(),l=h("div"),he(a.$$.fragment),r=H(),s=h("div"),u=h("div"),_=h("div"),he(b.$$.fragment),N=H(),m=h("div"),m.innerHTML=C,k=H(),O=h("div"),$=h("button"),$.textContent=E,c=H(),v=h("div"),f=h("div"),q.c(),p=H(),y=h("button"),y.textContent=S,w=H(),x=h("table"),j=h("thead"),j.innerHTML=F,X=H();for(let g=0;g<B.length;g+=1)B[g].c();this.h()},l(g){e=d(g,"DIV",{class:!0});var P=D(e);I&&I.l(P),P.forEach(o),t=V(g),l=d(g,"DIV",{class:!0});var W=D(l);de(a.$$.fragment,W),W.forEach(o),r=V(g),s=d(g,"DIV",{class:!0});var Q=D(s);u=d(Q,"DIV",{class:!0});var U=D(u);_=d(U,"DIV",{class:!0});var ne=D(_);de(b.$$.fragment,ne),ne.forEach(o),U.forEach(o),N=V(Q),m=d(Q,"DIV",{"data-svelte-h":!0}),Y(m)!=="svelte-1hnfu3y"&&(m.innerHTML=C),k=V(Q),O=d(Q,"DIV",{class:!0});var ue=D(O);$=d(ue,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),Y($)!=="svelte-9h51sy"&&($.textContent=E),ue.forEach(o),c=V(Q),v=d(Q,"DIV",{class:!0});var re=D(v);f=d(re,"DIV",{class:!0});var se=D(f);q.l(se),p=V(se),y=d(se,"BUTTON",{"data-svelte-h":!0}),Y(y)!=="svelte-1gemhfw"&&(y.textContent=S),se.forEach(o),w=V(re),x=d(re,"TABLE",{id:!0,class:!0});var ve=D(x);j=d(ve,"THEAD",{"data-svelte-h":!0}),Y(j)!=="svelte-17gzi8u"&&(j.innerHTML=F),X=V(ve);for(let ke=0;ke<B.length;ke+=1)B[ke].l(ve);ve.forEach(o),re.forEach(o),Q.forEach(o),this.h()},h(){T(e,"class","card"),T(l,"class","card"),T(_,"class","text-right"),T(u,"class","stretch"),T($,"class","small button"),T($,"title","Load into Navigator to see related TTPs"),T(O,"class","text-right"),T(f,"class","text-right"),T(x,"id","mappings"),T(x,"class","table-auto"),T(v,"class","results-wrap center svelte-xumjr3"),T(s,"class","card")},m(g,P){L(g,e,P),I&&I.m(e,null),L(g,t,P),L(g,l,P),_e(a,l,null),L(g,r,P),L(g,s,P),i(s,u),i(u,_),_e(b,_,null),i(s,N),i(s,m),i(s,k),i(s,O),i(O,$),i(s,c),i(s,v),i(v,f),q.m(f,null),i(f,p),i(f,y),i(v,w),i(v,x),i(x,j),i(x,X);for(let W=0;W<B.length;W+=1)B[W]&&B[W].m(x,null);J=!0,K||(te=[ie($,"click",n[7]),ie(y,"click",vt)],K=!0)},p(g,P){g[0]?I?(I.p(g,P),P[0]&1&&le(I,1)):(I=xe(g),I.c(),le(I,1),I.m(e,null)):I&&(Re(),ae(I,1,1,()=>{I=null}),Se());const W={};P[1]&4&&(W.$$scope={dirty:P,ctx:g}),a.$set(W);const Q={};if(P[0]&64&&(Q.url=g[6].url),b.$set(Q),M===(M=R(g))&&q?q.p(g,P):(q.d(1),q=M(g),q&&(q.c(),q.m(f,p))),P[0]&48){A=fe(g[21]);let U;for(U=0;U<A.length;U+=1){const ne=qe(g,A,U);B[U]?B[U].p(ne,P):(B[U]=He(ne),B[U].c(),B[U].m(x,null))}for(;U<B.length;U+=1)B[U].d(1);B.length=A.length}},i(g){J||(le(I),le(a.$$.fragment,g),le(b.$$.fragment,g),J=!0)},o(g){ae(I),ae(a.$$.fragment,g),ae(b.$$.fragment,g),J=!1},d(g){g&&(o(e),o(t),o(l),o(r),o(s)),I&&I.d(),pe(a),pe(b),q.d(),Te(B,g),K=!1,Me(te)}}}function xe(n){let e,t,l,a,r,s,u,_,b=n[0].length+"",N,m,C,k,O;l=new Be({props:{url:n[6].url}});let $=fe(n[0]),E=[];for(let c=0;c<$.length;c+=1)E[c]=Ae(Ne(n,$,c));return{c(){e=h("div"),t=h("div"),he(l.$$.fragment),a=H(),r=h("div"),s=h("b"),u=h("i"),_=z("Extracted "),N=z(b),m=z(" unique IDs:"),C=H(),k=h("dl");for(let c=0;c<E.length;c+=1)E[c].c();this.h()},l(c){e=d(c,"DIV",{class:!0});var v=D(e);t=d(v,"DIV",{class:!0});var f=D(t);de(l.$$.fragment,f),f.forEach(o),v.forEach(o),a=V(c),r=d(c,"DIV",{class:!0});var p=D(r);s=d(p,"B",{});var y=D(s);u=d(y,"I",{});var S=D(u);_=G(S,"Extracted "),N=G(S,b),m=G(S," unique IDs:"),S.forEach(o),y.forEach(o),C=V(p),k=d(p,"DL",{class:!0});var w=D(k);for(let x=0;x<E.length;x+=1)E[x].l(w);w.forEach(o),p.forEach(o),this.h()},h(){T(t,"class","text-right"),T(e,"class","stretch"),T(k,"class","flex flex-wrap svelte-xumjr3"),T(r,"class","")},m(c,v){L(c,e,v),i(e,t),_e(l,t,null),L(c,a,v),L(c,r,v),i(r,s),i(s,u),i(u,_),i(u,N),i(u,m),i(r,C),i(r,k);for(let f=0;f<E.length;f+=1)E[f]&&E[f].m(k,null);O=!0},p(c,v){const f={};if(v[0]&64&&(f.url=c[6].url),l.$set(f),(!O||v[0]&1)&&b!==(b=c[0].length+"")&&Z(N,b),v[0]&1){$=fe(c[0]);let p;for(p=0;p<$.length;p+=1){const y=Ne(c,$,p);E[p]?E[p].p(y,v):(E[p]=Ae(y),E[p].c(),E[p].m(k,null))}for(;p<E.length;p+=1)E[p].d(1);E.length=$.length}},i(c){O||(le(l.$$.fragment,c),O=!0)},o(c){ae(l.$$.fragment,c),O=!1},d(c){c&&(o(e),o(a),o(r)),pe(l),Te(E,c)}}}function Ae(n){let e,t,l=n[30]+"",a,r;return{c(){e=h("dd"),t=h("a"),a=z(l),this.h()},l(s){e=d(s,"DD",{});var u=D(e);t=d(u,"A",{href:!0});var _=D(t);a=G(_,l),_.forEach(o),u.forEach(o),this.h()},h(){T(t,"href",r="/technique/"+n[30])},m(s,u){L(s,e,u),i(e,t),i(t,a)},p(s,u){u[0]&1&&l!==(l=s[30]+"")&&Z(a,l),u[0]&1&&r!==(r="/technique/"+s[30])&&T(t,"href",r)},d(s){s&&o(e)}}}function st(n){let e,t="Note: ",l;return{c(){e=h("b"),e.textContent=t,l=z(`These relationships are generated based on the digital
          artifacts specified for the offensive and defensive techniques. They
          are designed to give you ideas, they are not designed to be exact
          matches or indicate precise coverage. They can be used to better
          understand the technologies, ask better questions, and develop test
          plans for your countermeasures.`)},l(a){e=d(a,"B",{"data-svelte-h":!0}),Y(e)!=="svelte-gwu32y"&&(e.textContent=t),l=G(a,`These relationships are generated based on the digital
          artifacts specified for the offensive and defensive techniques. They
          are designed to give you ideas, they are not designed to be exact
          matches or indicate precise coverage. They can be used to better
          understand the technologies, ask better questions, and develop test
          plans for your countermeasures.`)},m(a,r){L(a,e,r),L(a,l,r)},p:ee,d(a){a&&(o(e),o(l))}}}function ot(n){let e,t="select",l,a;return{c(){e=h("button"),e.textContent=t,this.h()},l(r){e=d(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(e)!=="svelte-3feg34"&&(e.textContent=t),this.h()},h(){T(e,"class","selector svelte-xumjr3")},m(r,s){L(r,e,s),l||(a=ie(e,"click",n[10]),l=!0)},p:ee,d(r){r&&o(e),l=!1,a()}}}function it(n){let e,t="deselect",l,a;return{c(){e=h("button"),e.textContent=t,this.h()},l(r){e=d(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(e)!=="svelte-iey0zo"&&(e.textContent=t),this.h()},h(){T(e,"class","selector svelte-xumjr3")},m(r,s){L(r,e,s),l||(a=ie(e,"click",n[9]),l=!0)},p:ee,d(r){r&&o(e),l=!1,a()}}}function ct(n){let e,t=n[29].message+"",l;return{c(){e=h("p"),l=z(t),this.h()},l(a){e=d(a,"P",{style:!0});var r=D(e);l=G(r,t),r.forEach(o),this.h()},h(){Ee(e,"color","red")},m(a,r){L(a,e,r),i(e,l)},p(a,r){r[0]&32&&t!==(t=a[29].message+"")&&Z(l,t)},d(a){a&&o(e)}}}function ft(n){let e;function t(r,s){return r[25].description.graph[0]?ht:ut}let l=t(n),a=l(n);return{c(){a.c(),e=ce()},l(r){a.l(r),e=ce()},m(r,s){a.m(r,s),L(r,e,s)},p(r,s){l===(l=t(r))&&a?a.p(r,s):(a.d(1),a=l(r),a&&(a.c(),a.m(e.parentNode,e)))},d(r){r&&o(e),a.d(r)}}}function ut(n){let e,t,l=n[25].id+"",a,r,s,u,_="not found in D3FEND graph",b,N;return{c(){e=h("td"),t=h("a"),a=z(l),s=H(),u=h("td"),u.textContent=_,b=H(),N=h("td"),this.h()},l(m){e=d(m,"TD",{class:!0});var C=D(e);t=d(C,"A",{style:!0,href:!0});var k=D(t);a=G(k,l),k.forEach(o),C.forEach(o),s=V(m),u=d(m,"TD",{"data-svelte-h":!0}),Y(u)!=="svelte-mgiypo"&&(u.textContent=_),b=V(m),N=d(m,"TD",{}),D(N).forEach(o),this.h()},h(){Ee(t,"color","red"),T(t,"href",r=we(n[25].id)),T(e,"class","text-center")},m(m,C){L(m,e,C),i(e,t),i(t,a),L(m,s,C),L(m,u,C),L(m,b,C),L(m,N,C)},p(m,C){C[0]&32&&l!==(l=m[25].id+"")&&Z(a,l),C[0]&32&&r!==(r=we(m[25].id))&&T(t,"href",r)},d(m){m&&(o(e),o(s),o(u),o(b),o(N))}}}function ht(n){let e,t,l=n[25].description.graph[0]["d3f:d3fend-id"]+"",a,r,s,u,_=n[25].description.graph[0]["rdfs:label"]+"",b,N,m,C,k,O='<th scope="col">defensive verb</th> <th scope="col">defensive artifact</th> <th scope="col">ATT&amp;CK Technique</th> <th scope="col">offensive verb</th> <th scope="col">offensive artifact</th> <th scope="col">ATT&amp;CK ID</th>',$,E=fe(Ve(n[25].def_to_off.results.bindings)),c=[];for(let f=0;f<E.length;f+=1)c[f]=$e(Ie(n,E,f));let v=null;return E.length||(v=Le()),{c(){e=h("th"),t=h("a"),a=z(l),s=H(),u=h("td"),b=z(_),N=H(),m=h("td"),C=h("table"),k=h("thead"),k.innerHTML=O,$=H();for(let f=0;f<c.length;f+=1)c[f].c();v&&v.c(),this.h()},l(f){e=d(f,"TH",{class:!0,scope:!0});var p=D(e);t=d(p,"A",{href:!0});var y=D(t);a=G(y,l),y.forEach(o),p.forEach(o),s=V(f),u=d(f,"TD",{});var S=D(u);b=G(S,_),S.forEach(o),N=V(f),m=d(f,"TD",{});var w=D(m);C=d(w,"TABLE",{class:!0});var x=D(C);k=d(x,"THEAD",{class:!0,"data-svelte-h":!0}),Y(k)!=="svelte-1r9g4lp"&&(k.innerHTML=O),$=V(x);for(let j=0;j<c.length;j+=1)c[j].l(x);v&&v.l(x),x.forEach(o),w.forEach(o),this.h()},h(){T(t,"href",r="/technique/"+n[25].description.graph[0]["@id"]),T(e,"class","text-center"),T(e,"scope","row"),T(k,"class","svelte-xumjr3"),Ce(k,"hide",n[4]),T(C,"class","table-auto w100 svelte-xumjr3")},m(f,p){L(f,e,p),i(e,t),i(t,a),L(f,s,p),L(f,u,p),i(u,b),L(f,N,p),L(f,m,p),i(m,C),i(C,k),i(C,$);for(let y=0;y<c.length;y+=1)c[y]&&c[y].m(C,null);v&&v.m(C,null)},p(f,p){if(p[0]&32&&l!==(l=f[25].description.graph[0]["d3f:d3fend-id"]+"")&&Z(a,l),p[0]&32&&r!==(r="/technique/"+f[25].description.graph[0]["@id"])&&T(t,"href",r),p[0]&32&&_!==(_=f[25].description.graph[0]["rdfs:label"]+"")&&Z(b,_),p[0]&16&&Ce(k,"hide",f[4]),p[0]&32){E=fe(Ve(f[25].def_to_off.results.bindings));let y;for(y=0;y<E.length;y+=1){const S=Ie(f,E,y);c[y]?c[y].p(S,p):(c[y]=$e(S),c[y].c(),c[y].m(C,null))}for(;y<c.length;y+=1)c[y].d(1);c.length=E.length,!E.length&&v?v.p(f,p):E.length?v&&(v.d(1),v=null):(v=Le(),v.c(),v.m(C,null))}},d(f){f&&(o(e),o(s),o(u),o(N),o(m)),Te(c,f),v&&v.d()}}}function Le(n){let e,t='no defensive relations <a href="/contribute">yet</a> ';return{c(){e=h("td"),e.innerHTML=t,this.h()},l(l){e=d(l,"TD",{colspan:!0,"data-svelte-h":!0}),Y(e)!=="svelte-3z0dm2"&&(e.innerHTML=t),this.h()},h(){T(e,"colspan","5")},m(l,a){L(l,e,a)},p:ee,d(l){l&&o(e)}}}function je(n){let e,t,l=n[26].def_artifact_rel_label.value+"",a,r,s,u,_=n[26].def_artifact_label.value+"",b,N,m,C,k,O=n[26].off_tech_label.value+"",$,E,c,v,f=n[26].off_artifact_rel_label.value+"",p,y,S,w,x=n[26].off_artifact_label.value+"",j,F,X,J,K,te=oe(n[26].off_tech.value)+"",I,R,M;return{c(){e=h("tr"),t=h("td"),a=z(l),r=H(),s=h("td"),u=h("a"),b=z(_),m=H(),C=h("td"),k=h("a"),$=z(O),c=H(),v=h("td"),p=z(f),y=H(),S=h("td"),w=h("a"),j=z(x),X=H(),J=h("td"),K=h("a"),I=z(te),M=H(),this.h()},l(q){e=d(q,"TR",{});var A=D(e);t=d(A,"TD",{});var B=D(t);a=G(B,l),B.forEach(o),r=V(A),s=d(A,"TD",{});var g=D(s);u=d(g,"A",{href:!0});var P=D(u);b=G(P,_),P.forEach(o),g.forEach(o),m=V(A),C=d(A,"TD",{});var W=D(C);k=d(W,"A",{href:!0});var Q=D(k);$=G(Q,O),Q.forEach(o),W.forEach(o),c=V(A),v=d(A,"TD",{});var U=D(v);p=G(U,f),U.forEach(o),y=V(A),S=d(A,"TD",{});var ne=D(S);w=d(ne,"A",{href:!0});var ue=D(w);j=G(ue,x),ue.forEach(o),ne.forEach(o),X=V(A),J=d(A,"TD",{});var re=D(J);K=d(re,"A",{href:!0});var se=D(K);I=G(se,te),se.forEach(o),re.forEach(o),M=V(A),A.forEach(o),this.h()},h(){T(u,"href",N="/dao/artifact/"+me(n[26].def_artifact.value)),T(k,"href",E=ge(oe(n[26].off_tech.value))),T(w,"href",F="/dao/artifact/"+me(n[26].off_artifact.value)),T(K,"href",R=ge(oe(n[26].off_tech.value)))},m(q,A){L(q,e,A),i(e,t),i(t,a),i(e,r),i(e,s),i(s,u),i(u,b),i(e,m),i(e,C),i(C,k),i(k,$),i(e,c),i(e,v),i(v,p),i(e,y),i(e,S),i(S,w),i(w,j),i(e,X),i(e,J),i(J,K),i(K,I),i(e,M)},p(q,A){A[0]&32&&l!==(l=q[26].def_artifact_rel_label.value+"")&&Z(a,l),A[0]&32&&_!==(_=q[26].def_artifact_label.value+"")&&Z(b,_),A[0]&32&&N!==(N="/dao/artifact/"+me(q[26].def_artifact.value))&&T(u,"href",N),A[0]&32&&O!==(O=q[26].off_tech_label.value+"")&&Z($,O),A[0]&32&&E!==(E=ge(oe(q[26].off_tech.value)))&&T(k,"href",E),A[0]&32&&f!==(f=q[26].off_artifact_rel_label.value+"")&&Z(p,f),A[0]&32&&x!==(x=q[26].off_artifact_label.value+"")&&Z(j,x),A[0]&32&&F!==(F="/dao/artifact/"+me(q[26].off_artifact.value))&&T(w,"href",F),A[0]&32&&te!==(te=oe(q[26].off_tech.value)+"")&&Z(I,te),A[0]&32&&R!==(R=ge(oe(q[26].off_tech.value)))&&T(K,"href",R)},d(q){q&&o(e)}}}function $e(n){let e,t=n[26].def_tech&&je(n);return{c(){t&&t.c(),e=ce()},l(l){t&&t.l(l),e=ce()},m(l,a){t&&t.m(l,a),L(l,e,a)},p(l,a){l[26].def_tech?t?t.p(l,a):(t=je(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&o(e),t&&t.d(l)}}}function dt(n){let e;return{c(){e=z("loading...")},l(t){e=G(t,"loading...")},m(t,l){L(t,e,l)},p:ee,d(t){t&&o(e)}}}function He(n){let e,t,l,a={ctx:n,current:null,token:null,hasCatch:!0,pending:dt,then:ft,catch:ct,value:25,error:29};return be(t=n[22],a),{c(){e=h("tr"),a.block.c(),l=H()},l(r){e=d(r,"TR",{});var s=D(e);a.block.l(s),l=V(s),s.forEach(o)},m(r,s){L(r,e,s),a.block.m(e,a.anchor=null),a.mount=()=>e,a.anchor=l,i(e,l)},p(r,s){n=r,a.ctx=n,s[0]&32&&t!==(t=n[22])&&be(t,a)||Oe(a,n,s)},d(r){r&&o(e),a.block.d(),a.token=null,a=null}}}function _t(n){let e;return{c(){e=z("enter text and click go")},l(t){e=G(t,"enter text and click go")},m(t,l){L(t,e,l)},p:ee,i:ee,o:ee,d(t){t&&o(e)}}}function pt(n){let e,t,l,a,r,s,u,_="D3FEND Extractor",b,N,m=`Extracts D3FEND techniques from blobs of text and identifies <i>related</i>
      ATT&amp;CK Techniques. You may also want to try the
      <a href="/tools/attack-extractor">ATT&amp;CK Extractor</a>
      or the <a href="/tools/artifact-extractor">Artifact Extractor.</a>`,C,k,O="<i>Paste any text containing D3FEND techniques:</i>",$,E,c,v,f,p,y="GO",S,w,x,j,F,X,J,K,te;e=new Xe({props:{title:"D3FEND Extractor | Tools | "}}),a=new Je({props:{header:"D3FEND Extractor"}});let I={ctx:n,current:null,token:null,hasCatch:!0,pending:_t,then:at,catch:lt,value:21,error:29,blocks:[,,,]};return be(X=n[5],I),{c(){he(e.$$.fragment),t=H(),l=h("section"),he(a.$$.fragment),r=H(),s=h("div"),u=h("h1"),u.textContent=_,b=H(),N=h("p"),N.innerHTML=m,C=H(),k=h("p"),k.innerHTML=O,$=H(),E=h("div"),c=h("textarea"),v=H(),f=h("div"),p=h("button"),p.textContent=y,S=H(),w=h("br"),x=H(),j=h("br"),F=H(),I.block.c(),this.h()},l(R){de(e.$$.fragment,R),t=V(R),l=d(R,"SECTION",{class:!0});var M=D(l);de(a.$$.fragment,M),r=V(M),s=d(M,"DIV",{class:!0});var q=D(s);u=d(q,"H1",{"data-svelte-h":!0}),Y(u)!=="svelte-m1jolu"&&(u.textContent=_),b=V(q),N=d(q,"P",{"data-svelte-h":!0}),Y(N)!=="svelte-7fdplx"&&(N.innerHTML=m),C=V(q),k=d(q,"P",{class:!0,"data-svelte-h":!0}),Y(k)!=="svelte-5yux8l"&&(k.innerHTML=O),$=V(q),E=d(q,"DIV",{});var A=D(E);c=d(A,"TEXTAREA",{class:!0}),D(c).forEach(o),A.forEach(o),v=V(q),f=d(q,"DIV",{});var B=D(f);p=d(B,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(p)!=="svelte-88k995"&&(p.textContent=y),B.forEach(o),S=V(q),w=d(q,"BR",{}),q.forEach(o),x=V(M),j=d(M,"BR",{}),F=V(M),I.block.l(M),M.forEach(o),this.h()},h(){T(k,"class","text-2"),T(c,"class","svelte-xumjr3"),T(p,"class","button"),T(s,"class","card"),T(l,"class"," svelte-xumjr3")},m(R,M){_e(e,R,M),L(R,t,M),L(R,l,M),_e(a,l,null),i(l,r),i(l,s),i(s,u),i(s,b),i(s,N),i(s,C),i(s,k),i(s,$),i(s,E),i(E,c),De(c,n[1]),i(s,v),i(s,f),i(f,p),i(s,S),i(s,w),i(l,x),i(l,j),i(l,F),I.block.m(l,I.anchor=null),I.mount=()=>l,I.anchor=null,J=!0,K||(te=[ie(c,"input",n[13]),ie(c,"keypress",n[11]),ie(p,"click",n[8])],K=!0)},p(R,M){n=R,M[0]&2&&De(c,n[1]),I.ctx=n,M[0]&32&&X!==(X=n[5])&&be(X,I)||Oe(I,n,M)},i(R){J||(le(e.$$.fragment,R),le(a.$$.fragment,R),le(I.block),J=!0)},o(R){ae(e.$$.fragment,R),ae(a.$$.fragment,R);for(let M=0;M<3;M+=1){const q=I.blocks[M];ae(q)}J=!1},d(R){R&&(o(t),o(l)),pe(e,R),pe(a),I.block.d(),I.token=null,I=null,K=!1,Me(te)}}}function vt(){document.execCommand("copy")}function Ve(n){let e=new Set,t=[];return n.forEach(function(l){l.hasOwnProperty("off_tech_label")&&(e.has(l.off_tech_label.value)||(e.add(l.off_tech_label.value),t.push(l)))}),t}function mt(n,e,t){let l;Ke(n,We,w=>t(6,l=w));let{data:a}=e,r=new ye(a.techniques,{index:!0,index_key:"d3f:d3fend-id"}),s,u="",_=!1,b=!0,N,m=[];function C(){t(0,s=[]),t(2,_=!1),t(3,b=!0),m=[]}N=l.url.searchParams.get("q"),console.log("Found params: "+N);let k=!1;async function O(){let w=new et,x=await Promise.all(m);x.forEach(function(J){J.def_to_off.results.bindings.forEach(function(K){w.add_technique({techniqueID:oe(K.off_tech.value),comment:`
`+K.def_tech_label.value+`
`,color:"#9ecae1"})})});let j=`"Navigator_Layer-${x.length}-D3FEND-Techniques.json"`;const F=document.createElement("a"),X=new Blob([JSON.stringify(w.json())],{type:"application/json;charset=utf-8"});F.href=URL.createObjectURL(X),F.download=j,F.click()}async function $(w){let x="/api/technique/"+w+".json";const j=await fetch(x);if(j.status==404)return{id:w,def_to_off:[],description:{graph:[]},status:j.status};if(j.ok){const F=await j.json();return{id:w,def_to_off:F.def_to_off,description:new ye(F.description)}}else throw new Error(u)}async function E(){C();let w=t(0,s=Array.from(new Set(Qe(u,r))));if(w)return w.forEach(function(x){let j;j=$(x),j&&m.push(j)}),l.url.searchParams.set("q",JSON.stringify(w)),history.replaceState(null,"mapping",l.url),m;C(),console.debug("no matches")}let c=E();function v(){t(5,c=E()),t(3,b=!1)}function f(){window.getSelection().removeAllRanges(),t(2,_=!1),t(4,k=!1)}function p(){t(4,k=!0);let w="mappings";const x=window.getSelection();x.removeAllRanges();let j=document.getElementById(w);const F=document.createRange();F.selectNodeContents(j),x.addRange(F),t(2,_=!0)}function y(w){w.ctrlKey==!0&&w.keyCode==13&&v()}Ue(async()=>{N?(t(1,u=N),console.log("handlingclick"),v()):(console.log("starting blank"),t(1,u=""))});function S(){u=this.value,t(1,u)}return n.$$set=w=>{"data"in w&&t(12,a=w.data)},[s,u,_,b,k,c,l,O,v,f,p,y,a,S]}class xt extends ze{constructor(e){super(),Ge(this,e,mt,pt,Pe,{data:12},null,[-1,-1])}}export{xt as component,Nt as universal};
