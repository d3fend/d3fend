import{e as Ve}from"../chunks/index.aHWtvSLc.js";import{s as me,V as Oe,e as B,b as P,A as te,d as R,j as G,f as X,i as s,w as U,k as u,W as Pe,v as oe,n as ne,t as d,h as p,I as je,m as L,c as Ge,l as I,u as He,g as ze,a as Fe}from"../chunks/scheduler.rYb7pZZG.js";import{S as Le,i as Me,f as Ke,c as fe,b as ae,m as ie,g as ve,a as H,e as de,t as V,d as _e}from"../chunks/index.DuGWJhq4.js";import{e as be}from"../chunks/each.shjUScpc.js";import{g as Ue}from"../chunks/entry.8gGhBGir.js";import{j as We,T as Je,i as O,f as ce,G as $e,h as Qe}from"../chunks/lib.FzuLk5Dt.js";import{T as Xe}from"../chunks/Title.-2iHfz2o.js";import{B as he}from"../chunks/Button.fjD-fXUp.js";import{A as Ye}from"../chunks/Alert.4Peyoxud.js";import{M as Ze}from"../chunks/Modal_full.LBxOa2Ag.js";import{G as ye}from"../chunks/_Graph.8vsriYIQ.js";import{T as xe,t as ke}from"../chunks/ToggleBar.xqhK0hPm.js";async function el({params:i,fetch:f}){const a=i.technique,l=await f(`/api/offensive-technique/attack/${a}.json`),{description:e,off_to_def:t,subtechniques:_}=await l.json();return l.status!==200&&Ve(500,data.message),{description:e,off_to_def:t,technique_id:a,subtechniques:_}}const Al=Object.freeze(Object.defineProperty({__proto__:null,load:el},Symbol.toStringTag,{value:"Module"}));function ge(i,f,a){const l=i.slice();return l[6]=f[a],l}function ll(i){let f,a=`There are no digital artifacts defined on this offensive technique (yet).
    Please consider <a href="/contribute">contributing</a> an addition to D3FEND.`;return{c(){f=B("small"),f.innerHTML=a},l(l){f=R(l,"SMALL",{"data-svelte-h":!0}),oe(f)!=="svelte-1ymw1cs"&&(f.innerHTML=a)},m(l,e){u(l,f,e)},p:ne,i:ne,o:ne,d(l){l&&s(f)}}}function tl(i){let f=i[1],a,l,e=De(i);return{c(){e.c(),a=te()},l(t){e.l(t),a=te()},m(t,_){e.m(t,_),u(t,a,_),l=!0},p(t,_){_&2&&me(f,f=t[1])?(ve(),H(e,1,1,ne),de(),e=De(t),e.c(),V(e,1),e.m(a.parentNode,a)):e.p(t,_)},i(t){l||(V(e),l=!0)},o(t){H(e),l=!1},d(t){t&&s(a),e.d(t)}}}function qe(i){let f=i[2].edge_is_unique(i[6].def_tech_label.value,i[6].def_artifact_rel_label.value,i[6].off_artifact_label.value),a,l=f&&Te(i);return{c(){l&&l.c(),a=te()},l(e){l&&l.l(e),a=te()},m(e,t){l&&l.m(e,t),u(e,a,t)},p(e,t){t&1&&(f=e[2].edge_is_unique(e[6].def_tech_label.value,e[6].def_artifact_rel_label.value,e[6].off_artifact_label.value)),f?l?l.p(e,t):(l=Te(e),l.c(),l.m(a.parentNode,a)):l&&(l.d(1),l=null)},d(e){e&&s(a),l&&l.d(e)}}}function Te(i){let f=!i[1].includes(i[6].def_tactic_label.value),a,l=f&&Ee(i);return{c(){l&&l.c(),a=te()},l(e){l&&l.l(e),a=te()},m(e,t){l&&l.m(e,t),u(e,a,t)},p(e,t){t&3&&(f=!e[1].includes(e[6].def_tactic_label.value)),f?l?l.p(e,t):(l=Ee(e),l.c(),l.m(a.parentNode,a)):l&&(l.d(1),l=null)},d(e){e&&s(a),l&&l.d(e)}}}function Ee(i){let f=O(i[6].def_tech.value)+"",a,l,e=i[6].def_tech_label.value+"",t,_,b="-->",w,m,E=i[6].def_artifact_rel_label.value.replace(/ /g,"")+"",r,$,h=O(i[6].off_artifact.value)+"",D,S,T=i[6].off_artifact_label.value+"",q,g,k=i[2].edge_is_unique(i[6].def_tech.value,i[6].def_tactic_label.value,i[6].off_tech_id.value),c,C=i[6].def_tech_label.value.replace(/ |\./g,"")+"",K,F,y=i[6].off_artifact_label.value.replace(/ /g,"")+"",Y,x,ee=O(i[6].def_tech.value)+"",Z,z,le=O(i[6].def_tech.value)+"",W,M,A=k&&we(i);return{c(){a=d(f),l=d('["'),t=d(e),_=d('"] '),w=d(b),m=d(`
          | `),r=d(E),$=d(" | "),D=d(h),S=d('["'),q=d(T),g=d(`"];

          `),A&&A.c(),c=d(`
          class `),K=d(C),F=d(` DefensiveTechniqueNode;
          class `),Y=d(y),x=d(` ArtifactNode;
          click `),Z=d(ee),z=d(' href "/technique/d3f:'),W=d(le),M=d('";')},l(n){a=p(n,f),l=p(n,'["'),t=p(n,e),_=p(n,'"] '),w=p(n,b),m=p(n,`
          | `),r=p(n,E),$=p(n," | "),D=p(n,h),S=p(n,'["'),q=p(n,T),g=p(n,`"];

          `),A&&A.l(n),c=p(n,`
          class `),K=p(n,C),F=p(n,` DefensiveTechniqueNode;
          class `),Y=p(n,y),x=p(n,` ArtifactNode;
          click `),Z=p(n,ee),z=p(n,' href "/technique/d3f:'),W=p(n,le),M=p(n,'";')},m(n,o){u(n,a,o),u(n,l,o),u(n,t,o),u(n,_,o),u(n,w,o),u(n,m,o),u(n,r,o),u(n,$,o),u(n,D,o),u(n,S,o),u(n,q,o),u(n,g,o),A&&A.m(n,o),u(n,c,o),u(n,K,o),u(n,F,o),u(n,Y,o),u(n,x,o),u(n,Z,o),u(n,z,o),u(n,W,o),u(n,M,o)},p(n,o){o&1&&f!==(f=O(n[6].def_tech.value)+"")&&L(a,f),o&1&&e!==(e=n[6].def_tech_label.value+"")&&L(t,e),o&1&&E!==(E=n[6].def_artifact_rel_label.value.replace(/ /g,"")+"")&&L(r,E),o&1&&h!==(h=O(n[6].off_artifact.value)+"")&&L(D,h),o&1&&T!==(T=n[6].off_artifact_label.value+"")&&L(q,T),o&1&&(k=n[2].edge_is_unique(n[6].def_tech.value,n[6].def_tactic_label.value,n[6].off_tech_id.value)),k?A?A.p(n,o):(A=we(n),A.c(),A.m(c.parentNode,c)):A&&(A.d(1),A=null),o&1&&C!==(C=n[6].def_tech_label.value.replace(/ |\./g,"")+"")&&L(K,C),o&1&&y!==(y=n[6].off_artifact_label.value.replace(/ /g,"")+"")&&L(Y,y),o&1&&ee!==(ee=O(n[6].def_tech.value)+"")&&L(Z,ee),o&1&&le!==(le=O(n[6].def_tech.value)+"")&&L(W,le)},d(n){n&&(s(a),s(l),s(t),s(_),s(w),s(m),s(r),s($),s(D),s(S),s(q),s(g),s(c),s(K),s(F),s(Y),s(x),s(Z),s(z),s(W),s(M)),A&&A.d(n)}}}function we(i){let f=O(i[6].def_tech.value)+"",a,l,e=i[6].def_tech_label.value+"",t,_,b="-.->",w,m,E="May "+i[6].def_tactic_label.value,r,$,h=i[6].off_tech_id.value.replace(/ |\./g,"")+"",D,S,T=i[6].off_tech_label.value+"",q,g;return{c(){a=d(f),l=d('["'),t=d(e),_=d('"] '),w=d(b),m=d(`
            | `),r=d(E),$=d(" | "),D=d(h),S=d('["'),q=d(T),g=d('"] ;')},l(k){a=p(k,f),l=p(k,'["'),t=p(k,e),_=p(k,'"] '),w=p(k,b),m=p(k,`
            | `),r=p(k,E),$=p(k," | "),D=p(k,h),S=p(k,'["'),q=p(k,T),g=p(k,'"] ;')},m(k,c){u(k,a,c),u(k,l,c),u(k,t,c),u(k,_,c),u(k,w,c),u(k,m,c),u(k,r,c),u(k,$,c),u(k,D,c),u(k,S,c),u(k,q,c),u(k,g,c)},p(k,c){c&1&&f!==(f=O(k[6].def_tech.value)+"")&&L(a,f),c&1&&e!==(e=k[6].def_tech_label.value+"")&&L(t,e),c&1&&E!==(E="May "+k[6].def_tactic_label.value)&&L(r,E),c&1&&h!==(h=k[6].off_tech_id.value.replace(/ |\./g,"")+"")&&L(D,h),c&1&&T!==(T=k[6].off_tech_label.value+"")&&L(q,T)},d(k){k&&(s(a),s(l),s(t),s(_),s(w),s(m),s(r),s($),s(D),s(S),s(q),s(g))}}}function Ne(i){let f=i[6].off_tech_id.value.replace(/ |\./g,"")+"",a,l,e=i[6].off_tech_label.value+"",t,_,b="-->",w,m,E=i[6].off_artifact_rel_label.value.replace(/ /g,"")+"",r,$,h=O(i[6].off_artifact.value)+"",D,S,T=i[6].off_artifact_label.value+"",q,g,k=i[6].off_tech_id.value.replace(/ |\./g,"")+"",c,C,K=O(i[6].off_artifact.value)+"",F,y,Y=O(i[6].off_artifact.value)+"",x,ee,Z=O(i[6].off_artifact.value)+"",z,le,W=i[6].off_tech_id.value.replace(/ |\./g,"")+"",M,A,n=ce(i[6].off_tech_id.value)+"",o,j,J=O(i[6].off_artifact.value)+"",Q,ue,se=O(i[6].off_artifact.value)+"",re,pe;return{c(){a=d(f),l=d('["'),t=d(e),_=d('"] '),w=d(b),m=d(" |"),r=d(E),$=d("| "),D=d(h),S=d('["'),q=d(T),g=d('"]; class '),c=d(k),C=d(` OffensiveTechniqueNode;
        class `),F=d(K),y=d(" ArtifactNode; click "),x=d(Y),ee=d(' href "/dao/artifact/d3f:'),z=d(Z),le=d(`";
        click `),M=d(W),A=d(' href "'),o=d(n),j=d('"; click '),Q=d(J),ue=d(' href "/dao/artifact/d3f:'),re=d(se),pe=d('";')},l(v){a=p(v,f),l=p(v,'["'),t=p(v,e),_=p(v,'"] '),w=p(v,b),m=p(v," |"),r=p(v,E),$=p(v,"| "),D=p(v,h),S=p(v,'["'),q=p(v,T),g=p(v,'"]; class '),c=p(v,k),C=p(v,` OffensiveTechniqueNode;
        class `),F=p(v,K),y=p(v," ArtifactNode; click "),x=p(v,Y),ee=p(v,' href "/dao/artifact/d3f:'),z=p(v,Z),le=p(v,`";
        click `),M=p(v,W),A=p(v,' href "'),o=p(v,n),j=p(v,'"; click '),Q=p(v,J),ue=p(v,' href "/dao/artifact/d3f:'),re=p(v,se),pe=p(v,'";')},m(v,N){u(v,a,N),u(v,l,N),u(v,t,N),u(v,_,N),u(v,w,N),u(v,m,N),u(v,r,N),u(v,$,N),u(v,D,N),u(v,S,N),u(v,q,N),u(v,g,N),u(v,c,N),u(v,C,N),u(v,F,N),u(v,y,N),u(v,x,N),u(v,ee,N),u(v,z,N),u(v,le,N),u(v,M,N),u(v,A,N),u(v,o,N),u(v,j,N),u(v,Q,N),u(v,ue,N),u(v,re,N),u(v,pe,N)},p(v,N){N&1&&f!==(f=v[6].off_tech_id.value.replace(/ |\./g,"")+"")&&L(a,f),N&1&&e!==(e=v[6].off_tech_label.value+"")&&L(t,e),N&1&&E!==(E=v[6].off_artifact_rel_label.value.replace(/ /g,"")+"")&&L(r,E),N&1&&h!==(h=O(v[6].off_artifact.value)+"")&&L(D,h),N&1&&T!==(T=v[6].off_artifact_label.value+"")&&L(q,T),N&1&&k!==(k=v[6].off_tech_id.value.replace(/ |\./g,"")+"")&&L(c,k),N&1&&K!==(K=O(v[6].off_artifact.value)+"")&&L(F,K),N&1&&Y!==(Y=O(v[6].off_artifact.value)+"")&&L(x,Y),N&1&&Z!==(Z=O(v[6].off_artifact.value)+"")&&L(z,Z),N&1&&W!==(W=v[6].off_tech_id.value.replace(/ |\./g,"")+"")&&L(M,W),N&1&&n!==(n=ce(v[6].off_tech_id.value)+"")&&L(o,n),N&1&&J!==(J=O(v[6].off_artifact.value)+"")&&L(Q,J),N&1&&se!==(se=O(v[6].off_artifact.value)+"")&&L(re,se)},d(v){v&&(s(a),s(l),s(t),s(_),s(w),s(m),s(r),s($),s(D),s(S),s(q),s(g),s(c),s(C),s(F),s(y),s(x),s(ee),s(z),s(le),s(M),s(A),s(o),s(j),s(Q),s(ue),s(re),s(pe))}}}function Ce(i){let f,a=i[2].edge_is_unique(i[6].off_tech_label.value,i[6].off_artifact_rel_label.value,i[6].off_artifact_label.value),l,e="def_tech"in i[6]&&qe(i),t=a&&Ne(i);return{c(){e&&e.c(),f=P(),t&&t.c(),l=te()},l(_){e&&e.l(_),f=G(_),t&&t.l(_),l=te()},m(_,b){e&&e.m(_,b),u(_,f,b),t&&t.m(_,b),u(_,l,b)},p(_,b){"def_tech"in _[6]?e?e.p(_,b):(e=qe(_),e.c(),e.m(f.parentNode,f)):e&&(e.d(1),e=null),b&1&&(a=_[2].edge_is_unique(_[6].off_tech_label.value,_[6].off_artifact_rel_label.value,_[6].off_artifact_label.value)),a?t?t.p(_,b):(t=Ne(_),t.c(),t.m(l.parentNode,l)):t&&(t.d(1),t=null)},d(_){_&&(s(f),s(l)),e&&e.d(_),t&&t.d(_)}}}function fl(i){let f,a,l=be(i[0].results.bindings),e=[];for(let t=0;t<l.length;t+=1)e[t]=Ce(ge(i,l,t));return{c(){f=d(`graph LR;

    `);for(let t=0;t<e.length;t+=1)e[t].c();a=te()},l(t){f=p(t,`graph LR;

    `);for(let _=0;_<e.length;_+=1)e[_].l(t);a=te()},m(t,_){u(t,f,_);for(let b=0;b<e.length;b+=1)e[b]&&e[b].m(t,_);u(t,a,_)},p(t,_){if(_&7){l=be(t[0].results.bindings);let b;for(b=0;b<l.length;b+=1){const w=ge(t,l,b);e[b]?e[b].p(w,_):(e[b]=Ce(w),e[b].c(),e[b].m(a.parentNode,a))}for(;b<e.length;b+=1)e[b].d(1);e.length=l.length}},d(t){t&&(s(f),s(a)),je(e,t)}}}function De(i){let f,a;return f=new ye({props:{$$slots:{default:[fl]},$$scope:{ctx:i}}}),{c(){fe(f.$$.fragment)},l(l){ae(f.$$.fragment,l)},m(l,e){ie(f,l,e),a=!0},p(l,e){const t={};e&515&&(t.$$scope={dirty:e,ctx:l}),f.$set(t)},i(l){a||(V(f.$$.fragment,l),a=!0)},o(l){H(f.$$.fragment,l),a=!1},d(l){_e(f,l)}}}function al(i){let f,a,l,e,t,_,b,w,m,E,r,$,h,D;function S(c){i[4](c)}let T={toggles:i[3]};i[1]!==void 0&&(T.selected=i[1]),e=new xe({props:T}),Oe.push(()=>Ke(e,"selected",S));const q=[tl,ll],g=[];function k(c,C){return c[0].results.bindings.length>0?0:1}return r=k(i),$=g[r]=q[r](i),{c(){f=B("br"),a=P(),l=B("div"),fe(e.$$.fragment),_=P(),b=B("br"),w=P(),m=B("br"),E=P(),$.c(),h=te(),this.h()},l(c){f=R(c,"BR",{}),a=G(c),l=R(c,"DIV",{class:!0});var C=X(l);ae(e.$$.fragment,C),C.forEach(s),_=G(c),b=R(c,"BR",{}),w=G(c),m=R(c,"BR",{}),E=G(c),$.l(c),h=te(),this.h()},h(){U(l,"class","center shrink")},m(c,C){u(c,f,C),u(c,a,C),u(c,l,C),ie(e,l,null),u(c,_,C),u(c,b,C),u(c,w,C),u(c,m,C),u(c,E,C),g[r].m(c,C),u(c,h,C),D=!0},p(c,[C]){const K={};!t&&C&2&&(t=!0,K.selected=c[1],Pe(()=>t=!1)),e.$set(K);let F=r;r=k(c),r===F?g[r].p(c,C):(ve(),H(g[F],1,1,()=>{g[F]=null}),de(),$=g[r],$?$.p(c,C):($=g[r]=q[r](c),$.c()),V($,1),$.m(h.parentNode,h))},i(c){D||(V(e.$$.fragment,c),V($),D=!0)},o(c){H(e.$$.fragment,c),H($),D=!1},d(c){c&&(s(f),s(a),s(l),s(_),s(b),s(w),s(m),s(E),s(h)),_e(e),g[r].d(c)}}}function il(i,f,a){let{off_to_def:l}=f,e=new Je,t=new Set;l.results.bindings.forEach(m=>{"def_tactic_label"in m&&t.add(m.def_tactic_label.value)});let _=Array.from(t).sort(function(m,E){return ke[m]-ke[E]}),b=["Model"];We(_,b)&&(b=[]);function w(m){b=m,a(1,b)}return i.$$set=m=>{"off_to_def"in m&&a(0,l=m.off_to_def)},i.$$.update=()=>{i.$$.dirty&2&&e.reset(b)},[l,b,e,_,w]}class _l extends Le{constructor(f){super(),Me(this,f,il,al,me,{off_to_def:0})}}function Ae(i,f,a){const l=i.slice();return l[8]=f[a],l}const sl=i=>({}),Ie=i=>({});function Be(i){let f,a,l;return a=new he({props:{href:ce(i[1]),size:"small",$$slots:{default:[ul]},$$scope:{ctx:i}}}),{c(){f=B("span"),fe(a.$$.fragment),this.h()},l(e){f=R(e,"SPAN",{class:!0});var t=X(f);ae(a.$$.fragment,t),t.forEach(s),this.h()},h(){U(f,"class","left")},m(e,t){u(e,f,t),ie(a,f,null),l=!0},p(e,t){const _={};t&2&&(_.href=ce(e[1])),t&66&&(_.$$scope={dirty:t,ctx:e}),a.$set(_)},i(e){l||(V(a.$$.fragment,e),l=!0)},o(e){H(a.$$.fragment,e),l=!1},d(e){e&&s(f),_e(a)}}}function ul(i){let f,a;return{c(){f=d("Parent: "),a=d(i[1])},l(l){f=p(l,"Parent: "),a=p(l,i[1])},m(l,e){u(l,f,e),u(l,a,e)},p(l,e){e&2&&L(a,l[1])},d(l){l&&(s(f),s(a))}}}function nl(i){let f;return{c(){f=d("MITRE ATT&CK® Link")},l(a){f=p(a,"MITRE ATT&CK® Link")},m(a,l){u(a,f,l)},d(a){a&&s(f)}}}function rl(i){let f,a,l,e,t,_,b=i[3]["rdfs:label"]+"",w,m,E=i[3]["d3f:attack-id"]+"",r,$,h,D="(ATT&CK® Technique)",S,T=i[1]&&Be(i);return e=new he({props:{href:Qe(i[3]["d3f:attack-id"]),size:"small",$$slots:{default:[nl]},$$scope:{ctx:i}}}),{c(){f=B("div"),T&&T.c(),a=P(),l=B("span"),fe(e.$$.fragment),t=P(),_=B("h1"),w=d(b),m=d(" - "),r=d(E),$=P(),h=B("div"),h.textContent=D,this.h()},l(q){f=R(q,"DIV",{class:!0});var g=X(f);T&&T.l(g),a=G(g),l=R(g,"SPAN",{class:!0});var k=X(l);ae(e.$$.fragment,k),k.forEach(s),g.forEach(s),t=G(q),_=R(q,"H1",{class:!0});var c=X(_);w=p(c,b),m=p(c," - "),r=p(c,E),c.forEach(s),$=G(q),h=R(q,"DIV",{class:!0,"data-svelte-h":!0}),oe(h)!=="svelte-1scusry"&&(h.textContent=D),this.h()},h(){U(l,"class","right"),U(f,"class","flex"),U(_,"class","text-center svelte-14efray"),U(h,"class","center text-center")},m(q,g){u(q,f,g),T&&T.m(f,null),I(f,a),I(f,l),ie(e,l,null),u(q,t,g),u(q,_,g),I(_,w),I(_,m),I(_,r),u(q,$,g),u(q,h,g),S=!0},p(q,g){q[1]?T?(T.p(q,g),g&2&&V(T,1)):(T=Be(q),T.c(),V(T,1),T.m(f,a)):T&&(ve(),H(T,1,1,()=>{T=null}),de());const k={};g&64&&(k.$$scope={dirty:g,ctx:q}),e.$set(k)},i(q){S||(V(T),V(e.$$.fragment,q),S=!0)},o(q){H(T),H(e.$$.fragment,q),S=!1},d(q){q&&(s(f),s(t),s(_),s($),s(h)),T&&T.d(),_e(e)}}}function cl(i){let f,a,l="Subtechniques",e,t,_,b,w=be(i[2].i(i[3]["@id"])["rdfs:hasSubClass"]),m=[];for(let r=0;r<w.length;r+=1)m[r]=Re(Ae(i,w,r));const E=r=>H(m[r],1,1,()=>{m[r]=null});return{c(){f=B("div"),a=B("h2"),a.textContent=l,e=P(),t=B("div"),_=B("ul");for(let r=0;r<m.length;r+=1)m[r].c();this.h()},l(r){f=R(r,"DIV",{class:!0});var $=X(f);a=R($,"H2",{class:!0,"data-svelte-h":!0}),oe(a)!=="svelte-flst9x"&&(a.textContent=l),e=G($),t=R($,"DIV",{class:!0});var h=X(t);_=R(h,"UL",{class:!0});var D=X(_);for(let S=0;S<m.length;S+=1)m[S].l(D);D.forEach(s),h.forEach(s),$.forEach(s),this.h()},h(){U(a,"class","text-center"),U(_,"class","center stretch shrink no-style"),U(t,"class","center"),U(f,"class","card")},m(r,$){u(r,f,$),I(f,a),I(f,e),I(f,t),I(t,_);for(let h=0;h<m.length;h+=1)m[h]&&m[h].m(_,null);b=!0},p(r,$){if($&12){w=be(r[2].i(r[3]["@id"])["rdfs:hasSubClass"]);let h;for(h=0;h<w.length;h+=1){const D=Ae(r,w,h);m[h]?(m[h].p(D,$),V(m[h],1)):(m[h]=Re(D),m[h].c(),V(m[h],1),m[h].m(_,null))}for(ve(),h=w.length;h<m.length;h+=1)E(h);de()}},i(r){if(!b){for(let $=0;$<w.length;$+=1)V(m[$]);b=!0}},o(r){m=m.filter(Boolean);for(let $=0;$<m.length;$+=1)H(m[$]);b=!1},d(r){r&&s(f),je(m,r)}}}function ol(i){let f=i[2].i(i[8]["@id"])["d3f:attack-id"]+"",a,l,e=i[2].i(i[8]["@id"])["rdfs:label"]+"",t;return{c(){a=d(f),l=d(" - "),t=d(e)},l(_){a=p(_,f),l=p(_," - "),t=p(_,e)},m(_,b){u(_,a,b),u(_,l,b),u(_,t,b)},p:ne,d(_){_&&(s(a),s(l),s(t))}}}function Re(i){let f,a,l,e;return a=new he({props:{href:ce(i[2].i(i[8]["@id"])["d3f:attack-id"]),size:"small",$$slots:{default:[ol]},$$scope:{ctx:i}}}),{c(){f=B("li"),fe(a.$$.fragment),l=P()},l(t){f=R(t,"LI",{});var _=X(f);ae(a.$$.fragment,_),l=G(_),_.forEach(s)},m(t,_){u(t,f,_),ie(a,f,null),I(f,l),e=!0},p(t,_){const b={};_&64&&(b.$$scope={dirty:_,ctx:t}),a.$set(b)},i(t){e||(V(a.$$.fragment,t),e=!0)},o(t){H(a.$$.fragment,t),e=!1},d(t){t&&s(f),_e(a)}}}function Se(i){let f,a,l;return a=new Ye({props:{$$slots:{default:[vl]},$$scope:{ctx:i}}}),{c(){f=B("div"),fe(a.$$.fragment),this.h()},l(e){f=R(e,"DIV",{class:!0});var t=X(f);ae(a.$$.fragment,t),t.forEach(s),this.h()},h(){U(f,"class","content")},m(e,t){u(e,f,t),ie(a,f,null),l=!0},i(e){l||(V(a.$$.fragment,e),l=!0)},o(e){H(a.$$.fragment,e),l=!1},d(e){e&&s(f),_e(a)}}}function vl(i){let f,a="Browse the D3FEND knowledge graph by clicking on the nodes below.";return{c(){f=B("small"),f.textContent=a},l(l){f=R(l,"SMALL",{"data-svelte-h":!0}),oe(f)!=="svelte-cj5juo"&&(f.textContent=a)},m(l,e){u(l,f,e)},p:ne,d(l){l&&s(f)}}}function dl(i){let f,a,l,e,t,_,b,w,m,E,r,$,h="D3FEND Inferred Relationships",D,S,T,q,g,k,c,C,K,F,y,Y,x,ee,Z,z;const le=i[5].header,W=Ge(le,i,i[6],Ie),M=W||rl(i);let A=i[2].graph.length>0&&cl(i),n=i[0].off_to_def.results.bindings.length>0&&Se(i);return g=new _l({props:{off_to_def:i[0].off_to_def}}),{c(){M&&M.c(),f=P(),a=B("section"),l=B("div"),e=P(),A&&A.c(),t=P(),_=B("br"),b=P(),w=B("br"),m=P(),E=B("section"),r=B("div"),$=B("h2"),$.textContent=h,D=P(),n&&n.c(),S=P(),T=B("br"),q=P(),fe(g.$$.fragment),k=P(),c=B("div"),C=B("a"),K=d("json"),y=P(),Y=B("br"),x=B("br"),ee=B("br"),Z=B("br"),this.h()},l(o){M&&M.l(o),f=G(o),a=R(o,"SECTION",{class:!0});var j=X(a);l=R(j,"DIV",{class:!0}),X(l).forEach(s),e=G(j),A&&A.l(j),t=G(j),_=R(j,"BR",{}),b=G(j),w=R(j,"BR",{}),j.forEach(s),m=G(o),E=R(o,"SECTION",{});var J=X(E);r=R(J,"DIV",{class:!0});var Q=X(r);$=R(Q,"H2",{class:!0,"data-svelte-h":!0}),oe($)!=="svelte-u3n8h4"&&($.textContent=h),D=G(Q),n&&n.l(Q),S=G(Q),T=R(Q,"BR",{}),q=G(Q),ae(g.$$.fragment,Q),k=G(Q),c=R(Q,"DIV",{class:!0});var ue=X(c);C=R(ue,"A",{href:!0});var se=X(C);K=p(se,"json"),se.forEach(s),ue.forEach(s),Q.forEach(s),y=G(J),Y=R(J,"BR",{}),x=R(J,"BR",{}),ee=R(J,"BR",{}),Z=R(J,"BR",{}),J.forEach(s),this.h()},h(){U(l,"class","text-center"),U(a,"class","content"),U($,"class","text-center"),U(C,"href",F=`/api/offensive-technique/attack/${i[0].technique_id}.json`),U(c,"class","text-right"),U(r,"class","text-center card")},m(o,j){M&&M.m(o,j),u(o,f,j),u(o,a,j),I(a,l),I(a,e),A&&A.m(a,null),I(a,t),I(a,_),I(a,b),I(a,w),u(o,m,j),u(o,E,j),I(E,r),I(r,$),I(r,D),n&&n.m(r,null),I(r,S),I(r,T),I(r,q),ie(g,r,null),I(r,k),I(r,c),I(c,C),I(C,K),I(E,y),I(E,Y),I(E,x),I(E,ee),I(E,Z),z=!0},p(o,j){W?W.p&&(!z||j&64)&&He(W,le,o,o[6],z?Fe(le,o[6],j,sl):ze(o[6]),Ie):M&&M.p&&(!z||j&2)&&M.p(o,z?j:-1),o[2].graph.length>0&&A.p(o,j),o[0].off_to_def.results.bindings.length>0?n?j&1&&V(n,1):(n=Se(o),n.c(),V(n,1),n.m(r,S)):n&&(ve(),H(n,1,1,()=>{n=null}),de());const J={};j&1&&(J.off_to_def=o[0].off_to_def),g.$set(J),(!z||j&1&&F!==(F=`/api/offensive-technique/attack/${o[0].technique_id}.json`))&&U(C,"href",F)},i(o){z||(V(M,o),V(A),V(n),V(g.$$.fragment,o),z=!0)},o(o){H(M,o),H(A),H(n),H(g.$$.fragment,o),z=!1},d(o){o&&(s(f),s(a),s(m),s(E)),M&&M.d(o),A&&A.d(),n&&n.d(),_e(g)}}}function pl(i){let f,a,l,e;return f=new Xe({props:{title:"Offensive Technique Details"}}),l=new Ze({props:{$$slots:{default:[dl]},$$scope:{ctx:i}}}),l.$on("close",i[4]),{c(){fe(f.$$.fragment),a=P(),fe(l.$$.fragment)},l(t){ae(f.$$.fragment,t),a=G(t),ae(l.$$.fragment,t)},m(t,_){ie(f,t,_),u(t,a,_),ie(l,t,_),e=!0},p(t,[_]){const b={};_&67&&(b.$$scope={dirty:_,ctx:t}),l.$set(b)},i(t){e||(V(f.$$.fragment,t),V(l.$$.fragment,t),e=!0)},o(t){H(f.$$.fragment,t),H(l.$$.fragment,t),e=!1},d(t){t&&s(a),_e(f,t),_e(l,t)}}}function bl(i,f,a){let{$$slots:l={},$$scope:e}=f,{data:t}=f,_=new $e(t.description),b=new $e(t.subtechniques,{index:!0}),w=_.get("d3f:attack-id",t.technique_id),m;function E(r){Ue("/")}return i.$$set=r=>{"data"in r&&a(0,t=r.data),"$$scope"in r&&a(6,e=r.$$scope)},i.$$.update=()=>{i.$$.dirty&1&&t.technique_id.includes(".")&&a(1,m=t.technique_id.split(".")[0])},[t,m,b,w,E,l,e]}class Il extends Le{constructor(f){super(),Me(this,f,bl,pl,me,{data:0})}}export{Il as component,Al as universal};
