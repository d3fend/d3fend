import{e as st}from"../chunks/index.5e2a9a64.js";import{s as at,a as N,f as _,c as S,g as m,F as H,h as y,d as r,j as A,i as g,x as p,C as W,G as lt,y as J,l as R,m as B,k as F,e as X}from"../chunks/scheduler.50831561.js";import{S as it,i as rt,b as ot,d as ct,m as dt,a as ft,t as ut,e as ht}from"../chunks/index.24431cc3.js";import{e as U}from"../chunks/each.8d18d1a2.js";import{T as _t}from"../chunks/Title.28d88b77.js";import{G as mt,h as nt}from"../chunks/lib.9e57a3f1.js";async function pt({fetch:i}){const t=await i("/api/mappings/attack-mitigations.json"),s=await t.json();if(t.status!==200)throw st(500,s.message||"Internal Server Error");return{mitigations:s}}const It=Object.freeze(Object.defineProperty({__proto__:null,load:pt},Symbol.toStringTag,{value:"Module"}));function Y(i,t,s){const l=i.slice();return l[6]=t[s],l}function Z(i,t,s){const l=i.slice();return l[9]=t[s],l}function vt(i){let t,s="select",l,a;return{c(){t=_("button"),t.textContent=s,this.h()},l(n){t=m(n,"BUTTON",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-1h9ul0y"&&(t.textContent=s),this.h()},h(){A(t,"class","selector")},m(n,e){g(n,t,e),l||(a=W(t,"click",i[5]),l=!0)},p:J,d(n){n&&r(t),l=!1,a()}}}function gt(i){let t,s="deselect",l,a;return{c(){t=_("button"),t.textContent=s,this.h()},l(n){t=m(n,"BUTTON",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-iey0zo"&&(t.textContent=s),this.h()},h(){A(t,"class","selector")},m(n,e){g(n,t,e),l||(a=W(t,"click",i[2]),l=!0)},p:J,d(n){n&&r(t),l=!1,a()}}}function Tt(i){let t,s,l=i[6]["@id"]+"",a,n,e,c="not found",T,f,h="<div>not found</div>";return{c(){t=_("td"),s=_("a"),a=R(l),n=N(),e=_("td"),e.textContent=c,T=N(),f=_("td"),f.innerHTML=h,this.h()},l(u){t=m(u,"TD",{});var d=y(t);s=m(d,"A",{style:!0,href:!0});var w=y(s);a=B(w,l),w.forEach(r),d.forEach(r),n=S(u),e=m(u,"TD",{style:!0,"data-svelte-h":!0}),H(e)!=="svelte-zllfjb"&&(e.textContent=c),T=S(u),f=m(u,"TD",{style:!0,"data-svelte-h":!0}),H(f)!=="svelte-uu95jw"&&(f.innerHTML=h),this.h()},h(){F(s,"color","red"),A(s,"href",nt(i[6]["@id"])),F(e,"color","red"),F(f,"color","red")},m(u,d){g(u,t,d),p(t,s),p(s,a),g(u,n,d),g(u,e,d),g(u,T,d),g(u,f,d)},p:J,d(u){u&&(r(t),r(n),r(e),r(T),r(f))}}}function bt(i){let t,s=i[6]["@id"].split(":")[1]+"",l,a,n,e,c=i[6]["rdfs:label"]+"",T,f,h,u,d,w,j=(i[6]["d3f:d3fend-comment"]||"")+"",k,C=i[6]["d3f:related"]&&yt(i);return{c(){t=_("td"),l=R(s),a=N(),n=_("td"),e=_("a"),T=R(c),f=N(),h=_("td"),C&&C.c(),u=N(),d=_("td"),w=_("small"),k=R(j),this.h()},l(v){t=m(v,"TD",{class:!0});var D=y(t);l=B(D,s),D.forEach(r),a=S(v),n=m(v,"TD",{class:!0});var L=y(n);e=m(L,"A",{href:!0});var O=y(e);T=B(O,c),O.forEach(r),L.forEach(r),f=S(v),h=m(v,"TD",{});var V=y(h);C&&C.l(V),V.forEach(r),u=S(v),d=m(v,"TD",{style:!0});var q=y(d);w=m(q,"SMALL",{});var x=y(w);k=B(x,j),x.forEach(r),q.forEach(r),this.h()},h(){A(t,"class","text-center"),A(e,"href",nt(i[6]["@id"].split(":")[1])),A(n,"class",""),F(d,"width","15rem")},m(v,D){g(v,t,D),p(t,l),g(v,a,D),g(v,n,D),p(n,e),p(e,T),g(v,f,D),g(v,h,D),C&&C.m(h,null),g(v,u,D),g(v,d,D),p(d,w),p(w,k)},p(v,D){v[6]["d3f:related"]&&C.p(v,D)},d(v){v&&(r(t),r(a),r(n),r(f),r(h),r(u),r(d)),C&&C.d()}}}function yt(i){let t,s=U(i[6]["d3f:related"]),l=[];for(let a=0;a<s.length;a+=1)l[a]=tt(Z(i,s,a));return{c(){for(let a=0;a<l.length;a+=1)l[a].c();t=X()},l(a){for(let n=0;n<l.length;n+=1)l[n].l(a);t=X()},m(a,n){for(let e=0;e<l.length;e+=1)l[e]&&l[e].m(a,n);g(a,t,n)},p(a,n){if(n&2){s=U(a[6]["d3f:related"]);let e;for(e=0;e<s.length;e+=1){const c=Z(a,s,e);l[e]?l[e].p(c,n):(l[e]=tt(c),l[e].c(),l[e].m(t.parentNode,t))}for(;e<l.length;e+=1)l[e].d(1);l.length=s.length}},d(a){a&&r(t),lt(l,a)}}}function tt(i){let t,s,l=i[1].get_and_cache("@id",i[9]["@id"])["d3f:d3fend-id"]+"",a,n,e,c,T=i[1].current_node["rdfs:label"]+"",f,h;return{c(){t=_("div"),s=_("span"),a=R(l),n=N(),e=_("span"),c=_("a"),f=R(T),h=N(),this.h()},l(u){t=m(u,"DIV",{class:!0});var d=y(t);s=m(d,"SPAN",{style:!0});var w=y(s);a=B(w,l),w.forEach(r),n=S(d),e=m(d,"SPAN",{});var j=y(e);c=m(j,"A",{href:!0,title:!0});var k=y(c);f=B(k,T),k.forEach(r),j.forEach(r),h=S(d),d.forEach(r),this.h()},h(){F(s,"width","5rem"),F(s,"display","inline-block"),A(c,"href","/technique/"+i[9]["@id"]),A(c,"title",i[1].get("@id",i[9]["@id"])["d3f:definition"]),A(t,"class","center")},m(u,d){g(u,t,d),p(t,s),p(s,a),p(t,n),p(t,e),p(e,c),p(c,f),p(t,h)},p:J,d(u){u&&r(t)}}}function et(i){let t,s;function l(e,c){return e[6]?bt:Tt}let n=l(i)(i);return{c(){t=_("tr"),n.c(),s=N()},l(e){t=m(e,"TR",{});var c=y(t);n.l(c),s=S(c),c.forEach(r)},m(e,c){g(e,t,c),n.m(t,null),p(t,s)},p(e,c){n.p(e,c)},d(e){e&&r(t),n.d()}}}function kt(i){let t,s,l,a=`<h1>ATT&amp;CK Mitigations to D3FEND Technique Mappings</h1> <p>The D3FEND team created this mapping in order to help users navigate between
    the two knowledgebases.</p>`,n,e,c,T,f,h,u,d,w="copy",j,k,C,v="<th>ATT&amp;CK ID</th> <th>ATT&amp;CK Mitigation</th> <th>Related D3FEND Techniques</th> <th>Comment</th>",D,L,O,V;t=new _t({props:{title:"ATT&CK Mitigations to D3FEND Mappings"}});function q(o,M){return o[0]?gt:vt}let x=q(i),I=x(i),K=U(i[1].get_by_type("d3f:ATTACKMitigation")),E=[];for(let o=0;o<K.length;o+=1)E[o]=et(Y(i,K,o));return{c(){ot(t.$$.fragment),s=N(),l=_("section"),l.innerHTML=a,n=N(),e=_("section"),c=_("div"),T=_("div"),f=_("div"),h=_("div"),I.c(),u=N(),d=_("button"),d.textContent=w,j=N(),k=_("table"),C=_("thead"),C.innerHTML=v,D=N();for(let o=0;o<E.length;o+=1)E[o].c();this.h()},l(o){ct(t.$$.fragment,o),s=S(o),l=m(o,"SECTION",{class:!0,"data-svelte-h":!0}),H(l)!=="svelte-vpl4c8"&&(l.innerHTML=a),n=S(o),e=m(o,"SECTION",{});var M=y(e);c=m(M,"DIV",{class:!0});var b=y(c);T=m(b,"DIV",{class:!0});var P=y(T);f=m(P,"DIV",{class:!0});var $=y(f);h=m($,"DIV",{class:!0});var z=y(h);I.l(z),u=S(z),d=m(z,"BUTTON",{"data-svelte-h":!0}),H(d)!=="svelte-1gemhfw"&&(d.textContent=w),z.forEach(r),j=S($),k=m($,"TABLE",{id:!0,class:!0});var G=y(k);C=m(G,"THEAD",{"data-svelte-h":!0}),H(C)!=="svelte-jlfrhj"&&(C.innerHTML=v),D=S(G);for(let Q=0;Q<E.length;Q+=1)E[Q].l(G);G.forEach(r),$.forEach(r),P.forEach(r),b.forEach(r),M.forEach(r),this.h()},h(){A(l,"class","content"),A(h,"class","text-right"),A(k,"id","mappings"),A(k,"class","table-auto"),A(f,"class","results-wrap"),A(T,"class","card stretch shrink center"),A(c,"class","")},m(o,M){dt(t,o,M),g(o,s,M),g(o,l,M),g(o,n,M),g(o,e,M),p(e,c),p(c,T),p(T,f),p(f,h),I.m(h,null),p(h,u),p(h,d),p(f,j),p(f,k),p(k,C),p(k,D);for(let b=0;b<E.length;b+=1)E[b]&&E[b].m(k,null);L=!0,O||(V=W(d,"click",Et),O=!0)},p(o,[M]){if(x===(x=q(o))&&I?I.p(o,M):(I.d(1),I=x(o),I&&(I.c(),I.m(h,u))),M&2){K=U(o[1].get_by_type("d3f:ATTACKMitigation"));let b;for(b=0;b<K.length;b+=1){const P=Y(o,K,b);E[b]?E[b].p(P,M):(E[b]=et(P),E[b].c(),E[b].m(k,null))}for(;b<E.length;b+=1)E[b].d(1);E.length=K.length}},i(o){L||(ft(t.$$.fragment,o),L=!0)},o(o){ut(t.$$.fragment,o),L=!1},d(o){o&&(r(s),r(l),r(n),r(e)),ht(t,o),I.d(),lt(E,o),O=!1,V()}}}function Et(){document.execCommand("copy")}function Ct(i,t,s){let{data:l}=t,a=new mt(l.mitigations),n=!1;function e(){window.getSelection().removeAllRanges(),s(0,n=!1)}function c(f){const h=window.getSelection();h.removeAllRanges();const u=document.getElementById(f),d=document.createRange();d.selectNodeContents(u),h.addRange(d),s(0,n=!0)}const T=()=>c("mappings");return i.$$set=f=>{"data"in f&&s(4,l=f.data)},[n,a,e,c,l,T]}class jt extends it{constructor(t){super(),rt(this,t,Ct,kt,at,{data:4})}}export{jt as component,It as universal};
