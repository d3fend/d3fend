import{e as st}from"../chunks/index.aHWtvSLc.js";import{s as at,b as N,e as h,j as S,d as m,v as O,f as y,i as r,w as A,k as g,l as p,p as W,I as lt,n as J,t as R,h as B,C as V,A as X}from"../chunks/scheduler.rYb7pZZG.js";import{S as it,i as rt,c as ot,b as ct,m as dt,t as ft,a as ut,d as _t}from"../chunks/index.DuGWJhq4.js";import{e as G}from"../chunks/each.shjUScpc.js";import{T as ht}from"../chunks/Title.-2iHfz2o.js";import{G as mt,d as nt}from"../chunks/lib.FzuLk5Dt.js";async function pt({fetch:i}){const t=await i("/api/mappings/attack-mitigations.json"),s=await t.json();return t.status!==200&&st(500,s.message||"Internal Server Error"),{mitigations:s}}const It=Object.freeze(Object.defineProperty({__proto__:null,load:pt},Symbol.toStringTag,{value:"Module"}));function Y(i,t,s){const l=i.slice();return l[6]=t[s],l}function Z(i,t,s){const l=i.slice();return l[9]=t[s],l}function vt(i){let t,s="select",l,a;return{c(){t=h("button"),t.textContent=s,this.h()},l(n){t=m(n,"BUTTON",{class:!0,"data-svelte-h":!0}),O(t)!=="svelte-1h9ul0y"&&(t.textContent=s),this.h()},h(){A(t,"class","selector")},m(n,e){g(n,t,e),l||(a=W(t,"click",i[5]),l=!0)},p:J,d(n){n&&r(t),l=!1,a()}}}function gt(i){let t,s="deselect",l,a;return{c(){t=h("button"),t.textContent=s,this.h()},l(n){t=m(n,"BUTTON",{class:!0,"data-svelte-h":!0}),O(t)!=="svelte-iey0zo"&&(t.textContent=s),this.h()},h(){A(t,"class","selector")},m(n,e){g(n,t,e),l||(a=W(t,"click",i[2]),l=!0)},p:J,d(n){n&&r(t),l=!1,a()}}}function Tt(i){let t,s,l=i[6]["@id"]+"",a,n,e,c="not found",T,f,_="<div>not found</div>";return{c(){t=h("td"),s=h("a"),a=R(l),n=N(),e=h("td"),e.textContent=c,T=N(),f=h("td"),f.innerHTML=_,this.h()},l(u){t=m(u,"TD",{});var d=y(t);s=m(d,"A",{style:!0,href:!0});var w=y(s);a=B(w,l),w.forEach(r),d.forEach(r),n=S(u),e=m(u,"TD",{style:!0,"data-svelte-h":!0}),O(e)!=="svelte-zllfjb"&&(e.textContent=c),T=S(u),f=m(u,"TD",{style:!0,"data-svelte-h":!0}),O(f)!=="svelte-uu95jw"&&(f.innerHTML=_),this.h()},h(){V(s,"color","red"),A(s,"href",nt(i[6]["@id"])),V(e,"color","red"),V(f,"color","red")},m(u,d){g(u,t,d),p(t,s),p(s,a),g(u,n,d),g(u,e,d),g(u,T,d),g(u,f,d)},p:J,d(u){u&&(r(t),r(n),r(e),r(T),r(f))}}}function bt(i){let t,s=i[6]["@id"].split(":")[1]+"",l,a,n,e,c=i[6]["rdfs:label"]+"",T,f,_,u,d,w,j=(i[6]["d3f:d3fend-comment"]||"")+"",k,C=i[6]["d3f:related"]&&yt(i);return{c(){t=h("td"),l=R(s),a=N(),n=h("td"),e=h("a"),T=R(c),f=N(),_=h("td"),C&&C.c(),u=N(),d=h("td"),w=h("small"),k=R(j),this.h()},l(v){t=m(v,"TD",{class:!0});var D=y(t);l=B(D,s),D.forEach(r),a=S(v),n=m(v,"TD",{class:!0});var L=y(n);e=m(L,"A",{href:!0});var x=y(e);T=B(x,c),x.forEach(r),L.forEach(r),f=S(v),_=m(v,"TD",{});var q=y(_);C&&C.l(q),q.forEach(r),u=S(v),d=m(v,"TD",{style:!0});var F=y(d);w=m(F,"SMALL",{});var H=y(w);k=B(H,j),H.forEach(r),F.forEach(r),this.h()},h(){A(t,"class","text-center"),A(e,"href",nt(i[6]["@id"].split(":")[1])),A(n,"class",""),V(d,"width","15rem")},m(v,D){g(v,t,D),p(t,l),g(v,a,D),g(v,n,D),p(n,e),p(e,T),g(v,f,D),g(v,_,D),C&&C.m(_,null),g(v,u,D),g(v,d,D),p(d,w),p(w,k)},p(v,D){v[6]["d3f:related"]&&C.p(v,D)},d(v){v&&(r(t),r(a),r(n),r(f),r(_),r(u),r(d)),C&&C.d()}}}function yt(i){let t,s=G(i[6]["d3f:related"]),l=[];for(let a=0;a<s.length;a+=1)l[a]=tt(Z(i,s,a));return{c(){for(let a=0;a<l.length;a+=1)l[a].c();t=X()},l(a){for(let n=0;n<l.length;n+=1)l[n].l(a);t=X()},m(a,n){for(let e=0;e<l.length;e+=1)l[e]&&l[e].m(a,n);g(a,t,n)},p(a,n){if(n&2){s=G(a[6]["d3f:related"]);let e;for(e=0;e<s.length;e+=1){const c=Z(a,s,e);l[e]?l[e].p(c,n):(l[e]=tt(c),l[e].c(),l[e].m(t.parentNode,t))}for(;e<l.length;e+=1)l[e].d(1);l.length=s.length}},d(a){a&&r(t),lt(l,a)}}}function tt(i){let t,s,l=i[1].get_and_cache("@id",i[9]["@id"])["d3f:d3fend-id"]+"",a,n,e,c,T=i[1].current_node["rdfs:label"]+"",f,_;return{c(){t=h("div"),s=h("span"),a=R(l),n=N(),e=h("span"),c=h("a"),f=R(T),_=N(),this.h()},l(u){t=m(u,"DIV",{class:!0});var d=y(t);s=m(d,"SPAN",{style:!0});var w=y(s);a=B(w,l),w.forEach(r),n=S(d),e=m(d,"SPAN",{});var j=y(e);c=m(j,"A",{href:!0,title:!0});var k=y(c);f=B(k,T),k.forEach(r),j.forEach(r),_=S(d),d.forEach(r),this.h()},h(){V(s,"width","5rem"),V(s,"display","inline-block"),A(c,"href","/technique/"+i[9]["@id"]),A(c,"title",i[1].get("@id",i[9]["@id"])["d3f:definition"]),A(t,"class","center")},m(u,d){g(u,t,d),p(t,s),p(s,a),p(t,n),p(t,e),p(e,c),p(c,f),p(t,_)},p:J,d(u){u&&r(t)}}}function et(i){let t,s;function l(e,c){return e[6]?bt:Tt}let n=l(i)(i);return{c(){t=h("tr"),n.c(),s=N()},l(e){t=m(e,"TR",{});var c=y(t);n.l(c),s=S(c),c.forEach(r)},m(e,c){g(e,t,c),n.m(t,null),p(t,s)},p(e,c){n.p(e,c)},d(e){e&&r(t),n.d()}}}function kt(i){let t,s,l,a=`<h1>ATT&amp;CK Mitigations to D3FEND Technique Mappings</h1> <p>The D3FEND team created this mapping in order to help users navigate between
    the two knowledgebases.</p>`,n,e,c,T,f,_,u,d,w="copy",j,k,C,v="<th>ATT&amp;CK ID</th> <th>ATT&amp;CK Mitigation</th> <th>Related D3FEND Techniques</th> <th>Comment</th>",D,L,x,q;t=new ht({props:{title:"ATT&CK Mitigations to D3FEND Mappings"}});function F(o,M){return o[0]?gt:vt}let H=F(i),I=H(i),K=G(i[1].get_by_type("d3f:ATTACKMitigation")),E=[];for(let o=0;o<K.length;o+=1)E[o]=et(Y(i,K,o));return{c(){ot(t.$$.fragment),s=N(),l=h("section"),l.innerHTML=a,n=N(),e=h("section"),c=h("div"),T=h("div"),f=h("div"),_=h("div"),I.c(),u=N(),d=h("button"),d.textContent=w,j=N(),k=h("table"),C=h("thead"),C.innerHTML=v,D=N();for(let o=0;o<E.length;o+=1)E[o].c();this.h()},l(o){ct(t.$$.fragment,o),s=S(o),l=m(o,"SECTION",{class:!0,"data-svelte-h":!0}),O(l)!=="svelte-vpl4c8"&&(l.innerHTML=a),n=S(o),e=m(o,"SECTION",{});var M=y(e);c=m(M,"DIV",{class:!0});var b=y(c);T=m(b,"DIV",{class:!0});var P=y(T);f=m(P,"DIV",{class:!0});var $=y(f);_=m($,"DIV",{class:!0});var z=y(_);I.l(z),u=S(z),d=m(z,"BUTTON",{"data-svelte-h":!0}),O(d)!=="svelte-1gemhfw"&&(d.textContent=w),z.forEach(r),j=S($),k=m($,"TABLE",{id:!0,class:!0});var U=y(k);C=m(U,"THEAD",{"data-svelte-h":!0}),O(C)!=="svelte-jlfrhj"&&(C.innerHTML=v),D=S(U);for(let Q=0;Q<E.length;Q+=1)E[Q].l(U);U.forEach(r),$.forEach(r),P.forEach(r),b.forEach(r),M.forEach(r),this.h()},h(){A(l,"class","content"),A(_,"class","text-right"),A(k,"id","mappings"),A(k,"class","table-auto"),A(f,"class","results-wrap"),A(T,"class","card stretch shrink center"),A(c,"class","")},m(o,M){dt(t,o,M),g(o,s,M),g(o,l,M),g(o,n,M),g(o,e,M),p(e,c),p(c,T),p(T,f),p(f,_),I.m(_,null),p(_,u),p(_,d),p(f,j),p(f,k),p(k,C),p(k,D);for(let b=0;b<E.length;b+=1)E[b]&&E[b].m(k,null);L=!0,x||(q=W(d,"click",Et),x=!0)},p(o,[M]){if(H===(H=F(o))&&I?I.p(o,M):(I.d(1),I=H(o),I&&(I.c(),I.m(_,u))),M&2){K=G(o[1].get_by_type("d3f:ATTACKMitigation"));let b;for(b=0;b<K.length;b+=1){const P=Y(o,K,b);E[b]?E[b].p(P,M):(E[b]=et(P),E[b].c(),E[b].m(k,null))}for(;b<E.length;b+=1)E[b].d(1);E.length=K.length}},i(o){L||(ft(t.$$.fragment,o),L=!0)},o(o){ut(t.$$.fragment,o),L=!1},d(o){o&&(r(s),r(l),r(n),r(e)),_t(t,o),I.d(),lt(E,o),x=!1,q()}}}function Et(){document.execCommand("copy")}function Ct(i,t,s){let{data:l}=t,a=new mt(l.mitigations),n=!1;function e(){window.getSelection().removeAllRanges(),s(0,n=!1)}function c(f){const _=window.getSelection();_.removeAllRanges();const u=document.getElementById(f),d=document.createRange();d.selectNodeContents(u),_.addRange(d),s(0,n=!0)}const T=()=>c("mappings");return i.$$set=f=>{"data"in f&&s(4,l=f.data)},[n,a,e,c,l,T]}class jt extends it{constructor(t){super(),rt(this,t,Ct,kt,at,{data:4})}}export{jt as component,It as universal};
