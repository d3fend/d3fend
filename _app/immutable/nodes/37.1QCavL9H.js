import{s as Qe,V as ke,e as i,b as E,t as oe,d as r,v as le,j as y,f as v,i as c,h as ie,w as n,k as ge,l as t,p as me,a4 as xe,W as Ue,m as qe,y as Ze,o as Je,r as we,L as st,C as Ke,q as lt}from"../chunks/scheduler.rYb7pZZG.js";import{S as et,i as tt,f as Ve,c as Se,b as De,m as Ie,t as $e,a as Ne,d as Pe}from"../chunks/index.DuGWJhq4.js";import{p as ot}from"../chunks/stores.arz3Yo0p.js";import{T as it}from"../chunks/Title.-2iHfz2o.js";import{S as We}from"../chunks/SimpleAutocomplete.5lHfAqj5.js";import{l as ue}from"../chunks/layers.88bRd9P8.js";import{a as rt}from"../chunks/updateDefendTree.HAcxH5O7.js";/* empty css                             */import{J as ct,L as dt,s as ut}from"../chunks/dialog.wXtvGAzx.js";function mt(e){let f,m="Settings",a,d,b,L="Profile",w,p,x,h,I,X="Matrix Overlay",M,C,J,V,g,k,N,s,O,D,l,W="Matrix Readonly",H,R,P,z,ee,fe,T,_e="Show Side Capabilities",re,Z,$,U,ce,j,F,B="Show Legend",pe,Y,te,ve,o,_,K=(e[3].containerSize*100).toFixed(0)+"",Q,he,be,q,ne,ae="60",Ce,A,Ee,se,He="100",de,ze,je;function nt(u){e[10](u)}let Be={inputClassName:"autocomplete-cursor-select",items:e[3]?.profiles,readonly:!0,labelFieldName:"name",onChange:e[9]};e[2]!==void 0&&(Be.selectedItem=e[2]),p=new We({props:Be}),ke.push(()=>Ve(p,"selectedItem",nt));function at(u){e[12](u)}let Ge={inputClassName:"autocomplete-cursor-select",items:Object.values(e[4]),labelFieldName:"name",readonly:!0,onChange:e[11]};return e[1]!==void 0&&(Ge.selectedItem=e[1]),C=new We({props:Ge}),ke.push(()=>Ve(C,"selectedItem",at)),{c(){f=i("h3"),f.textContent=m,a=E(),d=i("article"),b=i("div"),b.textContent=L,w=E(),Se(p.$$.fragment),h=E(),I=i("div"),I.textContent=X,M=E(),Se(C.$$.fragment),V=E(),g=i("section"),k=i("article"),N=i("form"),s=i("input"),D=E(),l=i("span"),l.textContent=W,H=E(),R=i("article"),P=i("form"),z=i("input"),fe=E(),T=i("span"),T.textContent=_e,re=E(),Z=i("article"),$=i("form"),U=i("input"),j=E(),F=i("span"),F.textContent=B,pe=E(),Y=i("article"),te=i("div"),ve=oe("Container Scale"),o=i("span"),_=oe("("),Q=oe(K),he=oe(")"),be=E(),q=i("div"),ne=i("span"),ne.textContent=ae,Ce=E(),A=i("input"),Ee=E(),se=i("span"),se.textContent=He,this.h()},l(u){f=r(u,"H3",{class:!0,"data-svelte-h":!0}),le(f)!=="svelte-ihiao5"&&(f.textContent=m),a=y(u),d=r(u,"ARTICLE",{class:!0});var S=v(d);b=r(S,"DIV",{class:!0,"data-svelte-h":!0}),le(b)!=="svelte-nczzpi"&&(b.textContent=L),w=y(S),De(p.$$.fragment,S),h=y(S),I=r(S,"DIV",{class:!0,"data-svelte-h":!0}),le(I)!=="svelte-czypmm"&&(I.textContent=X),M=y(S),De(C.$$.fragment,S),S.forEach(c),V=y(u),g=r(u,"SECTION",{class:!0});var G=v(g);k=r(G,"ARTICLE",{class:!0});var Te=v(k);N=r(Te,"FORM",{class:!0});var Le=v(N);s=r(Le,"INPUT",{class:!0,type:!0,name:!0,tabindex:!0}),D=y(Le),l=r(Le,"SPAN",{class:!0,"data-svelte-h":!0}),le(l)!=="svelte-1saz4fh"&&(l.textContent=W),Le.forEach(c),Te.forEach(c),H=y(G),R=r(G,"ARTICLE",{class:!0});var Xe=v(R);P=r(Xe,"FORM",{class:!0});var Me=v(P);z=r(Me,"INPUT",{class:!0,type:!0,name:!0,tabindex:!0}),fe=y(Me),T=r(Me,"SPAN",{class:!0,"data-svelte-h":!0}),le(T)!=="svelte-lt3qpu"&&(T.textContent=_e),Me.forEach(c),Xe.forEach(c),re=y(G),Z=r(G,"ARTICLE",{class:!0});var Ye=v(Z);$=r(Ye,"FORM",{class:!0});var Oe=v($);U=r(Oe,"INPUT",{class:!0,type:!0,name:!0,tabindex:!0}),j=y(Oe),F=r(Oe,"SPAN",{class:!0,"data-svelte-h":!0}),le(F)!=="svelte-1kzsxpu"&&(F.textContent=B),Oe.forEach(c),Ye.forEach(c),pe=y(G),Y=r(G,"ARTICLE",{class:!0});var Fe=v(Y);te=r(Fe,"DIV",{class:!0});var Ae=v(te);ve=ie(Ae,"Container Scale"),o=r(Ae,"SPAN",{});var Re=v(o);_=ie(Re,"("),Q=ie(Re,K),he=ie(Re,")"),Re.forEach(c),Ae.forEach(c),be=y(Fe),q=r(Fe,"DIV",{class:!0});var ye=v(q);ne=r(ye,"SPAN",{"data-svelte-h":!0}),le(ne)!=="svelte-nt3n7g"&&(ne.textContent=ae),Ce=y(ye),A=r(ye,"INPUT",{type:!0,min:!0,max:!0,class:!0,id:!0}),Ee=y(ye),se=r(ye,"SPAN",{"data-svelte-h":!0}),le(se)!=="svelte-rbuf0z"&&(se.textContent=He),ye.forEach(c),Fe.forEach(c),G.forEach(c),this.h()},h(){n(f,"class","text-center"),n(b,"class","select-name svelte-1d9uoe9"),n(I,"class","select-name svelte-1d9uoe9"),n(d,"class","select-setting svelte-1d9uoe9"),n(s,"class","check-box"),n(s,"type","checkbox"),n(s,"name","readonly"),s.checked=O=e[3].isReadonly,n(s,"tabindex","0"),n(l,"class","layer-text"),n(N,"class","svelte-1d9uoe9"),n(k,"class","setting"),n(z,"class","check-box"),n(z,"type","checkbox"),n(z,"name","drawer open"),z.checked=ee=e[3].isDrawerOpen,n(z,"tabindex","0"),n(T,"class","layer-text"),n(P,"class","svelte-1d9uoe9"),n(R,"class","setting"),n(U,"class","check-box"),n(U,"type","checkbox"),n(U,"name","show legend"),U.checked=ce=e[3].showLegend,n(U,"tabindex","0"),n(F,"class","layer-text"),n($,"class","svelte-1d9uoe9"),n(Z,"class","setting"),n(te,"class","select-name svelte-1d9uoe9"),n(A,"type","range"),n(A,"min","60"),n(A,"max","99"),A.value="80",n(A,"class","slider"),n(A,"id","myRange"),n(q,"class","size-slider svelte-1d9uoe9"),n(Y,"class","setting"),n(g,"class","setting-checks-container svelte-1d9uoe9")},m(u,S){ge(u,f,S),ge(u,a,S),ge(u,d,S),t(d,b),t(d,w),Ie(p,d,null),t(d,h),t(d,I),t(d,M),Ie(C,d,null),ge(u,V,S),ge(u,g,S),t(g,k),t(k,N),t(N,s),t(N,D),t(N,l),t(g,H),t(g,R),t(R,P),t(P,z),t(P,fe),t(P,T),t(g,re),t(g,Z),t(Z,$),t($,U),t($,j),t($,F),t(g,pe),t(g,Y),t(Y,te),t(te,ve),t(te,o),t(o,_),t(o,Q),t(o,he),t(Y,be),t(Y,q),t(q,ne),t(q,Ce),t(q,A),e[16](A),t(q,Ee),t(q,se),de=!0,ze||(je=[me(s,"click",xe(e[13])),me(z,"click",xe(e[14])),me(U,"click",xe(e[15])),me(A,"input",e[8])],ze=!0)},p(u,[S]){const G={};S&8&&(G.items=u[3]?.profiles),!x&&S&4&&(x=!0,G.selectedItem=u[2],Ue(()=>x=!1)),p.$set(G);const Te={};!J&&S&2&&(J=!0,Te.selectedItem=u[1],Ue(()=>J=!1)),C.$set(Te),(!de||S&8&&O!==(O=u[3].isReadonly))&&(s.checked=O),(!de||S&8&&ee!==(ee=u[3].isDrawerOpen))&&(z.checked=ee),(!de||S&8&&ce!==(ce=u[3].showLegend))&&(U.checked=ce),(!de||S&8)&&K!==(K=(u[3].containerSize*100).toFixed(0)+"")&&qe(Q,K)},i(u){de||($e(p.$$.fragment,u),$e(C.$$.fragment,u),de=!0)},o(u){Ne(p.$$.fragment,u),Ne(C.$$.fragment,u),de=!1},d(u){u&&(c(f),c(a),c(d),c(V),c(g)),Pe(p),Pe(C),e[16](null),ze=!1,Ze(je)}}}function ft(e,f,m){let a;Je(e,ue,s=>m(3,a=s));let d=null;const b={multiColor:{name:"multiColor",showLegend:!0},heatMap:{name:"heatMap",showLegend:!1}};let L=b[a?.techniqueMappingMode]||null,w=a?.profiles?.[a?.selectedProfile]||null;const p=s=>{we(ue,a[s]=!a[s],a)},x=s=>{if(s){const O=a.profiles.findIndex(({id:D})=>D===s.id);we(ue,a.selectedProfile=O,a),m(2,w=a?.profiles?.[O]||null),rt.reset()}else we(ue,a.selectedProfile=null,a),m(2,w=s)},h=s=>{if(typeof s=="string")m(1,L=s);else if(s&&s.name){const{name:O="none",showLegend:D}=s;m(1,L=s),we(ue,a.techniqueMappingMode=O,a),we(ue,a.showLegend=D,a)}},I=s=>{we(ue,a.containerSize=s.target.value/100,a)},X=s=>x(s);function M(s){w=s,m(2,w)}const C=s=>h(s);function J(s){L=s,m(1,L)}const V=()=>p("isReadonly"),g=()=>p("isDrawerOpen"),k=()=>p("showLegend");function N(s){ke[s?"unshift":"push"](()=>{d=s,m(0,d)})}return[d,L,w,a,b,p,x,h,I,X,M,C,J,V,g,k,N]}class pt extends et{constructor(f){super(),tt(this,f,ft,mt,Qe,{})}}const ht=({size:e,domain:f},m="<embed-data>")=>`
<script>
  let iframe = null;

  const user_data = ${JSON.stringify(m,null,2)};

  const post_layers = (event) => {
    if (event.data?.call === "FromParent") {
      iframe.contentWindow.postMessage(
        {
          call: "toParent",
          value: user_data,
        },
        event.origin
      );
    }
  };
  <\/script>

  <svelte:window on:message={post_layers} />

  <main>
    <iframe
      id="iframe"
      bind:this={iframe}
      src="${f}/profile/"
      title="D3FEND Embedded" />
  </main>

  <style>
    #iframe {
      display: block;
      margin: 0 auto;
      width: 100%;
      height: 100vh;
      transform: scale(${e});
      -moz-transform: scale(${e});
      -o-transform: scale(${e});
      -webkit-transform: scale(${e});
    }
  </style>
  `,gt=({size:e,domain:f},m="<embed-data>")=>`
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>D3FEND EMBEDDED</title>

  <script>
    const user_data = ${JSON.stringify(m,null,2)};

    const post_layers = (event) => {
      const iframe = document.getElementById("iframe");

      if (event.data?.call === "FromParent") {
        iframe.contentWindow.postMessage(
          {
            call: "toParent",
            value: user_data,
          },
          event.origin
        );
      }
    };

    window.addEventListener("message", (event) => {

      if (event.origin !== "${f}") return;

      post_layers(event);
    });
  <\/script>

  <style>
    #iframe {
      display: block;
      margin: 0 auto;
      width: 100%;
      height: 100vh;
      transform: scale(${e});
      -moz-transform: scale(${e});
      -o-transform: scale(${e});
      -webkit-transform: scale(${e});
    }
  </style>
</head>

<main>
  <iframe
          id="iframe"
          src="${f}/profile/"
          title="D3FEND Embedded" />
</main>

</html>
`,_t=({domain:e,data:f})=>{const m=JSON.stringify(f),a=ct.crush(m),d=encodeURIComponent(a);return`${e}/profile/?profile=${d}`};function vt(e){let f,m,a,d,b='<h1 class="svelte-a38n6n"><span class="fancy-font">D3FEND</span> Embeddable Widget</h1> <h6 class="svelte-a38n6n">Use the D3FEND Embeddable Widget to embed an interactive D3FEND Profile in another webpage.</h6>',L,w,p,x,h,I,X,M,C,J,V,g,k,N=e[3].func({size:e[0].containerSize,domain:e[4],data:e[0]})+"",s,O,D,l,W=e[3].text+"",H,R,P,z,ee,fe,T,_e,re,Z,$,U,ce,j,F,B,pe,Y;f=new it({props:{title:"Embedded D3FEND Matrix",og_title:"MITRE Embedded D3FEND Layers",og_type:"website",og_url:"https://d3fend.mitre.org/",og_image:"https://d3fend.mitre.org/img/d3fend-og.png",og_description:"D3FEND Capability Layers Analysis."}}),p=new pt({});function te(o){e[13](o)}let ve={inputClassName:"autocomplete-cursor-select",items:Object.values(e[5]),labelFieldName:"name",readonly:!0,onChange:e[12]};return e[3]!==void 0&&(ve.selectedItem=e[3]),C=new We({props:ve}),ke.push(()=>Ve(C,"selectedItem",te)),F=new dt({}),{c(){Se(f.$$.fragment),m=E(),a=i("main"),d=i("section"),d.innerHTML=b,L=E(),w=i("code"),Se(p.$$.fragment),x=E(),h=i("code"),I=i("h3"),X=oe(`Embed Code

      `),M=i("span"),Se(C.$$.fragment),V=E(),g=i("div"),k=i("pre"),s=oe(N),O=E(),D=i("div"),l=i("div"),H=oe(W),R=E(),P=i("button"),z=oe("Download"),fe=E(),T=i("button"),_e=oe("Copy to Clipboard"),Z=E(),$=i("iframe"),ce=E(),j=i("dialog"),Se(F.$$.fragment),this.h()},l(o){De(f.$$.fragment,o),m=y(o),a=r(o,"MAIN",{style:!0,class:!0});var _=v(a);d=r(_,"SECTION",{id:!0,class:!0,"data-svelte-h":!0}),le(d)!=="svelte-1myx4vl"&&(d.innerHTML=b),L=y(_),w=r(_,"CODE",{id:!0,class:!0});var K=v(w);De(p.$$.fragment,K),K.forEach(c),x=y(_),h=r(_,"CODE",{id:!0,class:!0});var Q=v(h);I=r(Q,"H3",{class:!0});var he=v(I);X=ie(he,`Embed Code

      `),M=r(he,"SPAN",{id:!0,class:!0});var be=v(M);De(C.$$.fragment,be),be.forEach(c),he.forEach(c),V=y(Q),g=r(Q,"DIV",{id:!0,class:!0});var q=v(g);k=r(q,"PRE",{class:!0});var ne=v(k);s=ie(ne,N),ne.forEach(c),q.forEach(c),O=y(Q),D=r(Q,"DIV",{id:!0,class:!0});var ae=v(D);l=r(ae,"DIV",{});var Ce=v(l);H=ie(Ce,W),Ce.forEach(c),R=y(ae),P=r(ae,"BUTTON",{class:!0});var A=v(P);z=ie(A,"Download"),A.forEach(c),fe=y(ae),T=r(ae,"BUTTON",{class:!0});var Ee=v(T);_e=ie(Ee,"Copy to Clipboard"),Ee.forEach(c),ae.forEach(c),Q.forEach(c),Z=y(_),$=r(_,"IFRAME",{id:!0,src:!0,title:!0,class:!0}),v($).forEach(c),ce=y(_),j=r(_,"DIALOG",{class:!0});var se=v(j);De(F.$$.fragment,se),se.forEach(c),_.forEach(c),this.h()},h(){n(d,"id","header"),n(d,"class","svelte-a38n6n"),n(w,"id","embed-settings"),n(w,"class","svelte-a38n6n"),n(M,"id","download-options"),n(M,"class","svelte-a38n6n"),n(I,"class","svelte-a38n6n"),n(k,"class","svelte-a38n6n"),n(g,"id","code-container"),n(g,"class","svelte-a38n6n"),n(P,"class","download-code svelte-a38n6n"),P.disabled=ee=e[3].name==="Config Settings",n(T,"class","download-code svelte-a38n6n"),T.disabled=re=e[3].name==="Config Settings",n(D,"id","download-container"),n(D,"class","svelte-a38n6n"),n(h,"id","embed-code"),n(h,"class","config-container svelte-a38n6n"),n($,"id","layers-iframe"),st($.src,U="/profile/")||n($,"src",U),n($,"title","D3FEND Embedded"),n($,"class","svelte-a38n6n"),n(j,"class","iframe-dialog"),Ke(a,"--container-size",e[0].containerSize),n(a,"class","svelte-a38n6n")},m(o,_){Ie(f,o,_),ge(o,m,_),ge(o,a,_),t(a,d),t(a,L),t(a,w),Ie(p,w,null),t(a,x),t(a,h),t(h,I),t(I,X),t(I,M),Ie(C,M,null),t(h,V),t(h,g),t(g,k),t(k,s),t(h,O),t(h,D),t(D,l),t(l,H),t(D,R),t(D,P),t(P,z),t(D,fe),t(D,T),t(T,_e),t(a,Z),t(a,$),e[16]($),t(a,ce),t(a,j),Ie(F,j,null),e[17](j),B=!0,pe||(Y=[me(window,"message",e[6]),me(P,"click",e[14]),me(T,"click",e[15]),me(j,"close",e[18])],pe=!0)},p(o,[_]){const K={};!J&&_&8&&(J=!0,K.selectedItem=o[3],Ue(()=>J=!1)),C.$set(K),(!B||_&25)&&N!==(N=o[3].func({size:o[0].containerSize,domain:o[4],data:o[0]})+"")&&qe(s,N),(!B||_&8)&&W!==(W=o[3].text+"")&&qe(H,W),(!B||_&8&&ee!==(ee=o[3].name==="Config Settings"))&&(P.disabled=ee),(!B||_&8&&re!==(re=o[3].name==="Config Settings"))&&(T.disabled=re),(!B||_&1)&&Ke(a,"--container-size",o[0].containerSize)},i(o){B||($e(f.$$.fragment,o),$e(p.$$.fragment,o),$e(C.$$.fragment,o),$e(F.$$.fragment,o),B=!0)},o(o){Ne(f.$$.fragment,o),Ne(p.$$.fragment,o),Ne(C.$$.fragment,o),Ne(F.$$.fragment,o),B=!1},d(o){o&&(c(m),c(a)),Pe(f,o),Pe(p),Pe(C),e[16](null),Pe(F),e[17](null),pe=!1,Ze(Y)}}}function bt(e,f,m){let a,d,b,L;Je(e,ue,l=>m(0,b=l)),Je(e,ot,l=>m(11,L=l));let w=null,p=null;const x={"Config Settings":{name:"Config Settings",text:"Profile Config Settings",func:()=>d},"index.html":{name:"index.html",download:"index.html",text:"Complete HTML/Javascript runnable script",func:gt},"Svelte Compenent":{name:"Svelte Compenent",download:"D3fendProfile.svelte",text:"Composable Svelte Compoenent runnable in Svelte Application",func:ht},"Profile data":{name:"Profile data",text:"Export Profile Data",func:()=>JSON.stringify(b,null,2).trim()},"Profile URL":{name:"Profile URL",text:"URL to D3FEND Custom Profile",func:_t}};let h=x["Config Settings"];lt(()=>{b.localStorageWarning&&p.showModal()});const I=l=>{l.data?.call==="FromParent"&&w.contentWindow.postMessage({call:"toParent",value:b},l.origin)},X=l=>{l&&l.text&&m(3,h=l)},M=async(l,{func:W,download:H})=>{const R=W({size:b.containerSize,domain:a},b);ut(R,H)},C=async(l,{func:W})=>{const H=W({size:b.containerSize,domain:a},b);try{await navigator.clipboard.writeText(H)}catch(R){console.error("Failed to copy: ",R)}},J=l=>{l.close()},V=l=>X(l);function g(l){h=l,m(3,h)}const k=l=>M(l,h),N=l=>C(l,h);function s(l){ke[l?"unshift":"push"](()=>{w=l,m(1,w)})}function O(l){ke[l?"unshift":"push"](()=>{p=l,m(2,p)})}const D=()=>J(p);return e.$$.update=()=>{e.$$.dirty&2048&&m(4,a=L.url.origin),e.$$.dirty&1&&(d=JSON.stringify(b,["isReadonly","isDrawerOpen","showLegend","techniqueMappingMode","selectedProfile","matrixSize","containerSize"],2).trim())},[b,w,p,h,a,x,I,X,M,C,J,L,V,g,k,N,s,O,D]}class Pt extends et{constructor(f){super(),tt(this,f,bt,vt,Qe,{})}}export{Pt as component};
