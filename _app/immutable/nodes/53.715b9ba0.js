import{e as dt}from"../chunks/index.5e2a9a64.js";import{s as pt,a as q,f as p,c as N,g as m,h as y,F as B,d as h,j as w,i as $,x as u,ab as lt,C as X,D as mt,z as vt,o as bt,l as O,m as z,k as gt,n as tt,y as F,e as st,G as kt}from"../chunks/scheduler.50831561.js";import{h as nt,u as Et}from"../chunks/await_block.3cda980a.js";import{e as ot}from"../chunks/each.8d18d1a2.js";import{S as Dt,i as xt,b as Y,d as Q,m as W,a as P,t as H,e as Z,g as ht,c as _t}from"../chunks/index.24431cc3.js";import{H as yt}from"../chunks/Header.66ace148.js";import{T as Ct}from"../chunks/Title.28d88b77.js";/* empty css                                                    */import{e as wt,S as Tt}from"../chunks/extract.8fe98a53.js";import{G as it}from"../chunks/lib.9e57a3f1.js";import{p as It}from"../chunks/stores.9b0ea2d4.js";async function qt({fetch:o}){const t=await o("/api/dao/artifacts.json"),a=await t.json();if(t.status!==200)throw dt(500,data.message);return{techniques:a}}const Jt=Object.freeze(Object.defineProperty({__proto__:null,load:qt},Symbol.toStringTag,{value:"Module"}));function ct(o,t,a){const e=o.slice();return e[19]=t[a],e}function Nt(o){let t,a=o[22].message+"",e;return{c(){t=p("p"),e=O(a),this.h()},l(l){t=m(l,"P",{style:!0});var n=y(t);e=z(n,a),n.forEach(h),this.h()},h(){gt(t,"color","red")},m(l,n){$(l,t,n),u(t,e)},p(l,n){n&8&&a!==(a=l[22].message+"")&&tt(e,a)},i:F,o:F,d(l){l&&h(t)}}}function $t(o){let t,a,e,l;const n=[At,St],s=[];function i(c,v){return c[18].length>0?0:!c[2]&&c[18].length<1?1:-1}return~(t=i(o))&&(a=s[t]=n[t](o)),{c(){a&&a.c(),e=st()},l(c){a&&a.l(c),e=st()},m(c,v){~t&&s[t].m(c,v),$(c,e,v),l=!0},p(c,v){let k=t;t=i(c),t===k?~t&&s[t].p(c,v):(a&&(ht(),H(s[k],1,1,()=>{s[k]=null}),_t()),~t?(a=s[t],a?a.p(c,v):(a=s[t]=n[t](c),a.c()),P(a,1),a.m(e.parentNode,e)):a=null)},i(c){l||(P(a),l=!0)},o(c){H(a),l=!1},d(c){c&&h(e),~t&&s[t].d(c)}}}function St(o){let t,a="No D3FEND Artifacts found in text.";return{c(){t=p("div"),t.textContent=a,this.h()},l(e){t=m(e,"DIV",{class:!0,"data-svelte-h":!0}),B(t)!=="svelte-505pc9"&&(t.textContent=a),this.h()},h(){w(t,"class","card")},m(e,l){$(e,t,l)},p:F,i:F,o:F,d(e){e&&h(t)}}}function At(o){let t,a,e=o[0]&&ft(o);return{c(){t=p("div"),e&&e.c(),this.h()},l(l){t=m(l,"DIV",{class:!0});var n=y(t);e&&e.l(n),n.forEach(h),this.h()},h(){w(t,"class","card")},m(l,n){$(l,t,n),e&&e.m(t,null),a=!0},p(l,n){l[0]?e?(e.p(l,n),n&1&&P(e,1)):(e=ft(l),e.c(),P(e,1),e.m(t,null)):e&&(ht(),H(e,1,1,()=>{e=null}),_t())},i(l){a||(P(e),a=!0)},o(l){H(e),a=!1},d(l){l&&h(t),e&&e.d()}}}function ft(o){let t,a,e,l,n,s,i,c,v=o[0].length+"",k,V,S,E,T;e=new Tt({props:{url:o[4].url}});let I=ot(o[0]),_=[];for(let r=0;r<I.length;r+=1)_[r]=ut(ct(o,I,r));return{c(){t=p("div"),a=p("div"),Y(e.$$.fragment),l=q(),n=p("div"),s=p("b"),i=p("i"),c=O("Extracted "),k=O(v),V=O(" unique IDs:"),S=q(),E=p("dl");for(let r=0;r<_.length;r+=1)_[r].c();this.h()},l(r){t=m(r,"DIV",{class:!0});var g=y(t);a=m(g,"DIV",{class:!0});var d=y(a);Q(e.$$.fragment,d),d.forEach(h),g.forEach(h),l=N(r),n=m(r,"DIV",{class:!0});var f=y(n);s=m(f,"B",{});var A=y(s);i=m(A,"I",{});var j=y(i);c=z(j,"Extracted "),k=z(j,v),V=z(j," unique IDs:"),j.forEach(h),A.forEach(h),S=N(f),E=m(f,"DL",{class:!0});var M=y(E);for(let L=0;L<_.length;L+=1)_[L].l(M);M.forEach(h),f.forEach(h),this.h()},h(){w(a,"class","text-right"),w(t,"class","stretch"),w(E,"class","flex flex-wrap svelte-1bg32kq"),w(n,"class","")},m(r,g){$(r,t,g),u(t,a),W(e,a,null),$(r,l,g),$(r,n,g),u(n,s),u(s,i),u(i,c),u(i,k),u(i,V),u(n,S),u(n,E);for(let d=0;d<_.length;d+=1)_[d]&&_[d].m(E,null);T=!0},p(r,g){const d={};if(g&16&&(d.url=r[4].url),e.$set(d),(!T||g&1)&&v!==(v=r[0].length+"")&&tt(k,v),g&1){I=ot(r[0]);let f;for(f=0;f<I.length;f+=1){const A=ct(r,I,f);_[f]?_[f].p(A,g):(_[f]=ut(A),_[f].c(),_[f].m(E,null))}for(;f<_.length;f+=1)_[f].d(1);_.length=I.length}},i(r){T||(P(e.$$.fragment,r),T=!0)},o(r){H(e.$$.fragment,r),T=!1},d(r){r&&(h(t),h(l),h(n)),Z(e),kt(_,r)}}}function ut(o){let t,a,e=o[19]+"",l,n;return{c(){t=p("dd"),a=p("a"),l=O(e),this.h()},l(s){t=m(s,"DD",{});var i=y(t);a=m(i,"A",{href:!0});var c=y(a);l=z(c,e),c.forEach(h),i.forEach(h),this.h()},h(){w(a,"href",n="/dao/artifact/"+o[19])},m(s,i){$(s,t,i),u(t,a),u(a,l)},p(s,i){i&1&&e!==(e=s[19]+"")&&tt(l,e),i&1&&n!==(n="/dao/artifact/"+s[19])&&w(a,"href",n)},d(s){s&&h(t)}}}function Pt(o){let t;return{c(){t=O("enter text and click go")},l(a){t=z(a,"enter text and click go")},m(a,e){$(a,t,e)},p:F,i:F,o:F,d(a){a&&h(t)}}}function Vt(o){let t,a,e,l,n,s,i,c="D3FEND Artifact Extractor",v,k,V=`Extracts D3FEND artifacts from blobs of text. You may also want to try the <a href="/tools/d3fend-extractor">D3FEND Extractor</a>
      or <a href="/tools/attack-extractor">ATT&amp;CK Extractor.</a>`,S,E,T="<i>Paste any text containing D3FEND Artifacts:</i>",I,_,r,g,d,f,A="GO",j,M,L,K,U,G,R,J,et;t=new Ct({props:{title:"D3FEND Artifact Extractor | Tools | "}}),l=new yt({});let x={ctx:o,current:null,token:null,hasCatch:!0,pending:Pt,then:$t,catch:Nt,value:18,error:22,blocks:[,,,]};return nt(G=o[3],x),{c(){Y(t.$$.fragment),a=q(),e=p("section"),Y(l.$$.fragment),n=q(),s=p("div"),i=p("h1"),i.textContent=c,v=q(),k=p("p"),k.innerHTML=V,S=q(),E=p("p"),E.innerHTML=T,I=q(),_=p("div"),r=p("textarea"),g=q(),d=p("div"),f=p("button"),f.textContent=A,j=q(),M=p("br"),L=q(),K=p("br"),U=q(),x.block.c(),this.h()},l(D){Q(t.$$.fragment,D),a=N(D),e=m(D,"SECTION",{class:!0});var b=y(e);Q(l.$$.fragment,b),n=N(b),s=m(b,"DIV",{class:!0});var C=y(s);i=m(C,"H1",{"data-svelte-h":!0}),B(i)!=="svelte-1veabte"&&(i.textContent=c),v=N(C),k=m(C,"P",{"data-svelte-h":!0}),B(k)!=="svelte-5bld3z"&&(k.innerHTML=V),S=N(C),E=m(C,"P",{class:!0,"data-svelte-h":!0}),B(E)!=="svelte-16bzqxf"&&(E.innerHTML=T),I=N(C),_=m(C,"DIV",{});var at=y(_);r=m(at,"TEXTAREA",{class:!0}),y(r).forEach(h),at.forEach(h),g=N(C),d=m(C,"DIV",{});var rt=y(d);f=m(rt,"BUTTON",{class:!0,"data-svelte-h":!0}),B(f)!=="svelte-88k995"&&(f.textContent=A),rt.forEach(h),j=N(C),M=m(C,"BR",{}),C.forEach(h),L=N(b),K=m(b,"BR",{}),U=N(b),x.block.l(b),b.forEach(h),this.h()},h(){w(E,"class","text-2"),w(r,"class","svelte-1bg32kq"),w(f,"class","button"),w(s,"class","card"),w(e,"class"," svelte-1bg32kq")},m(D,b){W(t,D,b),$(D,a,b),$(D,e,b),W(l,e,null),u(e,n),u(e,s),u(s,i),u(s,v),u(s,k),u(s,S),u(s,E),u(s,I),u(s,_),u(_,r),lt(r,o[1]),u(s,g),u(s,d),u(d,f),u(s,j),u(s,M),u(e,L),u(e,K),u(e,U),x.block.m(e,x.anchor=null),x.mount=()=>e,x.anchor=null,R=!0,J||(et=[X(r,"input",o[8]),X(r,"keypress",o[6]),X(f,"click",o[5])],J=!0)},p(D,[b]){o=D,b&2&&lt(r,o[1]),x.ctx=o,b&8&&G!==(G=o[3])&&nt(G,x)||Et(x,o,b)},i(D){R||(P(t.$$.fragment,D),P(l.$$.fragment,D),P(x.block),R=!0)},o(D){H(t.$$.fragment,D),H(l.$$.fragment,D);for(let b=0;b<3;b+=1){const C=x.blocks[b];H(C)}R=!1},d(D){D&&(h(a),h(e)),Z(t,D),Z(l),x.block.d(),x.token=null,x=null,J=!1,mt(et)}}}function jt(o,t,a){let e;vt(o,It,r=>a(4,e=r));let{data:l}=t;const n=new it(l.techniques,{index:!0,index_key:"d3f:d3fend-id"});let s,i="",c=!0,v;v=e.url.searchParams.get("q");let k=[];async function V(r){const g=`/api/dao/artifact/${r}.json`,d=await fetch(g);if(d.status==404)return{id:r,def_to_off:[],description:{graph:[]},status:d.status};if(d.ok){const f=await d.json();return{id:r,def_to_off:f.def_to_off,description:new it(f.description)}}else throw new Error(i)}async function S(){let r=a(0,s=Array.from(new Set(wt(i,n))));return r&&(r.forEach(function(g){let d=V(g);d&&k.push(d)}),e.url.searchParams.set("q",JSON.stringify(r)),history.replaceState(null,"mapping",e.url)),k}let E=S();function T(){a(3,E=S()),a(2,c=!1)}function I(r){r.ctrlKey==!0&&r.keyCode==13&&T()}bt(async()=>{v?(a(1,i=v),T()):a(1,i="")});function _(){i=this.value,a(1,i)}return o.$$set=r=>{"data"in r&&a(7,l=r.data)},[s,i,c,E,e,T,I,l,_]}class Xt extends Dt{constructor(t){super(),xt(this,t,jt,Vt,pt,{data:7})}}export{Xt as component,Jt as universal};
