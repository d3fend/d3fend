import{e as Me}from"../chunks/index.aHWtvSLc.js";import{s as Ve,b as L,e as p,j as M,d as v,f as A,v as G,i,w as $,k as I,l as c,M as me,p as se,y as Se,o as Re,q as Be,t as x,h as O,C as pe,m as U,n as Q,A as oe,I as ve,N as be}from"../chunks/scheduler.rYb7pZZG.js";import{h as de,u as qe}from"../chunks/await_block.-eayCJv5.js";import{e as ie}from"../chunks/each.shjUScpc.js";import{S as xe,i as Oe,c as fe,b as ce,m as ue,t as W,a as Z,d as he,g as He,e as je}from"../chunks/index.DuGWJhq4.js";import{a as Pe,S as Le}from"../chunks/extract.fE2ReIuF.js";import{G as ge,f as _e,h as ke,e as ne}from"../chunks/lib.FzuLk5Dt.js";import{T as Ke}from"../chunks/Title.-2iHfz2o.js";import{H as Fe}from"../chunks/Header.pyVwXBX-.js";import{A as ze}from"../chunks/Alert.4Peyoxud.js";import{p as Ue}from"../chunks/stores.CeV6jFzo.js";async function Ge({fetch:n}){const e=await n("/api/offensive-technique/all.json"),t=await e.json();return e.status!==200&&Me(500,data.message),{techniques:t}}const Et=Object.freeze(Object.defineProperty({__proto__:null,load:Ge},Symbol.toStringTag,{value:"Module"}));function Ee(n,e,t){const l=n.slice();return l[21]=e[t],l}function Te(n,e,t){const l=n.slice();return l[25]=e[t],l}function De(n,e,t){const l=n.slice();return l[29]=e[t],l}function Je(n){let e,t,l=n[28].message+"",a;return{c(){e=p("p"),t=x("error with promise: "),a=x(l),this.h()},l(s){e=v(s,"P",{style:!0});var r=A(e);t=O(r,"error with promise: "),a=O(r,l),r.forEach(i),this.h()},h(){pe(e,"color","red")},m(s,r){I(s,e,r),c(e,t),c(e,a)},p(s,r){r[0]&32&&l!==(l=s[28].message+"")&&U(a,l)},i:Q,o:Q,d(s){s&&i(e)}}}function Xe(n){let e,t,l,a;const s=[Qe,Ye],r=[];function u(h,m){return h[20].length>0?0:!h[3]&&h[20].length<1?1:-1}return~(e=u(n))&&(t=r[e]=s[e](n)),{c(){t&&t.c(),l=oe()},l(h){t&&t.l(h),l=oe()},m(h,m){~e&&r[e].m(h,m),I(h,l,m),a=!0},p(h,m){let y=e;e=u(h),e===y?~e&&r[e].p(h,m):(t&&(He(),Z(r[y],1,1,()=>{r[y]=null}),je()),~e?(t=r[e],t?t.p(h,m):(t=r[e]=s[e](h),t.c()),W(t,1),t.m(l.parentNode,l)):t=null)},i(h){a||(W(t),a=!0)},o(h){Z(t),a=!1},d(h){h&&i(l),~e&&r[e].d(h)}}}function Ye(n){let e,t="No ATT&CK techniques found in text.";return{c(){e=p("div"),e.textContent=t,this.h()},l(l){e=v(l,"DIV",{class:!0,"data-svelte-h":!0}),G(e)!=="svelte-1f3fsck"&&(e.textContent=t),this.h()},h(){$(e,"class","card")},m(l,a){I(l,e,a)},p:Q,i:Q,o:Q,d(l){l&&i(e)}}}function Qe(n){let e,t,l,a,s,r,u,h,m,y,k,T="<b><i>Mapping Results:</i></b>",D,S,j,g,f,E="copy",_,d,C,w='<th class="stretch">ATT&amp;CK ID</th> <th>ATT&amp;CK Name</th> <th>Related D3FEND Techniques</th>',V,q,B,J,H=n[0]&&Ce(n);a=new ze({props:{$$slots:{default:[We]},$$scope:{ctx:n}}}),m=new Le({props:{url:n[6].url}});function X(o,N){return o[2]?et:Ze}let Y=X(n),P=Y(n),R=ie(n[20]),b=[];for(let o=0;o<R.length;o+=1)b[o]=Ie(Ee(n,R,o));return{c(){e=p("div"),H&&H.c(),t=L(),l=p("div"),fe(a.$$.fragment),s=L(),r=p("div"),u=p("div"),h=p("div"),fe(m.$$.fragment),y=L(),k=p("div"),k.innerHTML=T,D=L(),S=p("div"),j=p("div"),P.c(),g=L(),f=p("button"),f.textContent=E,_=L(),d=p("table"),C=p("thead"),C.innerHTML=w,V=L();for(let o=0;o<b.length;o+=1)b[o].c();this.h()},l(o){e=v(o,"DIV",{class:!0});var N=A(e);H&&H.l(N),N.forEach(i),t=M(o),l=v(o,"DIV",{class:!0});var F=A(l);ce(a.$$.fragment,F),F.forEach(i),s=M(o),r=v(o,"DIV",{class:!0});var z=A(r);u=v(z,"DIV",{class:!0});var K=A(u);h=v(K,"DIV",{class:!0});var ee=A(h);ce(m.$$.fragment,ee),ee.forEach(i),K.forEach(i),y=M(z),k=v(z,"DIV",{"data-svelte-h":!0}),G(k)!=="svelte-1hnfu3y"&&(k.innerHTML=T),D=M(z),S=v(z,"DIV",{class:!0});var te=A(S);j=v(te,"DIV",{class:!0});var le=A(j);P.l(le),g=M(le),f=v(le,"BUTTON",{"data-svelte-h":!0}),G(f)!=="svelte-1gemhfw"&&(f.textContent=E),le.forEach(i),_=M(te),d=v(te,"TABLE",{id:!0,class:!0});var ae=A(d);C=v(ae,"THEAD",{"data-svelte-h":!0}),G(C)!=="svelte-17r3wjn"&&(C.innerHTML=w),V=M(ae);for(let re=0;re<b.length;re+=1)b[re].l(ae);ae.forEach(i),te.forEach(i),z.forEach(i),this.h()},h(){$(e,"class","card"),$(l,"class","card"),$(h,"class","text-right"),$(u,"class","stretch"),$(j,"class","text-right"),$(d,"id","mappings"),$(d,"class","table-auto"),$(S,"class","results-wrap center svelte-xumjr3"),$(r,"class","card")},m(o,N){I(o,e,N),H&&H.m(e,null),I(o,t,N),I(o,l,N),ue(a,l,null),I(o,s,N),I(o,r,N),c(r,u),c(u,h),ue(m,h,null),c(r,y),c(r,k),c(r,D),c(r,S),c(S,j),P.m(j,null),c(j,g),c(j,f),c(S,_),c(S,d),c(d,C),c(d,V);for(let F=0;F<b.length;F+=1)b[F]&&b[F].m(d,null);q=!0,B||(J=se(f,"click",it),B=!0)},p(o,N){o[0]?H?(H.p(o,N),N[0]&1&&W(H,1)):(H=Ce(o),H.c(),W(H,1),H.m(e,null)):H&&(He(),Z(H,1,1,()=>{H=null}),je());const F={};N[1]&2&&(F.$$scope={dirty:N,ctx:o}),a.$set(F);const z={};if(N[0]&64&&(z.url=o[6].url),m.$set(z),Y===(Y=X(o))&&P?P.p(o,N):(P.d(1),P=Y(o),P&&(P.c(),P.m(j,g))),N[0]&48){R=ie(o[20]);let K;for(K=0;K<R.length;K+=1){const ee=Ee(o,R,K);b[K]?b[K].p(ee,N):(b[K]=Ie(ee),b[K].c(),b[K].m(d,null))}for(;K<b.length;K+=1)b[K].d(1);b.length=R.length}},i(o){q||(W(H),W(a.$$.fragment,o),W(m.$$.fragment,o),q=!0)},o(o){Z(H),Z(a.$$.fragment,o),Z(m.$$.fragment,o),q=!1},d(o){o&&(i(e),i(t),i(l),i(s),i(r)),H&&H.d(),he(a),he(m),P.d(),ve(b,o),B=!1,J()}}}function Ce(n){let e,t,l,a,s,r,u,h,m=n[0].length+"",y,k,T,D,S;l=new Le({props:{url:n[6].url}});let j=ie(n[0]),g=[];for(let f=0;f<j.length;f+=1)g[f]=we(De(n,j,f));return{c(){e=p("div"),t=p("div"),fe(l.$$.fragment),a=L(),s=p("div"),r=p("b"),u=p("i"),h=x("Extracted "),y=x(m),k=x(" unique IDs:"),T=L(),D=p("dl");for(let f=0;f<g.length;f+=1)g[f].c();this.h()},l(f){e=v(f,"DIV",{class:!0});var E=A(e);t=v(E,"DIV",{class:!0});var _=A(t);ce(l.$$.fragment,_),_.forEach(i),E.forEach(i),a=M(f),s=v(f,"DIV",{class:!0});var d=A(s);r=v(d,"B",{});var C=A(r);u=v(C,"I",{});var w=A(u);h=O(w,"Extracted "),y=O(w,m),k=O(w," unique IDs:"),w.forEach(i),C.forEach(i),T=M(d),D=v(d,"DL",{class:!0});var V=A(D);for(let q=0;q<g.length;q+=1)g[q].l(V);V.forEach(i),d.forEach(i),this.h()},h(){$(t,"class","text-right"),$(e,"class","stretch"),$(D,"class","flex flex-wrap svelte-xumjr3"),$(s,"class","")},m(f,E){I(f,e,E),c(e,t),ue(l,t,null),I(f,a,E),I(f,s,E),c(s,r),c(r,u),c(u,h),c(u,y),c(u,k),c(s,T),c(s,D);for(let _=0;_<g.length;_+=1)g[_]&&g[_].m(D,null);S=!0},p(f,E){const _={};if(E[0]&64&&(_.url=f[6].url),l.$set(_),(!S||E[0]&1)&&m!==(m=f[0].length+"")&&U(y,m),E[0]&1){j=ie(f[0]);let d;for(d=0;d<j.length;d+=1){const C=De(f,j,d);g[d]?g[d].p(C,E):(g[d]=we(C),g[d].c(),g[d].m(D,null))}for(;d<g.length;d+=1)g[d].d(1);g.length=j.length}},i(f){S||(W(l.$$.fragment,f),S=!0)},o(f){Z(l.$$.fragment,f),S=!1},d(f){f&&(i(e),i(a),i(s)),he(l),ve(g,f)}}}function we(n){let e,t,l=n[29]+"",a,s;return{c(){e=p("dd"),t=p("a"),a=x(l),this.h()},l(r){e=v(r,"DD",{});var u=A(e);t=v(u,"A",{href:!0});var h=A(t);a=O(h,l),h.forEach(i),u.forEach(i),this.h()},h(){$(t,"href",s=_e(n[29]))},m(r,u){I(r,e,u),c(e,t),c(t,a)},p(r,u){u[0]&1&&l!==(l=r[29]+"")&&U(a,l),u[0]&1&&s!==(s=_e(r[29]))&&$(t,"href",s)},d(r){r&&i(e)}}}function We(n){let e,t="Note: ",l;return{c(){e=p("b"),e.textContent=t,l=x(`These relationships are designed to give you ideas, they
          are not designed to be exact matches or indicate coverage. They can be
          used to better understand the technologies, ask better questions, and
          develop test plans for your countermeasures.`)},l(a){e=v(a,"B",{"data-svelte-h":!0}),G(e)!=="svelte-gwu32y"&&(e.textContent=t),l=O(a,`These relationships are designed to give you ideas, they
          are not designed to be exact matches or indicate coverage. They can be
          used to better understand the technologies, ask better questions, and
          develop test plans for your countermeasures.`)},m(a,s){I(a,e,s),I(a,l,s)},p:Q,d(a){a&&(i(e),i(l))}}}function Ze(n){let e,t="select",l,a;return{c(){e=p("button"),e.textContent=t,this.h()},l(s){e=v(s,"BUTTON",{class:!0,"data-svelte-h":!0}),G(e)!=="svelte-3feg34"&&(e.textContent=t),this.h()},h(){$(e,"class","selector svelte-xumjr3")},m(s,r){I(s,e,r),l||(a=se(e,"click",n[9]),l=!0)},p:Q,d(s){s&&i(e),l=!1,a()}}}function et(n){let e,t="deselect",l,a;return{c(){e=p("button"),e.textContent=t,this.h()},l(s){e=v(s,"BUTTON",{class:!0,"data-svelte-h":!0}),G(e)!=="svelte-iey0zo"&&(e.textContent=t),this.h()},h(){$(e,"class","selector svelte-xumjr3")},m(s,r){I(s,e,r),l||(a=se(e,"click",n[8]),l=!0)},p:Q,d(s){s&&i(e),l=!1,a()}}}function tt(n){let e,t,l=n[28].message+"",a,s,r=console.log(n[28])+"",u;return{c(){e=p("p"),t=x("error with row: "),a=x(l),s=L(),u=x(r),this.h()},l(h){e=v(h,"P",{style:!0});var m=A(e);t=O(m,"error with row: "),a=O(m,l),m.forEach(i),s=M(h),u=O(h,r),this.h()},h(){pe(e,"color","red")},m(h,m){I(h,e,m),c(e,t),c(e,a),I(h,s,m),I(h,u,m)},p(h,m){m[0]&32&&l!==(l=h[28].message+"")&&U(a,l),m[0]&32&&r!==(r=console.log(h[28])+"")&&U(u,r)},d(h){h&&(i(e),i(s),i(u))}}}function lt(n){let e;function t(s,r){return s[24].description.graph[0]?rt:at}let l=t(n),a=l(n);return{c(){a.c(),e=oe()},l(s){a.l(s),e=oe()},m(s,r){a.m(s,r),I(s,e,r)},p(s,r){l===(l=t(s))&&a?a.p(s,r):(a.d(1),a=l(s),a&&(a.c(),a.m(e.parentNode,e)))},d(s){s&&i(e),a.d(s)}}}function at(n){let e,t,l=n[24].id+"",a,s,r,u,h="not found in D3FEND graph",m,y;return{c(){e=p("td"),t=p("a"),a=x(l),r=L(),u=p("td"),u.textContent=h,m=L(),y=p("td"),this.h()},l(k){e=v(k,"TD",{class:!0});var T=A(e);t=v(T,"A",{style:!0,href:!0});var D=A(t);a=O(D,l),D.forEach(i),T.forEach(i),r=M(k),u=v(k,"TD",{"data-svelte-h":!0}),G(u)!=="svelte-mgiypo"&&(u.textContent=h),m=M(k),y=v(k,"TD",{}),A(y).forEach(i),this.h()},h(){pe(t,"color","red"),$(t,"href",s=ke(n[24].id)),$(e,"class","text-center")},m(k,T){I(k,e,T),c(e,t),c(t,a),I(k,r,T),I(k,u,T),I(k,m,T),I(k,y,T)},p(k,T){T[0]&32&&l!==(l=k[24].id+"")&&U(a,l),T[0]&32&&s!==(s=ke(k[24].id))&&$(t,"href",s)},d(k){k&&(i(e),i(r),i(u),i(m),i(y))}}}function rt(n){let e,t,l=n[24].description.graph[0]["d3f:attack-id"]+"",a,s,r,u,h=n[24].description.graph[0]["rdfs:label"]+"",m,y,k,T,D,S='<th scope="col">off rel</th> <th scope="col">off artifact</th> <th scope="col">D3FEND Tactic</th> <th scope="col">D3FEND Technique</th> <th scope="col">def rel</th> <th scope="col">def artifact</th>',j,g=ie(Ne(n[24].off_to_def.results.bindings)),f=[];for(let _=0;_<g.length;_+=1)f[_]=$e(Te(n,g,_));let E=null;return g.length||(E=Ae()),{c(){e=p("th"),t=p("a"),a=x(l),r=L(),u=p("td"),m=x(h),y=L(),k=p("td"),T=p("table"),D=p("thead"),D.innerHTML=S,j=L();for(let _=0;_<f.length;_+=1)f[_].c();E&&E.c(),this.h()},l(_){e=v(_,"TH",{class:!0,scope:!0});var d=A(e);t=v(d,"A",{href:!0});var C=A(t);a=O(C,l),C.forEach(i),d.forEach(i),r=M(_),u=v(_,"TD",{});var w=A(u);m=O(w,h),w.forEach(i),y=M(_),k=v(_,"TD",{});var V=A(k);T=v(V,"TABLE",{class:!0});var q=A(T);D=v(q,"THEAD",{class:!0,"data-svelte-h":!0}),G(D)!=="svelte-hv82y0"&&(D.innerHTML=S),j=M(q);for(let B=0;B<f.length;B+=1)f[B].l(q);E&&E.l(q),q.forEach(i),V.forEach(i),this.h()},h(){$(t,"href",s=_e(n[24].id)),$(e,"class","text-center"),$(e,"scope","row"),$(D,"class","svelte-xumjr3"),be(D,"hide",n[4]),$(T,"class","table-auto w100 svelte-xumjr3")},m(_,d){I(_,e,d),c(e,t),c(t,a),I(_,r,d),I(_,u,d),c(u,m),I(_,y,d),I(_,k,d),c(k,T),c(T,D),c(T,j);for(let C=0;C<f.length;C+=1)f[C]&&f[C].m(T,null);E&&E.m(T,null)},p(_,d){if(d[0]&32&&l!==(l=_[24].description.graph[0]["d3f:attack-id"]+"")&&U(a,l),d[0]&32&&s!==(s=_e(_[24].id))&&$(t,"href",s),d[0]&32&&h!==(h=_[24].description.graph[0]["rdfs:label"]+"")&&U(m,h),d[0]&16&&be(D,"hide",_[4]),d[0]&32){g=ie(Ne(_[24].off_to_def.results.bindings));let C;for(C=0;C<g.length;C+=1){const w=Te(_,g,C);f[C]?f[C].p(w,d):(f[C]=$e(w),f[C].c(),f[C].m(T,null))}for(;C<f.length;C+=1)f[C].d(1);f.length=g.length,!g.length&&E?E.p(_,d):g.length?E&&(E.d(1),E=null):(E=Ae(),E.c(),E.m(T,null))}},d(_){_&&(i(e),i(r),i(u),i(y),i(k)),ve(f,_),E&&E.d()}}}function Ae(n){let e,t='no defensive relations <a href="/contribute">yet</a> ';return{c(){e=p("td"),e.innerHTML=t,this.h()},l(l){e=v(l,"TD",{colspan:!0,"data-svelte-h":!0}),G(e)!=="svelte-3z0dm2"&&(e.innerHTML=t),this.h()},h(){$(e,"colspan","5")},m(l,a){I(l,e,a)},p:Q,d(l){l&&i(e)}}}function ye(n){let e,t,l=n[25].off_artifact_rel_label.value+"",a,s,r,u,h=n[25].off_artifact_label.value+"",m,y,k,T,D=n[25].def_tactic_label.value+"",S,j,g,f,E=n[25].def_tech_label.value+"",_,d,C,w,V=n[25].def_artifact_rel_label.value+"",q,B,J,H,X=n[25].def_artifact_label.value+"",Y,P,R;return{c(){e=p("tr"),t=p("td"),a=x(l),s=L(),r=p("td"),u=p("a"),m=x(h),k=L(),T=p("td"),S=x(D),j=L(),g=p("td"),f=p("a"),_=x(E),C=L(),w=p("td"),q=x(V),B=L(),J=p("td"),H=p("a"),Y=x(X),R=L(),this.h()},l(b){e=v(b,"TR",{});var o=A(e);t=v(o,"TD",{});var N=A(t);a=O(N,l),N.forEach(i),s=M(o),r=v(o,"TD",{});var F=A(r);u=v(F,"A",{href:!0});var z=A(u);m=O(z,h),z.forEach(i),F.forEach(i),k=M(o),T=v(o,"TD",{});var K=A(T);S=O(K,D),K.forEach(i),j=M(o),g=v(o,"TD",{});var ee=A(g);f=v(ee,"A",{href:!0});var te=A(f);_=O(te,E),te.forEach(i),ee.forEach(i),C=M(o),w=v(o,"TD",{});var le=A(w);q=O(le,V),le.forEach(i),B=M(o),J=v(o,"TD",{});var ae=A(J);H=v(ae,"A",{href:!0});var re=A(H);Y=O(re,X),re.forEach(i),ae.forEach(i),R=M(o),o.forEach(i),this.h()},h(){$(u,"href",y="/dao/artifact/"+ne(n[25].off_artifact.value)),$(f,"href",d="/technique/"+ne(n[25].def_tech.value)),$(H,"href",P="/dao/artifact/"+ne(n[25].def_artifact.value))},m(b,o){I(b,e,o),c(e,t),c(t,a),c(e,s),c(e,r),c(r,u),c(u,m),c(e,k),c(e,T),c(T,S),c(e,j),c(e,g),c(g,f),c(f,_),c(e,C),c(e,w),c(w,q),c(e,B),c(e,J),c(J,H),c(H,Y),c(e,R)},p(b,o){o[0]&32&&l!==(l=b[25].off_artifact_rel_label.value+"")&&U(a,l),o[0]&32&&h!==(h=b[25].off_artifact_label.value+"")&&U(m,h),o[0]&32&&y!==(y="/dao/artifact/"+ne(b[25].off_artifact.value))&&$(u,"href",y),o[0]&32&&D!==(D=b[25].def_tactic_label.value+"")&&U(S,D),o[0]&32&&E!==(E=b[25].def_tech_label.value+"")&&U(_,E),o[0]&32&&d!==(d="/technique/"+ne(b[25].def_tech.value))&&$(f,"href",d),o[0]&32&&V!==(V=b[25].def_artifact_rel_label.value+"")&&U(q,V),o[0]&32&&X!==(X=b[25].def_artifact_label.value+"")&&U(Y,X),o[0]&32&&P!==(P="/dao/artifact/"+ne(b[25].def_artifact.value))&&$(H,"href",P)},d(b){b&&i(e)}}}function $e(n){let e,t=n[25].def_tech&&ye(n);return{c(){t&&t.c(),e=oe()},l(l){t&&t.l(l),e=oe()},m(l,a){t&&t.m(l,a),I(l,e,a)},p(l,a){l[25].def_tech?t?t.p(l,a):(t=ye(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&i(e),t&&t.d(l)}}}function nt(n){let e;return{c(){e=x("loading...")},l(t){e=O(t,"loading...")},m(t,l){I(t,e,l)},p:Q,d(t){t&&i(e)}}}function Ie(n){let e,t,l,a={ctx:n,current:null,token:null,hasCatch:!0,pending:nt,then:lt,catch:tt,value:24,error:28};return de(t=n[21],a),{c(){e=p("tr"),a.block.c(),l=L()},l(s){e=v(s,"TR",{});var r=A(e);a.block.l(r),l=M(r),r.forEach(i)},m(s,r){I(s,e,r),a.block.m(e,a.anchor=null),a.mount=()=>e,a.anchor=l,c(e,l)},p(s,r){n=s,a.ctx=n,r[0]&32&&t!==(t=n[21])&&de(t,a)||qe(a,n,r)},d(s){s&&i(e),a.block.d(),a.token=null,a=null}}}function st(n){let e;return{c(){e=x("enter text and click go")},l(t){e=O(t,"enter text and click go")},m(t,l){I(t,e,l)},p:Q,i:Q,o:Q,d(t){t&&i(e)}}}function ot(n){let e,t,l,a,s,r,u,h="ATT&CK Extractor",m,y,k=`Extracts ATT&amp;CK techniques from blobs of text and recommends potential
      D3FEND countermeasures. You may also want to try the <a href="/tools/d3fend-extractor">D3FEND Extractor</a>
      or the <a href="/tools/artifact-extractor">Artifact Extractor.</a>`,T,D,S="<i>Paste any text containing ATT&amp;CK IDs:</i>",j,g,f,E,_,d,C="GO",w,V,q,B,J,H,X,Y,P;e=new Ke({props:{title:"ATT&CK Extractor | Tools | "}}),a=new Fe({});let R={ctx:n,current:null,token:null,hasCatch:!0,pending:st,then:Xe,catch:Je,value:20,error:28,blocks:[,,,]};return de(H=n[5],R),{c(){fe(e.$$.fragment),t=L(),l=p("section"),fe(a.$$.fragment),s=L(),r=p("div"),u=p("h1"),u.textContent=h,m=L(),y=p("p"),y.innerHTML=k,T=L(),D=p("p"),D.innerHTML=S,j=L(),g=p("div"),f=p("textarea"),E=L(),_=p("div"),d=p("button"),d.textContent=C,w=L(),V=p("br"),q=L(),B=p("br"),J=L(),R.block.c(),this.h()},l(b){ce(e.$$.fragment,b),t=M(b),l=v(b,"SECTION",{class:!0});var o=A(l);ce(a.$$.fragment,o),s=M(o),r=v(o,"DIV",{class:!0});var N=A(r);u=v(N,"H1",{"data-svelte-h":!0}),G(u)!=="svelte-of1ivt"&&(u.textContent=h),m=M(N),y=v(N,"P",{"data-svelte-h":!0}),G(y)!=="svelte-12tzzip"&&(y.innerHTML=k),T=M(N),D=v(N,"P",{class:!0,"data-svelte-h":!0}),G(D)!=="svelte-10wdblh"&&(D.innerHTML=S),j=M(N),g=v(N,"DIV",{});var F=A(g);f=v(F,"TEXTAREA",{class:!0}),A(f).forEach(i),F.forEach(i),E=M(N),_=v(N,"DIV",{});var z=A(_);d=v(z,"BUTTON",{class:!0,"data-svelte-h":!0}),G(d)!=="svelte-88k995"&&(d.textContent=C),z.forEach(i),w=M(N),V=v(N,"BR",{}),N.forEach(i),q=M(o),B=v(o,"BR",{}),J=M(o),R.block.l(o),o.forEach(i),this.h()},h(){$(D,"class","text-2"),$(f,"class","svelte-xumjr3"),$(d,"class","button"),$(r,"class","card"),$(l,"class"," svelte-xumjr3")},m(b,o){ue(e,b,o),I(b,t,o),I(b,l,o),ue(a,l,null),c(l,s),c(l,r),c(r,u),c(r,m),c(r,y),c(r,T),c(r,D),c(r,j),c(r,g),c(g,f),me(f,n[1]),c(r,E),c(r,_),c(_,d),c(r,w),c(r,V),c(l,q),c(l,B),c(l,J),R.block.m(l,R.anchor=null),R.mount=()=>l,R.anchor=null,X=!0,Y||(P=[se(f,"input",n[12]),se(f,"keypress",n[10]),se(d,"click",n[7])],Y=!0)},p(b,o){n=b,o[0]&2&&me(f,n[1]),R.ctx=n,o[0]&32&&H!==(H=n[5])&&de(H,R)||qe(R,n,o)},i(b){X||(W(e.$$.fragment,b),W(a.$$.fragment,b),W(R.block),X=!0)},o(b){Z(e.$$.fragment,b),Z(a.$$.fragment,b);for(let o=0;o<3;o+=1){const N=R.blocks[o];Z(N)}X=!1},d(b){b&&(i(t),i(l)),he(e,b),he(a),R.block.d(),R.token=null,R=null,Y=!1,Se(P)}}}function it(){document.execCommand("copy")}function Ne(n){let e=new Set,t=[];return n.forEach(function(l){l.hasOwnProperty("def_tech_label")&&(e.has(l.def_tech_label.value)||(e.add(l.def_tech_label.value),t.push(l)))}),t}function ft(n,e,t){let l;Re(n,Ue,w=>t(6,l=w));let{data:a}=e;const s=new ge(a.techniques,{index:!0,index_key:"d3f:attack-id"});let r,u="",h=!1,m=!0,y,k=[];function T(){t(0,r=[]),t(2,h=!1),t(3,m=!0),k=[]}y=l.url.searchParams.get("q");let D=!1;async function S(w){let V="/api/offensive-technique/attack/"+w+".json";const q=await fetch(V);if(q.status==404)return{id:w,off_to_def:[],description:{graph:[]},status:q.status};if(q.ok){const B=await q.json();return{id:w,off_to_def:B.off_to_def,description:new ge(B.description)}}else throw console.log(`Error processing ${w}, response status: ${q.status}`),console.dir(q),new Error(`Error processing ${w}, response status: ${q.status}`)}async function j(){return T(),t(0,r=Array.from(new Set(Pe(u,s)))),r?(r.forEach(function(w){let V;V=S(w),V&&k.push(V)}),l.url.searchParams.set("q",JSON.stringify(r)),history.replaceState(null,"mapping",l.url)):(T(),console.debug("no matches")),k}let g=j();function f(){t(5,g=j()),t(3,m=!1)}function E(){window.getSelection().removeAllRanges(),t(2,h=!1),t(4,D=!1)}function _(){t(4,D=!0);let w="mappings";const V=window.getSelection();V.removeAllRanges();let q=document.getElementById(w);const B=document.createRange();B.selectNodeContents(q),V.addRange(B),t(2,h=!0)}function d(w){w.ctrlKey==!0&&w.keyCode==13&&f()}Be(async()=>{y?(t(1,u=y),console.log("handlingclick"),f()):(console.log("starting blank"),t(1,u=""))});function C(){u=this.value,t(1,u)}return n.$$set=w=>{"data"in w&&t(11,a=w.data)},[r,u,h,m,D,g,l,f,E,_,d,a,C]}class Tt extends xe{constructor(e){super(),Oe(this,e,ft,ot,Ve,{data:11},null,[-1,-1])}}export{Tt as component,Et as universal};
