import{S as wt,i as Nt,s as At,a7 as mt,w as rt,k as S,e as _,t as I,x as at,m as V,c as d,a as m,h as q,d as c,b as w,y as lt,g as C,I as o,a1 as vt,N as et,a8 as It,q as O,o as R,B as st,Y as qt,R as Ft,v as Tt,f as $t,j as ot,E as G,l as Et,n as yt,p as xt,X as St}from"../../chunks/index-a02da30e.js";import{H as Vt}from"../../chunks/Header-47fd749a.js";import{T as Ct}from"../../chunks/Title-1d23c88f.js";/* empty css                                                       */import{e as Pt,S as jt}from"../../chunks/extract-26c878fb.js";import{G as gt}from"../../chunks/lib-88dd6a45.js";import{p as Bt}from"../../chunks/stores-cf129ad8.js";import"../../chunks/stores-59d8ae96.js";import"../../chunks/index-98a102c4.js";import"../../chunks/marked.esm-8ab30116.js";function bt(i,e,r){const t=i.slice();return t[19]=e[r],t}function Ot(i){let e,r=i[22].message+"",t;return{c(){e=_("p"),t=I(r),this.h()},l(a){e=d(a,"P",{style:!0});var n=m(e);t=q(n,r),n.forEach(c),this.h()},h(){$t(e,"color","red")},m(a,n){C(a,e,n),o(e,t)},p(a,n){n&8&&r!==(r=a[22].message+"")&&ot(t,r)},i:G,o:G,d(a){a&&c(e)}}}function Rt(i){let e,r,t,a;const n=[Kt,Gt],s=[];function f(u,g){return u[18].length>0?0:!u[2]&&u[18].length<1?1:-1}return~(e=f(i))&&(r=s[e]=n[e](i)),{c(){r&&r.c(),t=Et()},l(u){r&&r.l(u),t=Et()},m(u,g){~e&&s[e].m(u,g),C(u,t,g),a=!0},p(u,g){let b=e;e=f(u),e===b?~e&&s[e].p(u,g):(r&&(yt(),R(s[b],1,1,()=>{s[b]=null}),xt()),~e?(r=s[e],r?r.p(u,g):(r=s[e]=n[e](u),r.c()),O(r,1),r.m(t.parentNode,t)):r=null)},i(u){a||(O(r),a=!0)},o(u){R(r),a=!1},d(u){~e&&s[e].d(u),u&&c(t)}}}function Gt(i){let e,r;return{c(){e=_("div"),r=I("No D3FEND Artifacts found in text."),this.h()},l(t){e=d(t,"DIV",{class:!0});var a=m(e);r=q(a,"No D3FEND Artifacts found in text."),a.forEach(c),this.h()},h(){w(e,"class","card")},m(t,a){C(t,e,a),o(e,r)},p:G,i:G,o:G,d(t){t&&c(e)}}}function Kt(i){let e,r,t=i[0]&&kt(i);return{c(){e=_("div"),t&&t.c(),this.h()},l(a){e=d(a,"DIV",{class:!0});var n=m(e);t&&t.l(n),n.forEach(c),this.h()},h(){w(e,"class","card")},m(a,n){C(a,e,n),t&&t.m(e,null),r=!0},p(a,n){a[0]?t?(t.p(a,n),n&1&&O(t,1)):(t=kt(a),t.c(),O(t,1),t.m(e,null)):t&&(yt(),R(t,1,1,()=>{t=null}),xt())},i(a){r||(O(t),r=!0)},o(a){R(t),r=!1},d(a){a&&c(e),t&&t.d()}}}function kt(i){let e,r,t,a,n,s,f,u,g=i[0].length+"",b,B,F,N,T;t=new jt({props:{url:i[4].url}});let y=i[0],v=[];for(let l=0;l<y.length;l+=1)v[l]=Dt(bt(i,y,l));return{c(){e=_("div"),r=_("div"),rt(t.$$.fragment),a=S(),n=_("div"),s=_("b"),f=_("i"),u=I("Extracted "),b=I(g),B=I(" unique IDs:"),F=S(),N=_("dl");for(let l=0;l<v.length;l+=1)v[l].c();this.h()},l(l){e=d(l,"DIV",{class:!0});var E=m(e);r=d(E,"DIV",{class:!0});var p=m(r);at(t.$$.fragment,p),p.forEach(c),E.forEach(c),a=V(l),n=d(l,"DIV",{class:!0});var h=m(n);s=d(h,"B",{});var P=m(s);f=d(P,"I",{});var j=m(f);u=q(j,"Extracted "),b=q(j,g),B=q(j," unique IDs:"),j.forEach(c),P.forEach(c),F=V(h),N=d(h,"DL",{class:!0});var $=m(N);for(let K=0;K<v.length;K+=1)v[K].l($);$.forEach(c),h.forEach(c),this.h()},h(){w(r,"class","text-right"),w(e,"class","stretch"),w(N,"class","flex flex-wrap svelte-pega28"),w(n,"class","")},m(l,E){C(l,e,E),o(e,r),lt(t,r,null),C(l,a,E),C(l,n,E),o(n,s),o(s,f),o(f,u),o(f,b),o(f,B),o(n,F),o(n,N);for(let p=0;p<v.length;p+=1)v[p].m(N,null);T=!0},p(l,E){const p={};if(E&16&&(p.url=l[4].url),t.$set(p),(!T||E&1)&&g!==(g=l[0].length+"")&&ot(b,g),E&1){y=l[0];let h;for(h=0;h<y.length;h+=1){const P=bt(l,y,h);v[h]?v[h].p(P,E):(v[h]=Dt(P),v[h].c(),v[h].m(N,null))}for(;h<v.length;h+=1)v[h].d(1);v.length=y.length}},i(l){T||(O(t.$$.fragment,l),T=!0)},o(l){R(t.$$.fragment,l),T=!1},d(l){l&&c(e),st(t),l&&c(a),l&&c(n),St(v,l)}}}function Dt(i){let e,r,t=i[19]+"",a,n;return{c(){e=_("dd"),r=_("a"),a=I(t),this.h()},l(s){e=d(s,"DD",{});var f=m(e);r=d(f,"A",{href:!0});var u=m(r);a=q(u,t),u.forEach(c),f.forEach(c),this.h()},h(){w(r,"href",n="/dao/artifact/"+i[19])},m(s,f){C(s,e,f),o(e,r),o(r,a)},p(s,f){f&1&&t!==(t=s[19]+"")&&ot(a,t),f&1&&n!==(n="/dao/artifact/"+s[19])&&w(r,"href",n)},d(s){s&&c(e)}}}function Ht(i){let e;return{c(){e=I("enter text and click go")},l(r){e=q(r,"enter text and click go")},m(r,t){C(r,e,t)},p:G,i:G,o:G,d(r){r&&c(e)}}}function Yt(i){let e,r,t,a,n,s,f,u,g,b,B,F,N,T,y,v,l,E,p,h,P,j,$,K,Y,H,J,M,z,Q,W,Z,U,X,tt,nt;e=new Ct({props:{title:"D3FEND Artifact Extractor | Tools | "}}),a=new Vt({});let x={ctx:i,current:null,token:null,hasCatch:!0,pending:Ht,then:Rt,catch:Ot,value:18,error:22,blocks:[,,,]};return mt(U=i[3],x),{c(){rt(e.$$.fragment),r=S(),t=_("section"),rt(a.$$.fragment),n=S(),s=_("div"),f=_("h1"),u=I("D3FEND Artifact Extractor"),g=S(),b=_("p"),B=I("Extracts D3FEND artifacts from blobs of text. You may also want to try the "),F=_("a"),N=I("D3FEND Extractor"),T=I(" or "),y=_("a"),v=I("ATT&CK Extractor."),l=S(),E=_("p"),p=_("i"),h=I("Paste any text containing D3FEND Artifacts:"),P=S(),j=_("div"),$=_("textarea"),K=S(),Y=_("div"),H=_("button"),J=I("GO"),M=S(),z=_("br"),Q=S(),W=_("br"),Z=S(),x.block.c(),this.h()},l(D){at(e.$$.fragment,D),r=V(D),t=d(D,"SECTION",{class:!0});var k=m(t);at(a.$$.fragment,k),n=V(k),s=d(k,"DIV",{class:!0});var A=m(s);f=d(A,"H1",{});var it=m(f);u=q(it,"D3FEND Artifact Extractor"),it.forEach(c),g=V(A),b=d(A,"P",{});var L=m(b);B=q(L,"Extracts D3FEND artifacts from blobs of text. You may also want to try the "),F=d(L,"A",{href:!0});var ct=m(F);N=q(ct,"D3FEND Extractor"),ct.forEach(c),T=q(L," or "),y=d(L,"A",{href:!0});var ft=m(y);v=q(ft,"ATT&CK Extractor."),ft.forEach(c),L.forEach(c),l=V(A),E=d(A,"P",{class:!0});var ut=m(E);p=d(ut,"I",{});var ht=m(p);h=q(ht,"Paste any text containing D3FEND Artifacts:"),ht.forEach(c),ut.forEach(c),P=V(A),j=d(A,"DIV",{});var _t=m(j);$=d(_t,"TEXTAREA",{class:!0}),m($).forEach(c),_t.forEach(c),K=V(A),Y=d(A,"DIV",{});var dt=m(Y);H=d(dt,"BUTTON",{class:!0});var pt=m(H);J=q(pt,"GO"),pt.forEach(c),dt.forEach(c),M=V(A),z=d(A,"BR",{}),A.forEach(c),Q=V(k),W=d(k,"BR",{}),Z=V(k),x.block.l(k),k.forEach(c),this.h()},h(){w(F,"href","/tools/d3fend-extractor"),w(y,"href","/tools/attack-extractor"),w(E,"class","text-2"),w($,"class","svelte-pega28"),w(H,"class","button"),w(s,"class","card"),w(t,"class"," svelte-pega28")},m(D,k){lt(e,D,k),C(D,r,k),C(D,t,k),lt(a,t,null),o(t,n),o(t,s),o(s,f),o(f,u),o(s,g),o(s,b),o(b,B),o(b,F),o(F,N),o(b,T),o(b,y),o(y,v),o(s,l),o(s,E),o(E,p),o(p,h),o(s,P),o(s,j),o(j,$),vt($,i[1]),o(s,K),o(s,Y),o(Y,H),o(H,J),o(s,M),o(s,z),o(t,Q),o(t,W),o(t,Z),x.block.m(t,x.anchor=null),x.mount=()=>t,x.anchor=null,X=!0,tt||(nt=[et($,"input",i[8]),et($,"keypress",i[6]),et(H,"click",i[5])],tt=!0)},p(D,[k]){i=D,k&2&&vt($,i[1]),x.ctx=i,k&8&&U!==(U=i[3])&&mt(U,x)||It(x,i,k)},i(D){X||(O(e.$$.fragment,D),O(a.$$.fragment,D),O(x.block),X=!0)},o(D){R(e.$$.fragment,D),R(a.$$.fragment,D);for(let k=0;k<3;k+=1){const A=x.blocks[k];R(A)}X=!1},d(D){st(e,D),D&&c(r),D&&c(t),st(a),x.block.d(),x.token=null,x=null,tt=!1,qt(nt)}}}async function re({params:i,fetch:e}){i.technique;const r=await e("/api/dao/artifacts.json"),t=await r.json();return r.status===200?{props:{techniques:t}}:{status:r.status,error:new Error(t.message)}}function Lt(i,e,r){let t;Ft(i,Bt,l=>r(4,t=l));let{techniques:a}=e,n=new gt(a,{index:!0,index_key:"d3f:d3fend-id"}),s,f="",u=!0,g;g=t.url.searchParams.get("q"),console.log("Found params: "+g);let b=[];async function B(l){let E="/api/dao/artifact/"+l+".json";const p=await fetch(E);if(p.status==404)return{id:l,def_to_off:[],description:{graph:[]},status:p.status};if(p.ok){const h=await p.json();return{id:l,def_to_off:h.def_to_off,description:new gt(h.description)}}else throw new Error(f)}async function F(){let l=r(0,s=Array.from(new Set(Pt(f,n))));return l&&(l.forEach(function(E){let p;p=B(E),p&&b.push(p)}),t.url.searchParams.set("q",JSON.stringify(l)),history.replaceState(null,"mapping",t.url)),b}let N=F();function T(){r(3,N=F()),r(2,u=!1)}function y(l){l.ctrlKey==!0&&l.keyCode==13&&T()}Tt(async()=>{g?(r(1,f=g),console.log("handlingclick"),T()):(console.log("starting blank"),r(1,f=""))});function v(){f=this.value,r(1,f)}return i.$$set=l=>{"techniques"in l&&r(7,a=l.techniques)},[s,f,u,N,t,T,y,a,v]}class ae extends wt{constructor(e){super(),Nt(this,e,Lt,Yt,At,{techniques:7})}}export{ae as default,re as load};
