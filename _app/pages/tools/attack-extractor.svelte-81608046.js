import{S as Qe,i as We,s as Ze,a7 as Te,w as pe,k as C,e as f,t as I,x as ve,m as $,c as i,a as u,h as N,d as s,b as g,y as me,g as V,I as r,a1 as Ve,N as ue,a8 as Me,q as oe,o as ne,B as be,Y as xe,R as et,v as tt,f as Ae,j as se,E as ae,l as he,n as Ye,p as Xe,X as Ie,V as Ke}from"../../chunks/index-a02da30e.js";import{a as lt,S as Je}from"../../chunks/extract-26c878fb.js";import{G as Re,d as De,f as He,e as ie}from"../../chunks/lib-88dd6a45.js";import{T as at}from"../../chunks/Title-1d23c88f.js";import{H as rt}from"../../chunks/Header-47fd749a.js";import{A as st}from"../../chunks/Alert-12c40fb9.js";import{p as ot}from"../../chunks/stores-cf129ad8.js";import"../../chunks/marked.esm-8ab30116.js";import"../../chunks/stores-59d8ae96.js";import"../../chunks/index-98a102c4.js";/* empty css                                                       */function Be(c,e,t){const l=c.slice();return l[21]=e[t],l}function Fe(c,e,t){const l=c.slice();return l[25]=e[t],l}function Se(c,e,t){const l=c.slice();return l[29]=e[t],l}function nt(c){let e,t=c[28].message+"",l;return{c(){e=f("p"),l=I(t),this.h()},l(a){e=i(a,"P",{style:!0});var n=u(e);l=N(n,t),n.forEach(s),this.h()},h(){Ae(e,"color","red")},m(a,n){V(a,e,n),r(e,l)},p(a,n){n[0]&32&&t!==(t=a[28].message+"")&&se(l,t)},i:ae,o:ae,d(a){a&&s(e)}}}function ct(c){let e,t,l,a;const n=[it,ft],o=[];function h(d,T){return d[20].length>0?0:!d[3]&&d[20].length<1?1:-1}return~(e=h(c))&&(t=o[e]=n[e](c)),{c(){t&&t.c(),l=he()},l(d){t&&t.l(d),l=he()},m(d,T){~e&&o[e].m(d,T),V(d,l,T),a=!0},p(d,T){let w=e;e=h(d),e===w?~e&&o[e].p(d,T):(t&&(Ye(),ne(o[w],1,1,()=>{o[w]=null}),Xe()),~e?(t=o[e],t?t.p(d,T):(t=o[e]=n[e](d),t.c()),oe(t,1),t.m(l.parentNode,l)):t=null)},i(d){a||(oe(t),a=!0)},o(d){ne(t),a=!1},d(d){~e&&o[e].d(d),d&&s(l)}}}function ft(c){let e,t;return{c(){e=f("div"),t=I("No ATT&CK techniques found in text."),this.h()},l(l){e=i(l,"DIV",{class:!0});var a=u(e);t=N(a,"No ATT&CK techniques found in text."),a.forEach(s),this.h()},h(){g(e,"class","card")},m(l,a){V(l,e,a),r(e,t)},p:ae,i:ae,o:ae,d(l){l&&s(e)}}}function it(c){let e,t,l,a,n,o,h,d,T,w,m,b,E,S,P,A,_,K,F,y,W,v,D,R,Y,X,ee,M,q,z,G,k,j,O,le,U=c[0]&&Oe(c);a=new st({props:{$$slots:{default:[ut]},$$scope:{ctx:c}}}),T=new Je({props:{url:c[6].url}});function L(p,Q){return p[2]?dt:ht}let H=L(c),B=H(c),J=c[20],Z=[];for(let p=0;p<J.length;p+=1)Z[p]=Ge(Be(c,J,p));return{c(){e=f("div"),U&&U.c(),t=C(),l=f("div"),pe(a.$$.fragment),n=C(),o=f("div"),h=f("div"),d=f("div"),pe(T.$$.fragment),w=C(),m=f("div"),b=f("b"),E=f("i"),S=I("Mapping Results:"),P=C(),A=f("div"),_=f("div"),B.c(),K=C(),F=f("button"),y=I("copy"),W=C(),v=f("table"),D=f("thead"),R=f("th"),Y=I("ATT&CK ID"),X=C(),ee=f("th"),M=I("ATT&CK Name"),q=C(),z=f("th"),G=I("Related D3FEND Techniques"),k=C();for(let p=0;p<Z.length;p+=1)Z[p].c();this.h()},l(p){e=i(p,"DIV",{class:!0});var Q=u(e);U&&U.l(Q),Q.forEach(s),t=$(p),l=i(p,"DIV",{class:!0});var te=u(l);ve(a.$$.fragment,te),te.forEach(s),n=$(p),o=i(p,"DIV",{class:!0});var re=u(o);h=i(re,"DIV",{class:!0});var x=u(h);d=i(x,"DIV",{class:!0});var ce=u(d);ve(T.$$.fragment,ce),ce.forEach(s),x.forEach(s),w=$(re),m=i(re,"DIV",{});var de=u(m);b=i(de,"B",{});var _e=u(b);E=i(_e,"I",{});var Ne=u(E);S=N(Ne,"Mapping Results:"),Ne.forEach(s),_e.forEach(s),de.forEach(s),P=$(re),A=i(re,"DIV",{class:!0});var Ee=u(A);_=i(Ee,"DIV",{class:!0});var ge=u(_);B.l(ge),K=$(ge),F=i(ge,"BUTTON",{});var qe=u(F);y=N(qe,"copy"),qe.forEach(s),ge.forEach(s),W=$(Ee),v=i(Ee,"TABLE",{id:!0,class:!0});var ke=u(v);D=i(ke,"THEAD",{});var fe=u(D);R=i(fe,"TH",{class:!0});var ye=u(R);Y=N(ye,"ATT&CK ID"),ye.forEach(s),X=$(fe),ee=i(fe,"TH",{});var Ce=u(ee);M=N(Ce,"ATT&CK Name"),Ce.forEach(s),q=$(fe),z=i(fe,"TH",{});var $e=u(z);G=N($e,"Related D3FEND Techniques"),$e.forEach(s),fe.forEach(s),k=$(ke);for(let we=0;we<Z.length;we+=1)Z[we].l(ke);ke.forEach(s),Ee.forEach(s),re.forEach(s),this.h()},h(){g(e,"class","card"),g(l,"class","card"),g(d,"class","text-right"),g(h,"class","stretch"),g(_,"class","text-right"),g(R,"class","stretch"),g(v,"id","mappings"),g(v,"class","table-auto"),g(A,"class","results-wrap center svelte-1wbelz3"),g(o,"class","card")},m(p,Q){V(p,e,Q),U&&U.m(e,null),V(p,t,Q),V(p,l,Q),me(a,l,null),V(p,n,Q),V(p,o,Q),r(o,h),r(h,d),me(T,d,null),r(o,w),r(o,m),r(m,b),r(b,E),r(E,S),r(o,P),r(o,A),r(A,_),B.m(_,null),r(_,K),r(_,F),r(F,y),r(A,W),r(A,v),r(v,D),r(D,R),r(R,Y),r(D,X),r(D,ee),r(ee,M),r(D,q),r(D,z),r(z,G),r(v,k);for(let te=0;te<Z.length;te+=1)Z[te].m(v,null);j=!0,O||(le=ue(F,"click",kt),O=!0)},p(p,Q){p[0]?U?(U.p(p,Q),Q[0]&1&&oe(U,1)):(U=Oe(p),U.c(),oe(U,1),U.m(e,null)):U&&(Ye(),ne(U,1,1,()=>{U=null}),Xe());const te={};Q[1]&2&&(te.$$scope={dirty:Q,ctx:p}),a.$set(te);const re={};if(Q[0]&64&&(re.url=p[6].url),T.$set(re),H===(H=L(p))&&B?B.p(p,Q):(B.d(1),B=H(p),B&&(B.c(),B.m(_,K))),Q[0]&48){J=p[20];let x;for(x=0;x<J.length;x+=1){const ce=Be(p,J,x);Z[x]?Z[x].p(ce,Q):(Z[x]=Ge(ce),Z[x].c(),Z[x].m(v,null))}for(;x<Z.length;x+=1)Z[x].d(1);Z.length=J.length}},i(p){j||(oe(U),oe(a.$$.fragment,p),oe(T.$$.fragment,p),j=!0)},o(p){ne(U),ne(a.$$.fragment,p),ne(T.$$.fragment,p),j=!1},d(p){p&&s(e),U&&U.d(),p&&s(t),p&&s(l),be(a),p&&s(n),p&&s(o),be(T),B.d(),Ie(Z,p),O=!1,le()}}}function Oe(c){let e,t,l,a,n,o,h,d,T=c[0].length+"",w,m,b,E,S;l=new Je({props:{url:c[6].url}});let P=c[0],A=[];for(let _=0;_<P.length;_+=1)A[_]=Pe(Se(c,P,_));return{c(){e=f("div"),t=f("div"),pe(l.$$.fragment),a=C(),n=f("div"),o=f("b"),h=f("i"),d=I("Extracted "),w=I(T),m=I(" unique IDs:"),b=C(),E=f("dl");for(let _=0;_<A.length;_+=1)A[_].c();this.h()},l(_){e=i(_,"DIV",{class:!0});var K=u(e);t=i(K,"DIV",{class:!0});var F=u(t);ve(l.$$.fragment,F),F.forEach(s),K.forEach(s),a=$(_),n=i(_,"DIV",{class:!0});var y=u(n);o=i(y,"B",{});var W=u(o);h=i(W,"I",{});var v=u(h);d=N(v,"Extracted "),w=N(v,T),m=N(v," unique IDs:"),v.forEach(s),W.forEach(s),b=$(y),E=i(y,"DL",{class:!0});var D=u(E);for(let R=0;R<A.length;R+=1)A[R].l(D);D.forEach(s),y.forEach(s),this.h()},h(){g(t,"class","text-right"),g(e,"class","stretch"),g(E,"class","flex flex-wrap svelte-1wbelz3"),g(n,"class","")},m(_,K){V(_,e,K),r(e,t),me(l,t,null),V(_,a,K),V(_,n,K),r(n,o),r(o,h),r(h,d),r(h,w),r(h,m),r(n,b),r(n,E);for(let F=0;F<A.length;F+=1)A[F].m(E,null);S=!0},p(_,K){const F={};if(K[0]&64&&(F.url=_[6].url),l.$set(F),(!S||K[0]&1)&&T!==(T=_[0].length+"")&&se(w,T),K[0]&1){P=_[0];let y;for(y=0;y<P.length;y+=1){const W=Se(_,P,y);A[y]?A[y].p(W,K):(A[y]=Pe(W),A[y].c(),A[y].m(E,null))}for(;y<A.length;y+=1)A[y].d(1);A.length=P.length}},i(_){S||(oe(l.$$.fragment,_),S=!0)},o(_){ne(l.$$.fragment,_),S=!1},d(_){_&&s(e),be(l),_&&s(a),_&&s(n),Ie(A,_)}}}function Pe(c){let e,t,l=c[29]+"",a,n;return{c(){e=f("dd"),t=f("a"),a=I(l),this.h()},l(o){e=i(o,"DD",{});var h=u(e);t=i(h,"A",{href:!0});var d=u(t);a=N(d,l),d.forEach(s),h.forEach(s),this.h()},h(){g(t,"href",n=De(c[29]))},m(o,h){V(o,e,h),r(e,t),r(t,a)},p(o,h){h[0]&1&&l!==(l=o[29]+"")&&se(a,l),h[0]&1&&n!==(n=De(o[29]))&&g(t,"href",n)},d(o){o&&s(e)}}}function ut(c){let e,t,l;return{c(){e=f("b"),t=I("Note: "),l=I("These relationships are designed to give you ideas, they are not designed to be exact matches or indicate coverage. They can be used to better understand the technologies, ask better questions, and develop test plans for your countermeasures.")},l(a){e=i(a,"B",{});var n=u(e);t=N(n,"Note: "),n.forEach(s),l=N(a,"These relationships are designed to give you ideas, they are not designed to be exact matches or indicate coverage. They can be used to better understand the technologies, ask better questions, and develop test plans for your countermeasures.")},m(a,n){V(a,e,n),r(e,t),V(a,l,n)},p:ae,d(a){a&&s(e),a&&s(l)}}}function ht(c){let e,t,l,a;return{c(){e=f("button"),t=I("select"),this.h()},l(n){e=i(n,"BUTTON",{class:!0});var o=u(e);t=N(o,"select"),o.forEach(s),this.h()},h(){g(e,"class","selector svelte-1wbelz3")},m(n,o){V(n,e,o),r(e,t),l||(a=ue(e,"click",c[9]),l=!0)},p:ae,d(n){n&&s(e),l=!1,a()}}}function dt(c){let e,t,l,a;return{c(){e=f("button"),t=I("deselect"),this.h()},l(n){e=i(n,"BUTTON",{class:!0});var o=u(e);t=N(o,"deselect"),o.forEach(s),this.h()},h(){g(e,"class","selector svelte-1wbelz3")},m(n,o){V(n,e,o),r(e,t),l||(a=ue(e,"click",c[8]),l=!0)},p:ae,d(n){n&&s(e),l=!1,a()}}}function _t(c){let e,t=c[28].message+"",l;return{c(){e=f("p"),l=I(t),this.h()},l(a){e=i(a,"P",{style:!0});var n=u(e);l=N(n,t),n.forEach(s),this.h()},h(){Ae(e,"color","red")},m(a,n){V(a,e,n),r(e,l)},p(a,n){n[0]&32&&t!==(t=a[28].message+"")&&se(l,t)},d(a){a&&s(e)}}}function pt(c){let e;function t(n,o){return n[24].description.graph[0]?mt:vt}let l=t(c),a=l(c);return{c(){a.c(),e=he()},l(n){a.l(n),e=he()},m(n,o){a.m(n,o),V(n,e,o)},p(n,o){l===(l=t(n))&&a?a.p(n,o):(a.d(1),a=l(n),a&&(a.c(),a.m(e.parentNode,e)))},d(n){a.d(n),n&&s(e)}}}function vt(c){let e,t,l=c[24].id+"",a,n,o,h,d,T,w;return{c(){e=f("td"),t=f("a"),a=I(l),o=C(),h=f("td"),d=I("not found in D3FEND graph"),T=C(),w=f("td"),this.h()},l(m){e=i(m,"TD",{class:!0});var b=u(e);t=i(b,"A",{style:!0,href:!0});var E=u(t);a=N(E,l),E.forEach(s),b.forEach(s),o=$(m),h=i(m,"TD",{});var S=u(h);d=N(S,"not found in D3FEND graph"),S.forEach(s),T=$(m),w=i(m,"TD",{}),u(w).forEach(s),this.h()},h(){Ae(t,"color","red"),g(t,"href",n=He(c[24].id)),g(e,"class","text-center")},m(m,b){V(m,e,b),r(e,t),r(t,a),V(m,o,b),V(m,h,b),r(h,d),V(m,T,b),V(m,w,b)},p(m,b){b[0]&32&&l!==(l=m[24].id+"")&&se(a,l),b[0]&32&&n!==(n=He(m[24].id))&&g(t,"href",n)},d(m){m&&s(e),m&&s(o),m&&s(h),m&&s(T),m&&s(w)}}}function mt(c){let e,t,l=c[24].description.graph[0]["d3f:attack-id"]+"",a,n,o,h,d=c[24].description.graph[0]["rdfs:label"]+"",T,w,m,b,E,S,P,A,_,K,F,y,W,v,D,R,Y,X,ee,M,q=Le(c[24].off_to_def.results.bindings),z=[];for(let k=0;k<q.length;k+=1)z[k]=Ue(Fe(c,q,k));let G=null;return q.length||(G=ze()),{c(){e=f("th"),t=f("a"),a=I(l),o=C(),h=f("td"),T=I(d),w=C(),m=f("td"),b=f("table"),E=f("thead"),S=f("th"),P=I("off rel"),A=C(),_=f("th"),K=I("off artifact"),F=C(),y=f("th"),W=I("D3FEND Technique"),v=C(),D=f("th"),R=I("def rel"),Y=C(),X=f("th"),ee=I("def artifact"),M=C();for(let k=0;k<z.length;k+=1)z[k].c();G&&G.c(),this.h()},l(k){e=i(k,"TH",{class:!0,scope:!0});var j=u(e);t=i(j,"A",{href:!0});var O=u(t);a=N(O,l),O.forEach(s),j.forEach(s),o=$(k),h=i(k,"TD",{});var le=u(h);T=N(le,d),le.forEach(s),w=$(k),m=i(k,"TD",{});var U=u(m);b=i(U,"TABLE",{class:!0});var L=u(b);E=i(L,"THEAD",{class:!0});var H=u(E);S=i(H,"TH",{scope:!0});var B=u(S);P=N(B,"off rel"),B.forEach(s),A=$(H),_=i(H,"TH",{scope:!0});var J=u(_);K=N(J,"off artifact"),J.forEach(s),F=$(H),y=i(H,"TH",{scope:!0});var Z=u(y);W=N(Z,"D3FEND Technique"),Z.forEach(s),v=$(H),D=i(H,"TH",{scope:!0});var p=u(D);R=N(p,"def rel"),p.forEach(s),Y=$(H),X=i(H,"TH",{scope:!0});var Q=u(X);ee=N(Q,"def artifact"),Q.forEach(s),H.forEach(s),M=$(L);for(let te=0;te<z.length;te+=1)z[te].l(L);G&&G.l(L),L.forEach(s),U.forEach(s),this.h()},h(){g(t,"href",n=De(c[24].id)),g(e,"class","text-center"),g(e,"scope","row"),g(S,"scope","col"),g(_,"scope","col"),g(y,"scope","col"),g(D,"scope","col"),g(X,"scope","col"),g(E,"class","svelte-1wbelz3"),Ke(E,"hide",c[4]),g(b,"class","table-auto w100 svelte-1wbelz3")},m(k,j){V(k,e,j),r(e,t),r(t,a),V(k,o,j),V(k,h,j),r(h,T),V(k,w,j),V(k,m,j),r(m,b),r(b,E),r(E,S),r(S,P),r(E,A),r(E,_),r(_,K),r(E,F),r(E,y),r(y,W),r(E,v),r(E,D),r(D,R),r(E,Y),r(E,X),r(X,ee),r(b,M);for(let O=0;O<z.length;O+=1)z[O].m(b,null);G&&G.m(b,null)},p(k,j){if(j[0]&32&&l!==(l=k[24].description.graph[0]["d3f:attack-id"]+"")&&se(a,l),j[0]&32&&n!==(n=De(k[24].id))&&g(t,"href",n),j[0]&32&&d!==(d=k[24].description.graph[0]["rdfs:label"]+"")&&se(T,d),j[0]&16&&Ke(E,"hide",k[4]),j[0]&32){q=Le(k[24].off_to_def.results.bindings);let O;for(O=0;O<q.length;O+=1){const le=Fe(k,q,O);z[O]?z[O].p(le,j):(z[O]=Ue(le),z[O].c(),z[O].m(b,null))}for(;O<z.length;O+=1)z[O].d(1);z.length=q.length,!q.length&&G?G.p(k,j):q.length?G&&(G.d(1),G=null):(G=ze(),G.c(),G.m(b,null))}},d(k){k&&s(e),k&&s(o),k&&s(h),k&&s(w),k&&s(m),Ie(z,k),G&&G.d()}}}function ze(c){let e,t,l,a,n;return{c(){e=f("td"),t=I("no defensive relations "),l=f("a"),a=I("yet"),n=C(),this.h()},l(o){e=i(o,"TD",{colspan:!0});var h=u(e);t=N(h,"no defensive relations "),l=i(h,"A",{href:!0});var d=u(l);a=N(d,"yet"),d.forEach(s),n=$(h),h.forEach(s),this.h()},h(){g(l,"href","/contribute"),g(e,"colspan","5")},m(o,h){V(o,e,h),r(e,t),r(e,l),r(l,a),r(e,n)},p:ae,d(o){o&&s(e)}}}function je(c){let e,t,l=c[25].off_artifact_rel_label.value+"",a,n,o,h,d=c[25].off_artifact_label.value+"",T,w,m,b,E,S=c[25].def_tech_label.value+"",P,A,_,K,F=c[25].def_artifact_rel_label.value+"",y,W,v,D,R=c[25].def_artifact_label.value+"",Y,X,ee;return{c(){e=f("tr"),t=f("td"),a=I(l),n=C(),o=f("td"),h=f("a"),T=I(d),m=C(),b=f("td"),E=f("a"),P=I(S),_=C(),K=f("td"),y=I(F),W=C(),v=f("td"),D=f("a"),Y=I(R),ee=C(),this.h()},l(M){e=i(M,"TR",{});var q=u(e);t=i(q,"TD",{});var z=u(t);a=N(z,l),z.forEach(s),n=$(q),o=i(q,"TD",{});var G=u(o);h=i(G,"A",{href:!0});var k=u(h);T=N(k,d),k.forEach(s),G.forEach(s),m=$(q),b=i(q,"TD",{});var j=u(b);E=i(j,"A",{href:!0});var O=u(E);P=N(O,S),O.forEach(s),j.forEach(s),_=$(q),K=i(q,"TD",{});var le=u(K);y=N(le,F),le.forEach(s),W=$(q),v=i(q,"TD",{});var U=u(v);D=i(U,"A",{href:!0});var L=u(D);Y=N(L,R),L.forEach(s),U.forEach(s),ee=$(q),q.forEach(s),this.h()},h(){g(h,"href",w="/dao/artifact/"+ie(c[25].off_artifact.value)),g(E,"href",A="/technique/"+ie(c[25].def_tech.value)),g(D,"href",X="/dao/artifact/"+ie(c[25].def_artifact.value))},m(M,q){V(M,e,q),r(e,t),r(t,a),r(e,n),r(e,o),r(o,h),r(h,T),r(e,m),r(e,b),r(b,E),r(E,P),r(e,_),r(e,K),r(K,y),r(e,W),r(e,v),r(v,D),r(D,Y),r(e,ee)},p(M,q){q[0]&32&&l!==(l=M[25].off_artifact_rel_label.value+"")&&se(a,l),q[0]&32&&d!==(d=M[25].off_artifact_label.value+"")&&se(T,d),q[0]&32&&w!==(w="/dao/artifact/"+ie(M[25].off_artifact.value))&&g(h,"href",w),q[0]&32&&S!==(S=M[25].def_tech_label.value+"")&&se(P,S),q[0]&32&&A!==(A="/technique/"+ie(M[25].def_tech.value))&&g(E,"href",A),q[0]&32&&F!==(F=M[25].def_artifact_rel_label.value+"")&&se(y,F),q[0]&32&&R!==(R=M[25].def_artifact_label.value+"")&&se(Y,R),q[0]&32&&X!==(X="/dao/artifact/"+ie(M[25].def_artifact.value))&&g(D,"href",X)},d(M){M&&s(e)}}}function Ue(c){let e,t=c[25].def_tech&&je(c);return{c(){t&&t.c(),e=he()},l(l){t&&t.l(l),e=he()},m(l,a){t&&t.m(l,a),V(l,e,a)},p(l,a){l[25].def_tech?t?t.p(l,a):(t=je(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){t&&t.d(l),l&&s(e)}}}function bt(c){let e;return{c(){e=I("loading...")},l(t){e=N(t,"loading...")},m(t,l){V(t,e,l)},p:ae,d(t){t&&s(e)}}}function Ge(c){let e,t,l,a={ctx:c,current:null,token:null,hasCatch:!0,pending:bt,then:pt,catch:_t,value:24,error:28};return Te(t=c[21],a),{c(){e=f("tr"),a.block.c(),l=C()},l(n){e=i(n,"TR",{});var o=u(e);a.block.l(o),l=$(o),o.forEach(s)},m(n,o){V(n,e,o),a.block.m(e,a.anchor=null),a.mount=()=>e,a.anchor=l,r(e,l)},p(n,o){c=n,a.ctx=c,o[0]&32&&t!==(t=c[21])&&Te(t,a)||Me(a,c,o)},d(n){n&&s(e),a.block.d(),a.token=null,a=null}}}function Et(c){let e;return{c(){e=I("enter text and click go")},l(t){e=N(t,"enter text and click go")},m(t,l){V(t,e,l)},p:ae,i:ae,o:ae,d(t){t&&s(e)}}}function gt(c){let e,t,l,a,n,o,h,d,T,w,m,b,E,S,P,A,_,K,F,y,W,v,D,R,Y,X,ee,M,q,z,G,k,j,O,le,U;e=new at({props:{title:"ATT&CK Extractor | Tools | "}}),a=new rt({});let L={ctx:c,current:null,token:null,hasCatch:!0,pending:Et,then:ct,catch:nt,value:20,error:28,blocks:[,,,]};return Te(j=c[5],L),{c(){pe(e.$$.fragment),t=C(),l=f("section"),pe(a.$$.fragment),n=C(),o=f("div"),h=f("h1"),d=I("ATT&CK Extractor"),T=C(),w=f("p"),m=I("Extracts ATT&CK techniques from blobs of text and recommends potential D3FEND countermeasures. You may also want to try the "),b=f("a"),E=I("D3FEND Extractor"),S=I(" or the "),P=f("a"),A=I("Artifact Extractor."),_=C(),K=f("p"),F=f("i"),y=I("Paste any text containing ATT&CK IDs:"),W=C(),v=f("div"),D=f("textarea"),R=C(),Y=f("div"),X=f("button"),ee=I("GO"),M=C(),q=f("br"),z=C(),G=f("br"),k=C(),L.block.c(),this.h()},l(H){ve(e.$$.fragment,H),t=$(H),l=i(H,"SECTION",{class:!0});var B=u(l);ve(a.$$.fragment,B),n=$(B),o=i(B,"DIV",{class:!0});var J=u(o);h=i(J,"H1",{});var Z=u(h);d=N(Z,"ATT&CK Extractor"),Z.forEach(s),T=$(J),w=i(J,"P",{});var p=u(w);m=N(p,"Extracts ATT&CK techniques from blobs of text and recommends potential D3FEND countermeasures. You may also want to try the "),b=i(p,"A",{href:!0});var Q=u(b);E=N(Q,"D3FEND Extractor"),Q.forEach(s),S=N(p," or the "),P=i(p,"A",{href:!0});var te=u(P);A=N(te,"Artifact Extractor."),te.forEach(s),p.forEach(s),_=$(J),K=i(J,"P",{class:!0});var re=u(K);F=i(re,"I",{});var x=u(F);y=N(x,"Paste any text containing ATT&CK IDs:"),x.forEach(s),re.forEach(s),W=$(J),v=i(J,"DIV",{});var ce=u(v);D=i(ce,"TEXTAREA",{class:!0}),u(D).forEach(s),ce.forEach(s),R=$(J),Y=i(J,"DIV",{});var de=u(Y);X=i(de,"BUTTON",{class:!0});var _e=u(X);ee=N(_e,"GO"),_e.forEach(s),de.forEach(s),M=$(J),q=i(J,"BR",{}),J.forEach(s),z=$(B),G=i(B,"BR",{}),k=$(B),L.block.l(B),B.forEach(s),this.h()},h(){g(b,"href","/tools/d3fend-extractor"),g(P,"href","/tools/artifact-extractor"),g(K,"class","text-2"),g(D,"class","svelte-1wbelz3"),g(X,"class","button"),g(o,"class","card"),g(l,"class"," svelte-1wbelz3")},m(H,B){me(e,H,B),V(H,t,B),V(H,l,B),me(a,l,null),r(l,n),r(l,o),r(o,h),r(h,d),r(o,T),r(o,w),r(w,m),r(w,b),r(b,E),r(w,S),r(w,P),r(P,A),r(o,_),r(o,K),r(K,F),r(F,y),r(o,W),r(o,v),r(v,D),Ve(D,c[1]),r(o,R),r(o,Y),r(Y,X),r(X,ee),r(o,M),r(o,q),r(l,z),r(l,G),r(l,k),L.block.m(l,L.anchor=null),L.mount=()=>l,L.anchor=null,O=!0,le||(U=[ue(D,"input",c[12]),ue(D,"keypress",c[10]),ue(X,"click",c[7])],le=!0)},p(H,B){c=H,B[0]&2&&Ve(D,c[1]),L.ctx=c,B[0]&32&&j!==(j=c[5])&&Te(j,L)||Me(L,c,B)},i(H){O||(oe(e.$$.fragment,H),oe(a.$$.fragment,H),oe(L.block),O=!0)},o(H){ne(e.$$.fragment,H),ne(a.$$.fragment,H);for(let B=0;B<3;B+=1){const J=L.blocks[B];ne(J)}O=!1},d(H){be(e,H),H&&s(t),H&&s(l),be(a),L.block.d(),L.token=null,L=null,le=!1,xe(U)}}}async function Rt({params:c,fetch:e}){c.technique;const t=await e("/api/offensive-technique/all.json"),l=await t.json();return t.status===200?{props:{techniques:l}}:{status:t.status,error:new Error(l.message)}}function kt(){document.execCommand("copy")}function Le(c){let e=new Set,t=[];return c.forEach(function(l){l.hasOwnProperty("def_tech_label")&&(e.has(l.def_tech_label.value)||(e.add(l.def_tech_label.value),t.push(l)))}),t}function Tt(c,e,t){let l;et(c,ot,v=>t(6,l=v));let{techniques:a}=e,n=new Re(a,{index:!0,index_key:"d3f:attack-id"}),o,h="",d=!1,T=!0,w,m=[];function b(){t(0,o=[]),t(2,d=!1),t(3,T=!0),m=[]}w=l.url.searchParams.get("q"),console.log("Found params: "+w);let E=!1;async function S(v){let D="/api/offensive-technique/attack/"+v+".json";const R=await fetch(D);if(R.status==404)return{id:v,off_to_def:[],description:{graph:[]},status:R.status};if(R.ok){const Y=await R.json();return{id:v,off_to_def:Y.off_to_def,description:new Re(Y.description)}}else throw new Error(h)}async function P(){b();let v=t(0,o=Array.from(new Set(lt(h,n))));return v?(v.forEach(function(D){let R;R=S(D),R&&m.push(R)}),l.url.searchParams.set("q",JSON.stringify(v)),history.replaceState(null,"mapping",l.url)):(b(),console.debug("no matches")),m}let A=P();function _(){t(5,A=P()),t(3,T=!1)}function K(){window.getSelection().removeAllRanges(),t(2,d=!1),t(4,E=!1)}function F(){t(4,E=!0);let v="mappings";const D=window.getSelection();D.removeAllRanges();let R=document.getElementById(v);const Y=document.createRange();Y.selectNodeContents(R),D.addRange(Y),t(2,d=!0)}function y(v){v.ctrlKey==!0&&v.keyCode==13&&_()}tt(async()=>{w?(t(1,h=w),console.log("handlingclick"),_()):(console.log("starting blank"),t(1,h=""))});function W(){h=this.value,t(1,h)}return c.$$set=v=>{"techniques"in v&&t(11,a=v.techniques)},[o,h,d,T,E,A,l,_,K,F,y,a,W]}class Ht extends Qe{constructor(e){super(),We(this,e,Tt,gt,Ze,{techniques:11},null,[-1,-1])}}export{Ht as default,Rt as load};
