var nt=Object.defineProperty;var Se=Object.getOwnPropertySymbols;var it=Object.prototype.hasOwnProperty,ct=Object.prototype.propertyIsEnumerable;var Le=(n,e,t)=>e in n?nt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ye=(n,e)=>{for(var t in e||(e={}))it.call(e,t)&&Le(n,t,e[t]);if(Se)for(var t of Se(e))ct.call(e,t)&&Le(n,t,e[t]);return n};import{S as ft,i as ht,s as ut,a7 as Ie,w as Ee,k as $,e as c,t as T,x as ge,m as F,c as f,a as h,h as k,d as s,b as p,y as De,g as B,I as a,a1 as je,N as _e,a8 as lt,q as fe,o as he,B as Te,Y as at,R as dt,v as _t,f as $e,j as ne,E as ie,l as pe,n as rt,p as st,X as Fe,V as Ue}from"../../chunks/index-a02da30e.js";import{H as vt}from"../../chunks/Header-47fd749a.js";import{T as pt}from"../../chunks/Title-1d23c88f.js";import{A as mt}from"../../chunks/Alert-12c40fb9.js";import{b as bt,S as ot}from"../../chunks/extract-26c878fb.js";import{G as Ge,g as de,f as Me,e as Ne,d as Ae}from"../../chunks/lib-88dd6a45.js";import{p as Et}from"../../chunks/stores-cf129ad8.js";import"../../chunks/stores-59d8ae96.js";import"../../chunks/index-98a102c4.js";/* empty css                                                       */import"../../chunks/marked.esm-8ab30116.js";var gt={name:"D3FEND Countermeasure Coverage",domain:"enterprise-attack",description:""};class Dt{constructor(e){this.layer=ye({},gt),this.layer.techniques=new Array,this.tech_index={},e&&(this.options=ye(ye({},this.options),e))}add_technique(e){this.tech_index.hasOwnProperty(e.techniqueID)?this.tech_index[e.techniqueID].comment&&this.tech_index[e.techniqueID].comment.indexOf(e.comment)==-1&&(this.tech_index[e.techniqueID].comment+=e.comment):this.tech_index[e.techniqueID]=e}json(){for(let e in this.tech_index)this.layer.techniques.push(this.tech_index[e]);return this.layer}}function Ye(n,e,t){const l=n.slice();return l[22]=e[t],l}function Je(n,e,t){const l=n.slice();return l[26]=e[t],l}function Xe(n,e,t){const l=n.slice();return l[30]=e[t],l}function Tt(n){let e,t=n[29].message+"",l;return{c(){e=c("p"),l=T(t),this.h()},l(r){e=f(r,"P",{style:!0});var i=h(e);l=k(i,t),i.forEach(s),this.h()},h(){$e(e,"color","red")},m(r,i){B(r,e,i),a(e,l)},p(r,i){i[0]&32&&t!==(t=r[29].message+"")&&ne(l,t)},i:ie,o:ie,d(r){r&&s(e)}}}function kt(n){let e,t,l,r;const i=[wt,qt],o=[];function d(_,w){return _[21].length>0?0:!_[3]&&_[21].length<1?1:-1}return~(e=d(n))&&(t=o[e]=i[e](n)),{c(){t&&t.c(),l=pe()},l(_){t&&t.l(_),l=pe()},m(_,w){~e&&o[e].m(_,w),B(_,l,w),r=!0},p(_,w){let y=e;e=d(_),e===y?~e&&o[e].p(_,w):(t&&(rt(),he(o[y],1,1,()=>{o[y]=null}),st()),~e?(t=o[e],t?t.p(_,w):(t=o[e]=i[e](_),t.c()),fe(t,1),t.m(l.parentNode,l)):t=null)},i(_){r||(fe(t),r=!0)},o(_){he(t),r=!1},d(_){~e&&o[e].d(_),_&&s(l)}}}function qt(n){let e,t;return{c(){e=c("div"),t=T("No D3FEND techniques found in text."),this.h()},l(l){e=f(l,"DIV",{class:!0});var r=h(e);t=k(r,"No D3FEND techniques found in text."),r.forEach(s),this.h()},h(){p(e,"class","card")},m(l,r){B(l,e,r),a(e,t)},p:ie,i:ie,o:ie,d(l){l&&s(e)}}}function wt(n){let e,t,l,r,i,o,d,_,w,y,E,D,b,P,Y,C,v,V,G,N,H,z,g,S,L,I,Q,W,M,le,ee,x,J,A,u,X,K,ae,ce,q=n[0]&&ze(n);r=new mt({props:{$$slots:{default:[yt]},$$scope:{ctx:n}}}),w=new ot({props:{url:n[6].url}});function R(m,Z){return m[2]?At:Nt}let j=R(n),O=j(n),se=n[21],U=[];for(let m=0;m<se.length;m+=1)U[m]=et(Ye(n,se,m));return{c(){e=c("div"),q&&q.c(),t=$(),l=c("div"),Ee(r.$$.fragment),i=$(),o=c("div"),d=c("div"),_=c("div"),Ee(w.$$.fragment),y=$(),E=c("div"),D=c("b"),b=c("i"),P=T("Mapping Results:"),Y=$(),C=c("div"),v=c("button"),V=T("Download ATT&CK Navigator Layer"),G=$(),N=c("div"),H=c("div"),O.c(),z=$(),g=c("button"),S=T("copy"),L=$(),I=c("table"),Q=c("thead"),W=c("th"),M=T("D3FEND ID"),le=$(),ee=c("th"),x=T("D3FEND Name"),J=$(),A=c("th"),u=T("Related ATT&CK Techniques"),X=$();for(let m=0;m<U.length;m+=1)U[m].c();this.h()},l(m){e=f(m,"DIV",{class:!0});var Z=h(e);q&&q.l(Z),Z.forEach(s),t=F(m),l=f(m,"DIV",{class:!0});var re=h(l);ge(r.$$.fragment,re),re.forEach(s),i=F(m),o=f(m,"DIV",{class:!0});var oe=h(o);d=f(oe,"DIV",{class:!0});var te=h(d);_=f(te,"DIV",{class:!0});var ue=h(_);ge(w.$$.fragment,ue),ue.forEach(s),te.forEach(s),y=F(oe),E=f(oe,"DIV",{});var me=h(E);D=f(me,"B",{});var be=h(D);b=f(be,"I",{});var Re=h(b);P=k(Re,"Mapping Results:"),Re.forEach(s),be.forEach(s),me.forEach(s),Y=F(oe),C=f(oe,"DIV",{class:!0});var Ve=h(C);v=f(Ve,"BUTTON",{class:!0,title:!0});var Be=h(v);V=k(Be,"Download ATT&CK Navigator Layer"),Be.forEach(s),Ve.forEach(s),G=F(oe),N=f(oe,"DIV",{class:!0});var ke=h(N);H=f(ke,"DIV",{class:!0});var qe=h(H);O.l(qe),z=F(qe),g=f(qe,"BUTTON",{});var He=h(g);S=k(He,"copy"),He.forEach(s),qe.forEach(s),L=F(ke),I=f(ke,"TABLE",{id:!0,class:!0});var we=h(I);Q=f(we,"THEAD",{});var ve=h(Q);W=f(ve,"TH",{class:!0});var Ke=h(W);M=k(Ke,"D3FEND ID"),Ke.forEach(s),le=F(ve),ee=f(ve,"TH",{});var Oe=h(ee);x=k(Oe,"D3FEND Name"),Oe.forEach(s),J=F(ve),A=f(ve,"TH",{});var Pe=h(A);u=k(Pe,"Related ATT&CK Techniques"),Pe.forEach(s),ve.forEach(s),X=F(we);for(let Ce=0;Ce<U.length;Ce+=1)U[Ce].l(we);we.forEach(s),ke.forEach(s),oe.forEach(s),this.h()},h(){p(e,"class","card"),p(l,"class","card"),p(_,"class","text-right"),p(d,"class","stretch"),p(v,"class","small button"),p(v,"title","Load into Navigator to see related TTPs"),p(C,"class","text-right"),p(H,"class","text-right"),p(W,"class","stretch"),p(I,"id","mappings"),p(I,"class","table-auto"),p(N,"class","results-wrap center svelte-wn74lb"),p(o,"class","card")},m(m,Z){B(m,e,Z),q&&q.m(e,null),B(m,t,Z),B(m,l,Z),De(r,l,null),B(m,i,Z),B(m,o,Z),a(o,d),a(d,_),De(w,_,null),a(o,y),a(o,E),a(E,D),a(D,b),a(b,P),a(o,Y),a(o,C),a(C,v),a(v,V),a(o,G),a(o,N),a(N,H),O.m(H,null),a(H,z),a(H,g),a(g,S),a(N,L),a(N,I),a(I,Q),a(Q,W),a(W,M),a(Q,le),a(Q,ee),a(ee,x),a(Q,J),a(Q,A),a(A,u),a(I,X);for(let re=0;re<U.length;re+=1)U[re].m(I,null);K=!0,ae||(ce=[_e(v,"click",n[7]),_e(g,"click",Ht)],ae=!0)},p(m,Z){m[0]?q?(q.p(m,Z),Z[0]&1&&fe(q,1)):(q=ze(m),q.c(),fe(q,1),q.m(e,null)):q&&(rt(),he(q,1,1,()=>{q=null}),st());const re={};Z[1]&4&&(re.$$scope={dirty:Z,ctx:m}),r.$set(re);const oe={};if(Z[0]&64&&(oe.url=m[6].url),w.$set(oe),j===(j=R(m))&&O?O.p(m,Z):(O.d(1),O=j(m),O&&(O.c(),O.m(H,z))),Z[0]&48){se=m[21];let te;for(te=0;te<se.length;te+=1){const ue=Ye(m,se,te);U[te]?U[te].p(ue,Z):(U[te]=et(ue),U[te].c(),U[te].m(I,null))}for(;te<U.length;te+=1)U[te].d(1);U.length=se.length}},i(m){K||(fe(q),fe(r.$$.fragment,m),fe(w.$$.fragment,m),K=!0)},o(m){he(q),he(r.$$.fragment,m),he(w.$$.fragment,m),K=!1},d(m){m&&s(e),q&&q.d(),m&&s(t),m&&s(l),Te(r),m&&s(i),m&&s(o),Te(w),O.d(),Fe(U,m),ae=!1,at(ce)}}}function ze(n){let e,t,l,r,i,o,d,_,w=n[0].length+"",y,E,D,b,P;l=new ot({props:{url:n[6].url}});let Y=n[0],C=[];for(let v=0;v<Y.length;v+=1)C[v]=Qe(Xe(n,Y,v));return{c(){e=c("div"),t=c("div"),Ee(l.$$.fragment),r=$(),i=c("div"),o=c("b"),d=c("i"),_=T("Extracted "),y=T(w),E=T(" unique IDs:"),D=$(),b=c("dl");for(let v=0;v<C.length;v+=1)C[v].c();this.h()},l(v){e=f(v,"DIV",{class:!0});var V=h(e);t=f(V,"DIV",{class:!0});var G=h(t);ge(l.$$.fragment,G),G.forEach(s),V.forEach(s),r=F(v),i=f(v,"DIV",{class:!0});var N=h(i);o=f(N,"B",{});var H=h(o);d=f(H,"I",{});var z=h(d);_=k(z,"Extracted "),y=k(z,w),E=k(z," unique IDs:"),z.forEach(s),H.forEach(s),D=F(N),b=f(N,"DL",{class:!0});var g=h(b);for(let S=0;S<C.length;S+=1)C[S].l(g);g.forEach(s),N.forEach(s),this.h()},h(){p(t,"class","text-right"),p(e,"class","stretch"),p(b,"class","flex flex-wrap svelte-wn74lb"),p(i,"class","")},m(v,V){B(v,e,V),a(e,t),De(l,t,null),B(v,r,V),B(v,i,V),a(i,o),a(o,d),a(d,_),a(d,y),a(d,E),a(i,D),a(i,b);for(let G=0;G<C.length;G+=1)C[G].m(b,null);P=!0},p(v,V){const G={};if(V[0]&64&&(G.url=v[6].url),l.$set(G),(!P||V[0]&1)&&w!==(w=v[0].length+"")&&ne(y,w),V[0]&1){Y=v[0];let N;for(N=0;N<Y.length;N+=1){const H=Xe(v,Y,N);C[N]?C[N].p(H,V):(C[N]=Qe(H),C[N].c(),C[N].m(b,null))}for(;N<C.length;N+=1)C[N].d(1);C.length=Y.length}},i(v){P||(fe(l.$$.fragment,v),P=!0)},o(v){he(l.$$.fragment,v),P=!1},d(v){v&&s(e),Te(l),v&&s(r),v&&s(i),Fe(C,v)}}}function Qe(n){let e,t,l=n[30]+"",r,i;return{c(){e=c("dd"),t=c("a"),r=T(l),this.h()},l(o){e=f(o,"DD",{});var d=h(e);t=f(d,"A",{href:!0});var _=h(t);r=k(_,l),_.forEach(s),d.forEach(s),this.h()},h(){p(t,"href",i="/technique/"+n[30])},m(o,d){B(o,e,d),a(e,t),a(t,r)},p(o,d){d[0]&1&&l!==(l=o[30]+"")&&ne(r,l),d[0]&1&&i!==(i="/technique/"+o[30])&&p(t,"href",i)},d(o){o&&s(e)}}}function yt(n){let e,t,l;return{c(){e=c("b"),t=T("Note: "),l=T("These relationships are generated based on the digital artifacts specified for the offensive and defensive techniques. They are designed to give you ideas, they are not designed to be exact matches or indicate precise coverage. They can be used to better understand the technologies, ask better questions, and develop test plans for your countermeasures.")},l(r){e=f(r,"B",{});var i=h(e);t=k(i,"Note: "),i.forEach(s),l=k(r,"These relationships are generated based on the digital artifacts specified for the offensive and defensive techniques. They are designed to give you ideas, they are not designed to be exact matches or indicate precise coverage. They can be used to better understand the technologies, ask better questions, and develop test plans for your countermeasures.")},m(r,i){B(r,e,i),a(e,t),B(r,l,i)},p:ie,d(r){r&&s(e),r&&s(l)}}}function Nt(n){let e,t,l,r;return{c(){e=c("button"),t=T("select"),this.h()},l(i){e=f(i,"BUTTON",{class:!0});var o=h(e);t=k(o,"select"),o.forEach(s),this.h()},h(){p(e,"class","selector svelte-wn74lb")},m(i,o){B(i,e,o),a(e,t),l||(r=_e(e,"click",n[10]),l=!0)},p:ie,d(i){i&&s(e),l=!1,r()}}}function At(n){let e,t,l,r;return{c(){e=c("button"),t=T("deselect"),this.h()},l(i){e=f(i,"BUTTON",{class:!0});var o=h(e);t=k(o,"deselect"),o.forEach(s),this.h()},h(){p(e,"class","selector svelte-wn74lb")},m(i,o){B(i,e,o),a(e,t),l||(r=_e(e,"click",n[9]),l=!0)},p:ie,d(i){i&&s(e),l=!1,r()}}}function It(n){let e,t=n[29].message+"",l;return{c(){e=c("p"),l=T(t),this.h()},l(r){e=f(r,"P",{style:!0});var i=h(e);l=k(i,t),i.forEach(s),this.h()},h(){$e(e,"color","red")},m(r,i){B(r,e,i),a(e,l)},p(r,i){i[0]&32&&t!==(t=r[29].message+"")&&ne(l,t)},d(r){r&&s(e)}}}function Ct(n){let e;function t(i,o){return i[25].description.graph[0]?Ft:$t}let l=t(n),r=l(n);return{c(){r.c(),e=pe()},l(i){r.l(i),e=pe()},m(i,o){r.m(i,o),B(i,e,o)},p(i,o){l===(l=t(i))&&r?r.p(i,o):(r.d(1),r=l(i),r&&(r.c(),r.m(e.parentNode,e)))},d(i){r.d(i),i&&s(e)}}}function $t(n){let e,t,l=n[25].id+"",r,i,o,d,_,w,y;return{c(){e=c("td"),t=c("a"),r=T(l),o=$(),d=c("td"),_=T("not found in D3FEND graph"),w=$(),y=c("td"),this.h()},l(E){e=f(E,"TD",{class:!0});var D=h(e);t=f(D,"A",{style:!0,href:!0});var b=h(t);r=k(b,l),b.forEach(s),D.forEach(s),o=F(E),d=f(E,"TD",{});var P=h(d);_=k(P,"not found in D3FEND graph"),P.forEach(s),w=F(E),y=f(E,"TD",{}),h(y).forEach(s),this.h()},h(){$e(t,"color","red"),p(t,"href",i=Me(n[25].id)),p(e,"class","text-center")},m(E,D){B(E,e,D),a(e,t),a(t,r),B(E,o,D),B(E,d,D),a(d,_),B(E,w,D),B(E,y,D)},p(E,D){D[0]&32&&l!==(l=E[25].id+"")&&ne(r,l),D[0]&32&&i!==(i=Me(E[25].id))&&p(t,"href",i)},d(E){E&&s(e),E&&s(o),E&&s(d),E&&s(w),E&&s(y)}}}function Ft(n){let e,t,l=n[25].description.graph[0]["d3f:d3fend-id"]+"",r,i,o,d,_=n[25].description.graph[0]["rdfs:label"]+"",w,y,E,D,b,P,Y,C,v,V,G,N,H,z,g,S,L,I,Q,W,M,le,ee,x=tt(n[25].def_to_off.results.bindings),J=[];for(let u=0;u<x.length;u+=1)J[u]=xe(Je(n,x,u));let A=null;return x.length||(A=We()),{c(){e=c("th"),t=c("a"),r=T(l),o=$(),d=c("td"),w=T(_),y=$(),E=c("td"),D=c("table"),b=c("thead"),P=c("th"),Y=T("defensive verb"),C=$(),v=c("th"),V=T("defensive artifact"),G=$(),N=c("th"),H=T("ATT&CK Technique"),z=$(),g=c("th"),S=T("offensive verb"),L=$(),I=c("th"),Q=T("offensive artifact"),W=$(),M=c("th"),le=T("ATT&CK ID"),ee=$();for(let u=0;u<J.length;u+=1)J[u].c();A&&A.c(),this.h()},l(u){e=f(u,"TH",{class:!0,scope:!0});var X=h(e);t=f(X,"A",{href:!0});var K=h(t);r=k(K,l),K.forEach(s),X.forEach(s),o=F(u),d=f(u,"TD",{});var ae=h(d);w=k(ae,_),ae.forEach(s),y=F(u),E=f(u,"TD",{});var ce=h(E);D=f(ce,"TABLE",{class:!0});var q=h(D);b=f(q,"THEAD",{class:!0});var R=h(b);P=f(R,"TH",{scope:!0});var j=h(P);Y=k(j,"defensive verb"),j.forEach(s),C=F(R),v=f(R,"TH",{scope:!0});var O=h(v);V=k(O,"defensive artifact"),O.forEach(s),G=F(R),N=f(R,"TH",{scope:!0});var se=h(N);H=k(se,"ATT&CK Technique"),se.forEach(s),z=F(R),g=f(R,"TH",{scope:!0});var U=h(g);S=k(U,"offensive verb"),U.forEach(s),L=F(R),I=f(R,"TH",{scope:!0});var m=h(I);Q=k(m,"offensive artifact"),m.forEach(s),W=F(R),M=f(R,"TH",{scope:!0});var Z=h(M);le=k(Z,"ATT&CK ID"),Z.forEach(s),R.forEach(s),ee=F(q);for(let re=0;re<J.length;re+=1)J[re].l(q);A&&A.l(q),q.forEach(s),ce.forEach(s),this.h()},h(){p(t,"href",i="/technique/"+n[25].description.graph[0]["@id"]),p(e,"class","text-center"),p(e,"scope","row"),p(P,"scope","col"),p(v,"scope","col"),p(N,"scope","col"),p(g,"scope","col"),p(I,"scope","col"),p(M,"scope","col"),p(b,"class","svelte-wn74lb"),Ue(b,"hide",n[4]),p(D,"class","table-auto w100 svelte-wn74lb")},m(u,X){B(u,e,X),a(e,t),a(t,r),B(u,o,X),B(u,d,X),a(d,w),B(u,y,X),B(u,E,X),a(E,D),a(D,b),a(b,P),a(P,Y),a(b,C),a(b,v),a(v,V),a(b,G),a(b,N),a(N,H),a(b,z),a(b,g),a(g,S),a(b,L),a(b,I),a(I,Q),a(b,W),a(b,M),a(M,le),a(D,ee);for(let K=0;K<J.length;K+=1)J[K].m(D,null);A&&A.m(D,null)},p(u,X){if(X[0]&32&&l!==(l=u[25].description.graph[0]["d3f:d3fend-id"]+"")&&ne(r,l),X[0]&32&&i!==(i="/technique/"+u[25].description.graph[0]["@id"])&&p(t,"href",i),X[0]&32&&_!==(_=u[25].description.graph[0]["rdfs:label"]+"")&&ne(w,_),X[0]&16&&Ue(b,"hide",u[4]),X[0]&32){x=tt(u[25].def_to_off.results.bindings);let K;for(K=0;K<x.length;K+=1){const ae=Je(u,x,K);J[K]?J[K].p(ae,X):(J[K]=xe(ae),J[K].c(),J[K].m(D,null))}for(;K<J.length;K+=1)J[K].d(1);J.length=x.length,!x.length&&A?A.p(u,X):x.length?A&&(A.d(1),A=null):(A=We(),A.c(),A.m(D,null))}},d(u){u&&s(e),u&&s(o),u&&s(d),u&&s(y),u&&s(E),Fe(J,u),A&&A.d()}}}function We(n){let e,t,l,r,i;return{c(){e=c("td"),t=T("no defensive relations "),l=c("a"),r=T("yet"),i=$(),this.h()},l(o){e=f(o,"TD",{colspan:!0});var d=h(e);t=k(d,"no defensive relations "),l=f(d,"A",{href:!0});var _=h(l);r=k(_,"yet"),_.forEach(s),i=F(d),d.forEach(s),this.h()},h(){p(l,"href","/contribute"),p(e,"colspan","5")},m(o,d){B(o,e,d),a(e,t),a(e,l),a(l,r),a(e,i)},p:ie,d(o){o&&s(e)}}}function Ze(n){let e,t,l=n[26].def_artifact_rel_label.value+"",r,i,o,d,_=n[26].def_artifact_label.value+"",w,y,E,D,b,P=n[26].off_tech_label.value+"",Y,C,v,V,G=n[26].off_artifact_rel_label.value+"",N,H,z,g,S=n[26].off_artifact_label.value+"",L,I,Q,W,M,le=de(n[26].off_tech.value)+"",ee,x,J;return{c(){e=c("tr"),t=c("td"),r=T(l),i=$(),o=c("td"),d=c("a"),w=T(_),E=$(),D=c("td"),b=c("a"),Y=T(P),v=$(),V=c("td"),N=T(G),H=$(),z=c("td"),g=c("a"),L=T(S),Q=$(),W=c("td"),M=c("a"),ee=T(le),J=$(),this.h()},l(A){e=f(A,"TR",{});var u=h(e);t=f(u,"TD",{});var X=h(t);r=k(X,l),X.forEach(s),i=F(u),o=f(u,"TD",{});var K=h(o);d=f(K,"A",{href:!0});var ae=h(d);w=k(ae,_),ae.forEach(s),K.forEach(s),E=F(u),D=f(u,"TD",{});var ce=h(D);b=f(ce,"A",{href:!0});var q=h(b);Y=k(q,P),q.forEach(s),ce.forEach(s),v=F(u),V=f(u,"TD",{});var R=h(V);N=k(R,G),R.forEach(s),H=F(u),z=f(u,"TD",{});var j=h(z);g=f(j,"A",{href:!0});var O=h(g);L=k(O,S),O.forEach(s),j.forEach(s),Q=F(u),W=f(u,"TD",{});var se=h(W);M=f(se,"A",{href:!0});var U=h(M);ee=k(U,le),U.forEach(s),se.forEach(s),J=F(u),u.forEach(s),this.h()},h(){p(d,"href",y="/dao/artifact/"+Ne(n[26].def_artifact.value)),p(b,"href",C=Ae(de(n[26].off_tech.value))),p(g,"href",I="/dao/artifact/"+Ne(n[26].off_artifact.value)),p(M,"href",x=Ae(de(n[26].off_tech.value)))},m(A,u){B(A,e,u),a(e,t),a(t,r),a(e,i),a(e,o),a(o,d),a(d,w),a(e,E),a(e,D),a(D,b),a(b,Y),a(e,v),a(e,V),a(V,N),a(e,H),a(e,z),a(z,g),a(g,L),a(e,Q),a(e,W),a(W,M),a(M,ee),a(e,J)},p(A,u){u[0]&32&&l!==(l=A[26].def_artifact_rel_label.value+"")&&ne(r,l),u[0]&32&&_!==(_=A[26].def_artifact_label.value+"")&&ne(w,_),u[0]&32&&y!==(y="/dao/artifact/"+Ne(A[26].def_artifact.value))&&p(d,"href",y),u[0]&32&&P!==(P=A[26].off_tech_label.value+"")&&ne(Y,P),u[0]&32&&C!==(C=Ae(de(A[26].off_tech.value)))&&p(b,"href",C),u[0]&32&&G!==(G=A[26].off_artifact_rel_label.value+"")&&ne(N,G),u[0]&32&&S!==(S=A[26].off_artifact_label.value+"")&&ne(L,S),u[0]&32&&I!==(I="/dao/artifact/"+Ne(A[26].off_artifact.value))&&p(g,"href",I),u[0]&32&&le!==(le=de(A[26].off_tech.value)+"")&&ne(ee,le),u[0]&32&&x!==(x=Ae(de(A[26].off_tech.value)))&&p(M,"href",x)},d(A){A&&s(e)}}}function xe(n){let e,t=n[26].def_tech&&Ze(n);return{c(){t&&t.c(),e=pe()},l(l){t&&t.l(l),e=pe()},m(l,r){t&&t.m(l,r),B(l,e,r)},p(l,r){l[26].def_tech?t?t.p(l,r):(t=Ze(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){t&&t.d(l),l&&s(e)}}}function Rt(n){let e;return{c(){e=T("loading...")},l(t){e=k(t,"loading...")},m(t,l){B(t,e,l)},p:ie,d(t){t&&s(e)}}}function et(n){let e,t,l,r={ctx:n,current:null,token:null,hasCatch:!0,pending:Rt,then:Ct,catch:It,value:25,error:29};return Ie(t=n[22],r),{c(){e=c("tr"),r.block.c(),l=$()},l(i){e=f(i,"TR",{});var o=h(e);r.block.l(o),l=F(o),o.forEach(s)},m(i,o){B(i,e,o),r.block.m(e,r.anchor=null),r.mount=()=>e,r.anchor=l,a(e,l)},p(i,o){n=i,r.ctx=n,o[0]&32&&t!==(t=n[22])&&Ie(t,r)||lt(r,n,o)},d(i){i&&s(e),r.block.d(),r.token=null,r=null}}}function Vt(n){let e;return{c(){e=T("enter text and click go")},l(t){e=k(t,"enter text and click go")},m(t,l){B(t,e,l)},p:ie,i:ie,o:ie,d(t){t&&s(e)}}}function Bt(n){let e,t,l,r,i,o,d,_,w,y,E,D,b,P,Y,C,v,V,G,N,H,z,g,S,L,I,Q,W,M,le,ee,x,J,A,u,X,K,ae,ce;e=new pt({props:{title:"D3FEND Extractor | Tools | "}}),r=new vt({props:{header:"D3FEND Extractor"}});let q={ctx:n,current:null,token:null,hasCatch:!0,pending:Vt,then:kt,catch:Tt,value:21,error:29,blocks:[,,,]};return Ie(X=n[5],q),{c(){Ee(e.$$.fragment),t=$(),l=c("section"),Ee(r.$$.fragment),i=$(),o=c("div"),d=c("h1"),_=T("D3FEND Extractor"),w=$(),y=c("p"),E=T("Extracts D3FEND techniques from blobs of text and identifies "),D=c("i"),b=T("related"),P=T(" ATT&CK Techniques. You may also want to try the "),Y=c("a"),C=T("ATT&CK Extractor"),v=T(" or the "),V=c("a"),G=T("Artifact Extractor."),N=$(),H=c("p"),z=c("i"),g=T("Paste any text containing D3FEND techniques:"),S=$(),L=c("div"),I=c("textarea"),Q=$(),W=c("div"),M=c("button"),le=T("GO"),ee=$(),x=c("br"),J=$(),A=c("br"),u=$(),q.block.c(),this.h()},l(R){ge(e.$$.fragment,R),t=F(R),l=f(R,"SECTION",{class:!0});var j=h(l);ge(r.$$.fragment,j),i=F(j),o=f(j,"DIV",{class:!0});var O=h(o);d=f(O,"H1",{});var se=h(d);_=k(se,"D3FEND Extractor"),se.forEach(s),w=F(O),y=f(O,"P",{});var U=h(y);E=k(U,"Extracts D3FEND techniques from blobs of text and identifies "),D=f(U,"I",{});var m=h(D);b=k(m,"related"),m.forEach(s),P=k(U," ATT&CK Techniques. You may also want to try the "),Y=f(U,"A",{href:!0});var Z=h(Y);C=k(Z,"ATT&CK Extractor"),Z.forEach(s),v=k(U," or the "),V=f(U,"A",{href:!0});var re=h(V);G=k(re,"Artifact Extractor."),re.forEach(s),U.forEach(s),N=F(O),H=f(O,"P",{class:!0});var oe=h(H);z=f(oe,"I",{});var te=h(z);g=k(te,"Paste any text containing D3FEND techniques:"),te.forEach(s),oe.forEach(s),S=F(O),L=f(O,"DIV",{});var ue=h(L);I=f(ue,"TEXTAREA",{class:!0}),h(I).forEach(s),ue.forEach(s),Q=F(O),W=f(O,"DIV",{});var me=h(W);M=f(me,"BUTTON",{class:!0});var be=h(M);le=k(be,"GO"),be.forEach(s),me.forEach(s),ee=F(O),x=f(O,"BR",{}),O.forEach(s),J=F(j),A=f(j,"BR",{}),u=F(j),q.block.l(j),j.forEach(s),this.h()},h(){p(Y,"href","/tools/attack-extractor"),p(V,"href","/tools/artifact-extractor"),p(H,"class","text-2"),p(I,"class","svelte-wn74lb"),p(M,"class","button"),p(o,"class","card"),p(l,"class"," svelte-wn74lb")},m(R,j){De(e,R,j),B(R,t,j),B(R,l,j),De(r,l,null),a(l,i),a(l,o),a(o,d),a(d,_),a(o,w),a(o,y),a(y,E),a(y,D),a(D,b),a(y,P),a(y,Y),a(Y,C),a(y,v),a(y,V),a(V,G),a(o,N),a(o,H),a(H,z),a(z,g),a(o,S),a(o,L),a(L,I),je(I,n[1]),a(o,Q),a(o,W),a(W,M),a(M,le),a(o,ee),a(o,x),a(l,J),a(l,A),a(l,u),q.block.m(l,q.anchor=null),q.mount=()=>l,q.anchor=null,K=!0,ae||(ce=[_e(I,"input",n[13]),_e(I,"keypress",n[11]),_e(M,"click",n[8])],ae=!0)},p(R,j){n=R,j[0]&2&&je(I,n[1]),q.ctx=n,j[0]&32&&X!==(X=n[5])&&Ie(X,q)||lt(q,n,j)},i(R){K||(fe(e.$$.fragment,R),fe(r.$$.fragment,R),fe(q.block),K=!0)},o(R){he(e.$$.fragment,R),he(r.$$.fragment,R);for(let j=0;j<3;j+=1){const O=q.blocks[j];he(O)}K=!1},d(R){Te(e,R),R&&s(t),R&&s(l),Te(r),q.block.d(),q.token=null,q=null,ae=!1,at(ce)}}}async function Qt({params:n,fetch:e}){n.technique;const t=await e("/api/technique/all.json"),l=await t.json();return t.status===200?{props:{techniques:l}}:{status:t.status,error:new Error(l.message)}}function Ht(){document.execCommand("copy")}function tt(n){let e=new Set,t=[];return n.forEach(function(l){l.hasOwnProperty("off_tech_label")&&(e.has(l.off_tech_label.value)||(e.add(l.off_tech_label.value),t.push(l)))}),t}function Kt(n,e,t){let l;dt(n,Et,g=>t(6,l=g));let{techniques:r}=e,i=new Ge(r,{index:!0,index_key:"d3f:d3fend-id"}),o,d="",_=!1,w=!0,y,E=[];function D(){t(0,o=[]),t(2,_=!1),t(3,w=!0),E=[]}y=l.url.searchParams.get("q"),console.log("Found params: "+y);let b=!1;async function P(){let g=new Dt,S=await Promise.all(E);S.forEach(function(W){W.def_to_off.results.bindings.forEach(function(M){g.add_technique({techniqueID:de(M.off_tech.value),comment:`
`+M.def_tech_label.value+`
`,color:"#9ecae1"})})});let L=`"Navigator_Layer-${S.length}-D3FEND-Techniques.json"`;const I=document.createElement("a"),Q=new Blob([JSON.stringify(g.json())],{type:"application/json;charset=utf-8"});I.href=URL.createObjectURL(Q),I.download=L,I.click()}async function Y(g){let S="/api/technique/"+g+".json";const L=await fetch(S);if(L.status==404)return{id:g,def_to_off:[],description:{graph:[]},status:L.status};if(L.ok){const I=await L.json();return{id:g,def_to_off:I.def_to_off,description:new Ge(I.description)}}else throw new Error(d)}async function C(){D();let g=t(0,o=Array.from(new Set(bt(d,i))));if(g)return g.forEach(function(S){let L;L=Y(S),L&&E.push(L)}),l.url.searchParams.set("q",JSON.stringify(g)),history.replaceState(null,"mapping",l.url),E;D(),console.debug("no matches")}let v=C();function V(){t(5,v=C()),t(3,w=!1)}function G(){window.getSelection().removeAllRanges(),t(2,_=!1),t(4,b=!1)}function N(){t(4,b=!0);let g="mappings";const S=window.getSelection();S.removeAllRanges();let L=document.getElementById(g);const I=document.createRange();I.selectNodeContents(L),S.addRange(I),t(2,_=!0)}function H(g){g.ctrlKey==!0&&g.keyCode==13&&V()}_t(async()=>{y?(t(1,d=y),console.log("handlingclick"),V()):(console.log("starting blank"),t(1,d=""))});function z(){d=this.value,t(1,d)}return n.$$set=g=>{"techniques"in g&&t(12,r=g.techniques)},[o,d,_,w,b,v,l,P,V,G,N,H,r,z]}class Wt extends ft{constructor(e){super(),ht(this,e,Kt,Bt,ut,{techniques:12},null,[-1,-1])}}export{Wt as default,Qt as load};
